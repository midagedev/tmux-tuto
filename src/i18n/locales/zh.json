{
  ",\n      reason: `수동 확인 필요: ${Array.from(unsupportedKinds).join(": ",\n      reason: `수동 확인 필요: ${Array.from(unsupportedKinds).join(",
  ",\n      unsupportedKinds: Array.from(unsupportedKinds),\n    };\n  }\n\n  if (failedRules.length === 0) {\n    return {\n      status: 'complete',\n      reason: '자동 채점 통과',\n      unsupportedKinds: [],\n    };\n  }\n\n  return {\n    status: 'incomplete',\n    reason:": ",\n      unsupportedKinds: Array.from(unsupportedKinds),\n    };\n  }\n\n  if (failedRules.length === 0) {\n    return {\n      status: 'complete',\n      reason: '자동 채점 통과',\n      unsupportedKinds: [],\n    };\n  }\n\n  return {\n    status: 'incomplete',\n    reason:",
  ",\n  };\n}\n\nexport function getHintForMission(\n  mission: AppMission,\n  result: MissionGradeResult,\n  attemptCount: number,\n): HintPayload {\n  const normalizedAttempt = Math.max(1, attemptCount);\n  const firstRule = result.failedRules[0];\n  const actionHint = firstRule ? getRuleActionHint(firstRule) : mission.hints[0] ?? '핵심 목표를 다시 확인해 보세요.';\n\n  if (normalizedAttempt === 1) {\n    return {\n      hintLevel: 1,\n      hintText:": ",\n  };\n}\n\nexport function getHintForMission(\n  mission: AppMission,\n  result: MissionGradeResult,\n  attemptCount: number,\n): HintPayload {\n  const normalizedAttempt = Math.max(1, attemptCount);\n  const firstRule = result.failedRules[0];\n  const actionHint = firstRule ? getRuleActionHint(firstRule) : mission.hints[0] ?? '핵심 목표를 다시 확인해 보세요.';\n\n  if (normalizedAttempt === 1) {\n    return {\n      hintLevel: 1,\n      hintText:",
  ",\n};\n\ntype LessonTerm = {\n  id: string;\n  title: string;\n  aliases: string[];\n  description: string;\n};\n\nconst DEFAULT_TERM_GLOSSARY: LessonTerm[] = [\n  {\n    id: 'session',\n    title: 'Session',\n    aliases: ['session', '세션'],\n    description: '작업 컨텍스트를 유지하는 최상위 단위입니다. SSH가 끊겨도 다시 붙어 이어서 작업할 수 있습니다.',\n  },\n  {\n    id: 'window',\n    title: 'Window',\n    aliases: ['window', '윈도우'],\n    description: '세션 안의 탭 단위 작업 공간입니다. 서비스/역할별로 분리해 전환합니다.',\n  },\n  {\n    id: 'pane',\n    title: 'Pane',\n    aliases: ['pane', '패인'],\n    description: '한 윈도우를 분할한 터미널 영역입니다. 코드/로그/테스트를 병렬로 볼 때 사용합니다.',\n  },\n  {\n    id: 'prefix',\n    title: 'Prefix Key',\n    aliases: ['prefix', 'ctrl+b', 'ctrl+a'],\n    description: 'tmux 단축키 입력의 시작 키입니다. 기본값은 `Ctrl+b`입니다.',\n  },\n  {\n    id: 'detach-attach',\n    title: 'Detach / Attach',\n    aliases: ['detach', 'attach', '분리', '재접속'],\n    description: '세션에서 빠져나왔다가 다시 붙는 동작입니다. 세션 복구 루틴의 핵심입니다.',\n  },\n  {\n    id: 'copy-mode',\n    title: 'Copy Mode',\n    aliases: ['copy-mode', 'copy mode', '검색', 'scroll'],\n    description: '스크롤, 검색, 선택 복사를 위한 모드입니다. 긴 로그 탐색에 사용합니다.',\n  },\n  {\n    id: 'command-mode',\n    title: 'Command Mode',\n    aliases: ['command mode', 'command-mode', 'command-prompt', 'choose-tree'],\n    description: 'tmux 명령을 직접 실행하는 모드입니다. 복합 동작 자동화에 유용합니다.',\n  },\n  {\n    id: 'layout',\n    title: 'Layout',\n    aliases: ['layout', '레이아웃', 'resize', 'split'],\n    description: '패인 배치를 의미합니다. 작업 성격에 맞춰 분할/크기/포커스를 조정합니다.',\n  },\n];\n\nfunction renderTextWithShortcutTooltip(text: string, keyPrefix: string) {\n  return text.split(/(`[^`]+`)/g).map((segment, index) => {\n    if (segment.startsWith('`') && segment.endsWith('`')) {\n      const token = segment.slice(1, -1);\n      const tooltip = SHORTCUT_TOOLTIPS[token];\n\n      return (\n        <code\n          key={`${keyPrefix}-token-${index}`}\n          className={`shortcut-token${tooltip ? ' shortcut-token-tooltip' : ''}`}\n          title={tooltip}\n        >\n          {token}\n        </code>\n      );\n    }\n\n    return <span key={`${keyPrefix}-text-${index}`}>{segment}</span>;\n  });\n}\n\nfunction resolveLessonTerms(lesson: AppLesson, missions: AppMission[], termGlossary: LessonTerm[] | null) {\n  const corpus = [\n    lesson.title,\n    lesson.overview ?? '',\n    lesson.goal ?? '',\n    ...lesson.objectives,\n    ...(lesson.successCriteria ?? []),\n    ...(lesson.failureStates ?? []),\n    ...missions.flatMap((mission) => [mission.title, ...mission.hints]),\n  ]\n    .join(' ')\n    .toLowerCase();\n\n  const source = termGlossary ?? DEFAULT_TERM_GLOSSARY;\n  return source.filter((term) => term.aliases.some((alias) => corpus.includes(alias.toLowerCase()))).slice(0, 6);\n}\n\nexport function LessonPage() {\n  const { trackSlug, chapterSlug, lessonSlug } = useParams();\n  const [pageState, setPageState] = useState<LessonPageState>({ status: 'loading' });\n\n  useEffect(() => {\n    let isMounted = true;\n\n    if (!trackSlug || !chapterSlug || !lessonSlug) {\n      setPageState({ status: 'not-found' });\n      return undefined;\n    }\n\n    loadAppContent()\n      .then((content) => {\n        if (!isMounted) {\n          return;\n        }\n\n        const track = getTrackBySlug(content, trackSlug);\n        const chapter = getChapterBySlug(content, chapterSlug);\n        const lesson = getLessonBySlug(content, lessonSlug);\n        const isValidRelation =\n          track?.slug === lesson?.trackSlug &&\n          chapter?.slug === lesson?.chapterSlug &&\n          chapter?.trackSlug === track?.slug;\n\n        if (!track || !chapter || !lesson || !isValidRelation) {\n          setPageState({ status: 'not-found' });\n          return;\n        }\n\n        const missions = content.missions.filter((mission) => mission.lessonSlug === lesson.slug);\n        setPageState({\n          status: 'ready',\n          track,\n          chapter,\n          lesson,\n          missions,\n          termGlossary: content.termGlossary ?? null,\n        });\n      })\n      .catch(() => {\n        if (!isMounted) {\n          return;\n        }\n        setPageState({ status: 'error' });\n      });\n\n    return () => {\n      isMounted = false;\n    };\n  }, [chapterSlug, lessonSlug, trackSlug]);\n\n  if (pageState.status === 'loading') {\n    return (\n      <PagePlaceholder eyebrow=": ",\n};\n\ntype LessonTerm = {\n  id: string;\n  title: string;\n  aliases: string[];\n  description: string;\n};\n\nconst DEFAULT_TERM_GLOSSARY: LessonTerm[] = [\n  {\n    id: 'session',\n    title: 'Session',\n    aliases: ['session', '세션'],\n    description: '작업 컨텍스트를 유지하는 최상위 단위입니다. SSH가 끊겨도 다시 붙어 이어서 작업할 수 있습니다.',\n  },\n  {\n    id: 'window',\n    title: 'Window',\n    aliases: ['window', '윈도우'],\n    description: '세션 안의 탭 단위 작업 공간입니다. 서비스/역할별로 분리해 전환합니다.',\n  },\n  {\n    id: 'pane',\n    title: 'Pane',\n    aliases: ['pane', '패인'],\n    description: '한 윈도우를 분할한 터미널 영역입니다. 코드/로그/테스트를 병렬로 볼 때 사용합니다.',\n  },\n  {\n    id: 'prefix',\n    title: 'Prefix Key',\n    aliases: ['prefix', 'ctrl+b', 'ctrl+a'],\n    description: 'tmux 단축키 입력의 시작 키입니다. 기본값은 `Ctrl+b`입니다.',\n  },\n  {\n    id: 'detach-attach',\n    title: 'Detach / Attach',\n    aliases: ['detach', 'attach', '분리', '재접속'],\n    description: '세션에서 빠져나왔다가 다시 붙는 동작입니다. 세션 복구 루틴의 핵심입니다.',\n  },\n  {\n    id: 'copy-mode',\n    title: 'Copy Mode',\n    aliases: ['copy-mode', 'copy mode', '검색', 'scroll'],\n    description: '스크롤, 검색, 선택 복사를 위한 모드입니다. 긴 로그 탐색에 사용합니다.',\n  },\n  {\n    id: 'command-mode',\n    title: 'Command Mode',\n    aliases: ['command mode', 'command-mode', 'command-prompt', 'choose-tree'],\n    description: 'tmux 명령을 직접 실행하는 모드입니다. 복합 동작 자동화에 유용합니다.',\n  },\n  {\n    id: 'layout',\n    title: 'Layout',\n    aliases: ['layout', '레이아웃', 'resize', 'split'],\n    description: '패인 배치를 의미합니다. 작업 성격에 맞춰 분할/크기/포커스를 조정합니다.',\n  },\n];\n\nfunction renderTextWithShortcutTooltip(text: string, keyPrefix: string) {\n  return text.split(/(`[^`]+`)/g).map((segment, index) => {\n    if (segment.startsWith('`') && segment.endsWith('`')) {\n      const token = segment.slice(1, -1);\n      const tooltip = SHORTCUT_TOOLTIPS[token];\n\n      return (\n        <code\n          key={`${keyPrefix}-token-${index}`}\n          className={`shortcut-token${tooltip ? ' shortcut-token-tooltip' : ''}`}\n          title={tooltip}\n        >\n          {token}\n        </code>\n      );\n    }\n\n    return <span key={`${keyPrefix}-text-${index}`}>{segment}</span>;\n  });\n}\n\nfunction resolveLessonTerms(lesson: AppLesson, missions: AppMission[], termGlossary: LessonTerm[] | null) {\n  const corpus = [\n    lesson.title,\n    lesson.overview ?? '',\n    lesson.goal ?? '',\n    ...lesson.objectives,\n    ...(lesson.successCriteria ?? []),\n    ...(lesson.failureStates ?? []),\n    ...missions.flatMap((mission) => [mission.title, ...mission.hints]),\n  ]\n    .join(' ')\n    .toLowerCase();\n\n  const source = termGlossary ?? DEFAULT_TERM_GLOSSARY;\n  return source.filter((term) => term.aliases.some((alias) => corpus.includes(alias.toLowerCase()))).slice(0, 6);\n}\n\nexport function LessonPage() {\n  const { trackSlug, chapterSlug, lessonSlug } = useParams();\n  const [pageState, setPageState] = useState<LessonPageState>({ status: 'loading' });\n\n  useEffect(() => {\n    let isMounted = true;\n\n    if (!trackSlug || !chapterSlug || !lessonSlug) {\n      setPageState({ status: 'not-found' });\n      return undefined;\n    }\n\n    loadAppContent()\n      .then((content) => {\n        if (!isMounted) {\n          return;\n        }\n\n        const track = getTrackBySlug(content, trackSlug);\n        const chapter = getChapterBySlug(content, chapterSlug);\n        const lesson = getLessonBySlug(content, lessonSlug);\n        const isValidRelation =\n          track?.slug === lesson?.trackSlug &&\n          chapter?.slug === lesson?.chapterSlug &&\n          chapter?.trackSlug === track?.slug;\n\n        if (!track || !chapter || !lesson || !isValidRelation) {\n          setPageState({ status: 'not-found' });\n          return;\n        }\n\n        const missions = content.missions.filter((mission) => mission.lessonSlug === lesson.slug);\n        setPageState({\n          status: 'ready',\n          track,\n          chapter,\n          lesson,\n          missions,\n          termGlossary: content.termGlossary ?? null,\n        });\n      })\n      .catch(() => {\n        if (!isMounted) {\n          return;\n        }\n        setPageState({ status: 'error' });\n      });\n\n    return () => {\n      isMounted = false;\n    };\n  }, [chapterSlug, lessonSlug, trackSlug]);\n\n  if (pageState.status === 'loading') {\n    return (\n      <PagePlaceholder eyebrow=",
  ", { replace: true });\n    }\n  }, [firstMissionPassedAt, navigate, startedAt]);\n\n  useEffect(() => {\n    loadAppContent()\n      .then((loaded) => setContent(loaded))\n      .catch(() => setContent(null));\n  }, []);\n\n  useEffect(() => {\n    if (firstMissionPassedAt && !completedAt) {\n      completeOnboarding();\n    }\n  }, [completeOnboarding, completedAt, firstMissionPassedAt]);\n\n  const recommendation = useMemo(() => getRecommendationByGoal(goal), [goal]);\n  const recommendedTrackTitle =\n    content?.tracks.find((track) => track.slug === recommendation.trackSlug)?.title ??\n    recommendation.trackSlug;\n  const recommendedPlaybookTitle =\n    content?.playbooks.find((playbook) => playbook.slug === recommendation.playbookSlug)?.title ??\n    recommendation.playbookSlug;\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"온보딩 완료\"\n      description=\"첫 실습이 완료되었습니다. 지금 바로 오늘 할 1개 미션을 시작하세요.\"\n    >\n      <div className=\"onboarding-layout\">\n        <section className=\"onboarding-card\">\n          <h2>설정 요약</h2>\n          <ul className=\"link-list\">\n            <li>목표: {goal ? getGoalLabel(goal) :": ", { replace: true });\n    }\n  }, [firstMissionPassedAt, navigate, startedAt]);\n\n  useEffect(() => {\n    loadAppContent()\n      .then((loaded) => setContent(loaded))\n      .catch(() => setContent(null));\n  }, []);\n\n  useEffect(() => {\n    if (firstMissionPassedAt && !completedAt) {\n      completeOnboarding();\n    }\n  }, [completeOnboarding, completedAt, firstMissionPassedAt]);\n\n  const recommendation = useMemo(() => getRecommendationByGoal(goal), [goal]);\n  const recommendedTrackTitle =\n    content?.tracks.find((track) => track.slug === recommendation.trackSlug)?.title ??\n    recommendation.trackSlug;\n  const recommendedPlaybookTitle =\n    content?.playbooks.find((playbook) => playbook.slug === recommendation.playbookSlug)?.title ??\n    recommendation.playbookSlug;\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"온보딩 완료\"\n      description=\"첫 실습이 완료되었습니다. 지금 바로 오늘 할 1개 미션을 시작하세요.\"\n    >\n      <div className=\"onboarding-layout\">\n        <section className=\"onboarding-card\">\n          <h2>설정 요약</h2>\n          <ul className=\"link-list\">\n            <li>목표: {goal ? getGoalLabel(goal) :",
  ", { replace: true });\n    }\n  }, [goal, navigate, startedAt]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"입력/환경 선호 설정\"\n      description=\"prefix와 키보드 레이아웃을 맞춰 실습 입력을 실제 환경과 가깝게 만듭니다.\"\n    >\n      <div className=\"onboarding-layout\">\n        <section className=\"onboarding-card\">\n          <h2>Prefix 키</h2>\n          <div className=\"onboarding-control-group\">\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"prefixKey\"\n                value=\"C-b\"\n                checked={prefixKey ===": ", { replace: true });\n    }\n  }, [goal, navigate, startedAt]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"입력/환경 선호 설정\"\n      description=\"prefix와 키보드 레이아웃을 맞춰 실습 입력을 실제 환경과 가깝게 만듭니다.\"\n    >\n      <div className=\"onboarding-layout\">\n        <section className=\"onboarding-card\">\n          <h2>Prefix 키</h2>\n          <div className=\"onboarding-control-group\">\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"prefixKey\"\n                value=\"C-b\"\n                checked={prefixKey ===",
  ", { replace: true });\n    }\n  }, [navigate, startedAt]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"학습 목표 선택\"\n      description=\"당신의 현재 목적에 맞춰 추천 트랙과 플레이북을 결정합니다.\"\n    >\n      <div className=\"onboarding-layout\">\n        {GOAL_OPTIONS.map((option) => {\n          const selected = goal === option.value;\n          return (\n            <button\n              key={option.value}\n              type=\"button\"\n              className={selected ?": ", { replace: true });\n    }\n  }, [navigate, startedAt]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"학습 목표 선택\"\n      description=\"당신의 현재 목적에 맞춰 추천 트랙과 플레이북을 결정합니다.\"\n    >\n      <div className=\"onboarding-layout\">\n        {GOAL_OPTIONS.map((option) => {\n          const selected = goal === option.value;\n          return (\n            <button\n              key={option.value}\n              type=\"button\"\n              className={selected ?",
  ";\n\nexport function OnboardingStartPage() {\n  const navigate = useNavigate();\n  const startedAt = useOnboardingStore((store) => store.startedAt);\n  const completedAt = useOnboardingStore((store) => store.completedAt);\n  const startOnboarding = useOnboardingStore((store) => store.startOnboarding);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"실습 중심 tmux 온보딩\"\n      description=\"3분 안에 첫 패인 분할을 완료하고, 개인화된 트랙 추천까지 연결합니다.\"\n    >\n      <div className=\"onboarding-layout\">\n        <section className=\"onboarding-card\">\n          <h2>이 사이트가 해주는 것</h2>\n          <ul className=\"link-list\">\n            <li>커리큘럼 기반 tmux 실습 (Track A~C)</li>\n            <li>고충실도 tmux 시뮬레이터 실습</li>\n            <li>단축키 검색, 북마크, 진행도 추적</li>\n          </ul>\n        </section>\n\n        <section className=\"onboarding-card\">\n          <h2>해주지 않는 것</h2>\n          <ul className=\"link-list\">\n            <li>실제 서버/셸 프로세스 실행</li>\n            <li>계정 기반 클라우드 동기화</li>\n            <li>백엔드 로그 수집</li>\n          </ul>\n          <p className=\"muted\">\n            실제 tmux와의 차이는 실습 화면의 <strong>SIMULATED</strong> 안내에서 항상 확인할 수 있습니다.\n          </p>\n        </section>\n      </div>\n\n      <div className=\"inline-actions\">\n        <button\n          type=\"button\"\n          className=\"primary-btn\"\n          onClick={() => {\n            startOnboarding();\n            navigate(": ";\n\nexport function OnboardingStartPage() {\n  const navigate = useNavigate();\n  const startedAt = useOnboardingStore((store) => store.startedAt);\n  const completedAt = useOnboardingStore((store) => store.completedAt);\n  const startOnboarding = useOnboardingStore((store) => store.startOnboarding);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Onboarding\"\n      title=\"실습 중심 tmux 온보딩\"\n      description=\"3분 안에 첫 패인 분할을 완료하고, 개인화된 트랙 추천까지 연결합니다.\"\n    >\n      <div className=\"onboarding-layout\">\n        <section className=\"onboarding-card\">\n          <h2>이 사이트가 해주는 것</h2>\n          <ul className=\"link-list\">\n            <li>커리큘럼 기반 tmux 실습 (Track A~C)</li>\n            <li>고충실도 tmux 시뮬레이터 실습</li>\n            <li>단축키 검색, 북마크, 진행도 추적</li>\n          </ul>\n        </section>\n\n        <section className=\"onboarding-card\">\n          <h2>해주지 않는 것</h2>\n          <ul className=\"link-list\">\n            <li>실제 서버/셸 프로세스 실행</li>\n            <li>계정 기반 클라우드 동기화</li>\n            <li>백엔드 로그 수집</li>\n          </ul>\n          <p className=\"muted\">\n            실제 tmux와의 차이는 실습 화면의 <strong>SIMULATED</strong> 안내에서 항상 확인할 수 있습니다.\n          </p>\n        </section>\n      </div>\n\n      <div className=\"inline-actions\">\n        <button\n          type=\"button\"\n          className=\"primary-btn\"\n          onClick={() => {\n            startOnboarding();\n            navigate(",
  ";\n                      const lesson = lessonBySlug.get(lessonSlug);\n                      return (\n                        <li key={session.id}>\n                          <strong>{mission?.title ?? session.missionSlug}</strong>\n                          <p className=\"muted\">\n                            완료: {formatSessionDateTime(session.completedAt)} · XP +\n                            {session.gainedXp ?? 0}\n                          </p>\n                          <p className=\"muted\">{lesson?.title ?? lessonSlug}</p>\n                        </li>\n                      );\n                    })}\n                  </ul>\n                )}\n              </article>\n            </div>\n          </section>\n\n          <section className=\"playbook-section\">\n            <h2>트랙 진행률</h2>\n            <ul className=\"link-list\">\n              {trackProgress.map((track) => (\n                <li key={track.trackSlug}>\n                  <strong>{track.trackTitle}</strong> - {track.completedCount}/{track.totalCount} ({track.ratio}%)\n                </li>\n              ))}\n            </ul>\n          </section>\n\n          <section className=\"playbook-section\">\n            <h2>Core 업적</h2>\n            <p className=\"muted\">\n              {unlockedCoreAchievements.length}/{coreAchievementRows.length} 달성\n            </p>\n            <div className=\"achievement-grid\">\n              {coreAchievementRows.map((achievement) => (\n                <article\n                  key={achievement.id}\n                  className={`achievement-card ${achievement.unlocked ?": ";\n                      const lesson = lessonBySlug.get(lessonSlug);\n                      return (\n                        <li key={session.id}>\n                          <strong>{mission?.title ?? session.missionSlug}</strong>\n                          <p className=\"muted\">\n                            완료: {formatSessionDateTime(session.completedAt)} · XP +\n                            {session.gainedXp ?? 0}\n                          </p>\n                          <p className=\"muted\">{lesson?.title ?? lessonSlug}</p>\n                        </li>\n                      );\n                    })}\n                  </ul>\n                )}\n              </article>\n            </div>\n          </section>\n\n          <section className=\"playbook-section\">\n            <h2>트랙 진행률</h2>\n            <ul className=\"link-list\">\n              {trackProgress.map((track) => (\n                <li key={track.trackSlug}>\n                  <strong>{track.trackTitle}</strong> - {track.completedCount}/{track.totalCount} ({track.ratio}%)\n                </li>\n              ))}\n            </ul>\n          </section>\n\n          <section className=\"playbook-section\">\n            <h2>Core 업적</h2>\n            <p className=\"muted\">\n              {unlockedCoreAchievements.length}/{coreAchievementRows.length} 달성\n            </p>\n            <div className=\"achievement-grid\">\n              {coreAchievementRows.map((achievement) => (\n                <article\n                  key={achievement.id}\n                  className={`achievement-card ${achievement.unlocked ?",
  ";\n                      const lesson = lessonBySlug.get(lessonSlug);\n                      return (\n                        <li key={session.id}>\n                          <strong>{mission?.title ?? session.missionSlug}</strong>\n                          <p className=\"muted\">시작: {formatSessionDateTime(session.startedAt)}</p>\n                          <p className=\"muted\">{lesson?.title ?? lessonSlug}</p>\n                          {lessonSlug ? (\n                            <Link\n                              className=\"secondary-btn\"\n                              to={`/practice?lesson=${lessonSlug}&mission=${session.missionSlug}`}\n                            >\n                              이어서 실습\n                            </Link>\n                          ) : null}\n                        </li>\n                      );\n                    })}\n                  </ul>\n                )}\n              </article>\n              <article>\n                <h3>최근 완료 세션</h3>\n                {recentCompletedSessions.length === 0 ? (\n                  <p className=\"muted\">완료한 세션이 없습니다.</p>\n                ) : (\n                  <ul className=\"link-list\">\n                    {recentCompletedSessions.map((session) => {\n                      const mission = missionBySlug.get(session.missionSlug);\n                      const lessonSlug = session.lessonSlug ?? mission?.lessonSlug ??": ";\n                      const lesson = lessonBySlug.get(lessonSlug);\n                      return (\n                        <li key={session.id}>\n                          <strong>{mission?.title ?? session.missionSlug}</strong>\n                          <p className=\"muted\">시작: {formatSessionDateTime(session.startedAt)}</p>\n                          <p className=\"muted\">{lesson?.title ?? lessonSlug}</p>\n                          {lessonSlug ? (\n                            <Link\n                              className=\"secondary-btn\"\n                              to={`/practice?lesson=${lessonSlug}&mission=${session.missionSlug}`}\n                            >\n                              이어서 실습\n                            </Link>\n                          ) : null}\n                        </li>\n                      );\n                    })}\n                  </ul>\n                )}\n              </article>\n              <article>\n                <h3>최근 완료 세션</h3>\n                {recentCompletedSessions.length === 0 ? (\n                  <p className=\"muted\">완료한 세션이 없습니다.</p>\n                ) : (\n                  <ul className=\"link-list\">\n                    {recentCompletedSessions.map((session) => {\n                      const mission = missionBySlug.get(session.missionSlug);\n                      const lessonSlug = session.lessonSlug ?? mission?.lessonSlug ??",
  ";\n    accumulator[category] = [...(accumulator[category] ?? []), playbook];\n    return accumulator;\n  }, {});\n}\n\nexport function PlaybookIndexPage() {\n  const [playbooks, setPlaybooks] = useState<AppPlaybook[]>([]);\n\n  useEffect(() => {\n    loadAppContent()\n      .then((content) => setPlaybooks(content.playbooks))\n      .catch(() => setPlaybooks([]));\n  }, []);\n\n  const groupedPlaybooks = useMemo(() => buildGroupedPlaybooks(playbooks), [playbooks]);\n  const categories = useMemo(() => Object.keys(groupedPlaybooks).sort(), [groupedPlaybooks]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Playbooks\"\n      title=\"플레이북 라이브러리\"\n      description=\"레퍼런스 허브에서 찾은 항목을 실제 운영 절차로 이어주는 단계형 플레이북 모음입니다.\"\n    >\n      <section className=\"home-stage-grid\">\n        <article className=\"home-stage-card\">\n          <h2>권장 사용 흐름</h2>\n          <p>1) 레퍼런스 허브에서 명령/단축키 검색</p>\n          <p>2) 관련 플레이북으로 운영 절차 확인</p>\n          <p>3) 실습 워크벤치에서 바로 검증</p>\n          <div className=\"inline-actions\">\n            <Link to=\"/cheatsheet\" className=\"secondary-btn\">\n              레퍼런스 허브로 이동\n            </Link>\n            <Link to=\"/practice?lesson=hello-tmux\" className=\"secondary-btn\">\n              실습 바로 열기\n            </Link>\n          </div>\n        </article>\n      </section>\n\n      {playbooks.length === 0 ? (\n        <EmptyState title=\"플레이북이 없습니다\" description=\"콘텐츠 로드를 확인해 주세요.\" />\n      ) : (\n        <div className=\"reference-playbook-groups\">\n          {categories.map((category) => (\n            <section key={category} className=\"reference-section\">\n              <h2>{category}</h2>\n              <div className=\"reference-playbook-grid\">\n                {(groupedPlaybooks[category] ?? []).map((playbook) => (\n                  <article key={playbook.slug} className=\"reference-playbook-card\">\n                    <h3>{playbook.title}</h3>\n                    <p className=\"muted\">\n                      {playbook.estimatedMinutes}분 · 단계 {playbook.steps.length}개\n                    </p>\n                    <p className=\"muted\">선행 지식: {playbook.prerequisites.join(": ";\n    accumulator[category] = [...(accumulator[category] ?? []), playbook];\n    return accumulator;\n  }, {});\n}\n\nexport function PlaybookIndexPage() {\n  const [playbooks, setPlaybooks] = useState<AppPlaybook[]>([]);\n\n  useEffect(() => {\n    loadAppContent()\n      .then((content) => setPlaybooks(content.playbooks))\n      .catch(() => setPlaybooks([]));\n  }, []);\n\n  const groupedPlaybooks = useMemo(() => buildGroupedPlaybooks(playbooks), [playbooks]);\n  const categories = useMemo(() => Object.keys(groupedPlaybooks).sort(), [groupedPlaybooks]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Playbooks\"\n      title=\"플레이북 라이브러리\"\n      description=\"레퍼런스 허브에서 찾은 항목을 실제 운영 절차로 이어주는 단계형 플레이북 모음입니다.\"\n    >\n      <section className=\"home-stage-grid\">\n        <article className=\"home-stage-card\">\n          <h2>권장 사용 흐름</h2>\n          <p>1) 레퍼런스 허브에서 명령/단축키 검색</p>\n          <p>2) 관련 플레이북으로 운영 절차 확인</p>\n          <p>3) 실습 워크벤치에서 바로 검증</p>\n          <div className=\"inline-actions\">\n            <Link to=\"/cheatsheet\" className=\"secondary-btn\">\n              레퍼런스 허브로 이동\n            </Link>\n            <Link to=\"/practice?lesson=hello-tmux\" className=\"secondary-btn\">\n              실습 바로 열기\n            </Link>\n          </div>\n        </article>\n      </section>\n\n      {playbooks.length === 0 ? (\n        <EmptyState title=\"플레이북이 없습니다\" description=\"콘텐츠 로드를 확인해 주세요.\" />\n      ) : (\n        <div className=\"reference-playbook-groups\">\n          {categories.map((category) => (\n            <section key={category} className=\"reference-section\">\n              <h2>{category}</h2>\n              <div className=\"reference-playbook-grid\">\n                {(groupedPlaybooks[category] ?? []).map((playbook) => (\n                  <article key={playbook.slug} className=\"reference-playbook-card\">\n                    <h3>{playbook.title}</h3>\n                    <p className=\"muted\">\n                      {playbook.estimatedMinutes}분 · 단계 {playbook.steps.length}개\n                    </p>\n                    <p className=\"muted\">선행 지식: {playbook.prerequisites.join(",
  ";\n  }\n\n  return null;\n}\n\nexport function BookmarksPage() {\n  const [title, setTitle] = useState('');\n  const [targetId, setTargetId] = useState('');\n  const [type, setType] = useState<'lesson' | 'mission' | 'cheatsheet_item' | 'action_pattern' | 'playbook' | 'snapshot'>(\n    'lesson',\n  );\n  const [tagsInput, setTagsInput] = useState('');\n  const [tagFilter, setTagFilter] = useState('');\n  const [sortOrder, setSortOrder] = useState<'newest' | 'oldest'>('newest');\n\n  const bookmarks = useBookmarkStore((store) => store.bookmarks);\n  const notesByBookmarkId = useBookmarkStore((store) => store.notesByBookmarkId);\n  const loading = useBookmarkStore((store) => store.loading);\n  const loadBookmarks = useBookmarkStore((store) => store.loadBookmarks);\n  const createBookmark = useBookmarkStore((store) => store.createBookmark);\n  const deleteBookmark = useBookmarkStore((store) => store.deleteBookmark);\n  const saveBookmarkNote = useBookmarkStore((store) => store.saveBookmarkNote);\n\n  useEffect(() => {\n    void loadBookmarks();\n  }, [loadBookmarks]);\n\n  const filteredBookmarks = useMemo(() => {\n    const normalizedTag = tagFilter.trim().toLowerCase();\n    const base = normalizedTag\n      ? bookmarks.filter((bookmark) =>\n          bookmark.tags.some((tag) => tag.toLowerCase().includes(normalizedTag)),\n        )\n      : bookmarks;\n\n    return [...base].sort((a, b) =>\n      sortOrder === 'newest'\n        ? b.createdAt.localeCompare(a.createdAt)\n        : a.createdAt.localeCompare(b.createdAt),\n    );\n  }, [bookmarks, tagFilter, sortOrder]);\n\n  const bookmarkTypeCount = useMemo(() => {\n    return bookmarks.reduce<Record<string, number>>((accumulator, bookmark) => {\n      accumulator[bookmark.type] = (accumulator[bookmark.type] ?? 0) + 1;\n      return accumulator;\n    }, {});\n  }, [bookmarks]);\n\n  const topTags = useMemo(() => {\n    const tagCountMap = bookmarks.reduce<Record<string, number>>((accumulator, bookmark) => {\n      bookmark.tags.forEach((tag) => {\n        accumulator[tag] = (accumulator[tag] ?? 0) + 1;\n      });\n      return accumulator;\n    }, {});\n\n    return Object.entries(tagCountMap)\n      .sort((left, right) => right[1] - left[1])\n      .slice(0, 5);\n  }, [bookmarks]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Bookmarks\"\n      title=\"북마크 운영 허브\"\n      description=\"북마크를 단순 저장소가 아니라 재실습 큐로 관리할 수 있도록 정리했습니다.\"\n    >\n      <section className=\"bookmark-dashboard\">\n        <article className=\"bookmark-metric-card\">\n          <h2>저장 항목</h2>\n          <p>\n            <strong>{bookmarks.length}</strong>개\n          </p>\n        </article>\n        <article className=\"bookmark-metric-card\">\n          <h2>현재 필터 결과</h2>\n          <p>\n            <strong>{filteredBookmarks.length}</strong>개\n          </p>\n        </article>\n        <article className=\"bookmark-metric-card\">\n          <h2>타입 분포</h2>\n          <p className=\"muted\">\n            {Object.entries(bookmarkTypeCount)\n              .map(([bookmarkType, count]) =>": ";\n  }\n\n  return null;\n}\n\nexport function BookmarksPage() {\n  const [title, setTitle] = useState('');\n  const [targetId, setTargetId] = useState('');\n  const [type, setType] = useState<'lesson' | 'mission' | 'cheatsheet_item' | 'action_pattern' | 'playbook' | 'snapshot'>(\n    'lesson',\n  );\n  const [tagsInput, setTagsInput] = useState('');\n  const [tagFilter, setTagFilter] = useState('');\n  const [sortOrder, setSortOrder] = useState<'newest' | 'oldest'>('newest');\n\n  const bookmarks = useBookmarkStore((store) => store.bookmarks);\n  const notesByBookmarkId = useBookmarkStore((store) => store.notesByBookmarkId);\n  const loading = useBookmarkStore((store) => store.loading);\n  const loadBookmarks = useBookmarkStore((store) => store.loadBookmarks);\n  const createBookmark = useBookmarkStore((store) => store.createBookmark);\n  const deleteBookmark = useBookmarkStore((store) => store.deleteBookmark);\n  const saveBookmarkNote = useBookmarkStore((store) => store.saveBookmarkNote);\n\n  useEffect(() => {\n    void loadBookmarks();\n  }, [loadBookmarks]);\n\n  const filteredBookmarks = useMemo(() => {\n    const normalizedTag = tagFilter.trim().toLowerCase();\n    const base = normalizedTag\n      ? bookmarks.filter((bookmark) =>\n          bookmark.tags.some((tag) => tag.toLowerCase().includes(normalizedTag)),\n        )\n      : bookmarks;\n\n    return [...base].sort((a, b) =>\n      sortOrder === 'newest'\n        ? b.createdAt.localeCompare(a.createdAt)\n        : a.createdAt.localeCompare(b.createdAt),\n    );\n  }, [bookmarks, tagFilter, sortOrder]);\n\n  const bookmarkTypeCount = useMemo(() => {\n    return bookmarks.reduce<Record<string, number>>((accumulator, bookmark) => {\n      accumulator[bookmark.type] = (accumulator[bookmark.type] ?? 0) + 1;\n      return accumulator;\n    }, {});\n  }, [bookmarks]);\n\n  const topTags = useMemo(() => {\n    const tagCountMap = bookmarks.reduce<Record<string, number>>((accumulator, bookmark) => {\n      bookmark.tags.forEach((tag) => {\n        accumulator[tag] = (accumulator[tag] ?? 0) + 1;\n      });\n      return accumulator;\n    }, {});\n\n    return Object.entries(tagCountMap)\n      .sort((left, right) => right[1] - left[1])\n      .slice(0, 5);\n  }, [bookmarks]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Bookmarks\"\n      title=\"북마크 운영 허브\"\n      description=\"북마크를 단순 저장소가 아니라 재실습 큐로 관리할 수 있도록 정리했습니다.\"\n    >\n      <section className=\"bookmark-dashboard\">\n        <article className=\"bookmark-metric-card\">\n          <h2>저장 항목</h2>\n          <p>\n            <strong>{bookmarks.length}</strong>개\n          </p>\n        </article>\n        <article className=\"bookmark-metric-card\">\n          <h2>현재 필터 결과</h2>\n          <p>\n            <strong>{filteredBookmarks.length}</strong>개\n          </p>\n        </article>\n        <article className=\"bookmark-metric-card\">\n          <h2>타입 분포</h2>\n          <p className=\"muted\">\n            {Object.entries(bookmarkTypeCount)\n              .map(([bookmarkType, count]) =>",
  ";\n}\n\nfunction getRuleActionHint(rule: MissionGradeResult['failedRules'][number]) {\n  switch (rule.kind) {\n    case 'paneCount':\n      return '패인 분할(prefix + % 또는 prefix + \")을 실행해 pane 수를 늘리세요.';\n    case 'windowCount':\n      return '새 윈도우(prefix + c 또는 :new-window)를 만들어 window 수를 충족하세요.';\n    case 'sessionCount':\n      return '새 세션(prefix + s 또는 :new-session) 생성 후 다시 채점하세요.';\n    case 'modeIs':\n      return '요구 모드로 먼저 진입한 뒤 필요한 동작을 수행하세요.';\n    case 'searchExecuted':\n      return 'copy-mode에서 검색(": ";\n}\n\nfunction getRuleActionHint(rule: MissionGradeResult['failedRules'][number]) {\n  switch (rule.kind) {\n    case 'paneCount':\n      return '패인 분할(prefix + % 또는 prefix + \")을 실행해 pane 수를 늘리세요.';\n    case 'windowCount':\n      return '새 윈도우(prefix + c 또는 :new-window)를 만들어 window 수를 충족하세요.';\n    case 'sessionCount':\n      return '새 세션(prefix + s 또는 :new-session) 생성 후 다시 채점하세요.';\n    case 'modeIs':\n      return '요구 모드로 먼저 진입한 뒤 필요한 동작을 수행하세요.';\n    case 'searchExecuted':\n      return 'copy-mode에서 검색(",
  ": ''}\n                </h2>\n                <p className=\"muted\">\n                  {selectedMission.title} · 난이도 {getDifficultyLabel(selectedMission.difficulty)}\n                </p>\n\n                <section className=\"vm-mission-command-block\">\n                  <h3>이 미션에서 입력할 명령</h3>\n                  {selectedMissionCommands.length > 0 ? (\n                    <div className=\"vm-mission-command-list\">\n                      {selectedMissionCommands.map((command) => (\n                        <button\n                          key={command}\n                          type=\"button\"\n                          className=\"vm-mission-command-chip\"\n                          onClick={() => {\n                            setCommandInput(command);\n                            setMobileWorkbenchView('terminal');\n                          }}\n                        >\n                          <code>{command}</code>\n                        </button>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"muted\">추천 명령을 찾지 못했습니다. 아래 힌트를 기준으로 직접 입력해 주세요.</p>\n                  )}\n                  <p className=\"muted\">명령을 클릭하면 입력창에 채워지고 터미널 탭으로 전환됩니다.</p>\n                </section>\n\n                <section className=\"vm-mission-precondition-block\">\n                  <h3>실행 전 프리컨디션</h3>\n                  <ul className=\"vm-precondition-list\">\n                    {selectedMissionPreconditions.map((item) => (\n                      <li key={item.key} className={": ": ''}\n                </h2>\n                <p className=\"muted\">\n                  {selectedMission.title} · 난이도 {getDifficultyLabel(selectedMission.difficulty)}\n                </p>\n\n                <section className=\"vm-mission-command-block\">\n                  <h3>이 미션에서 입력할 명령</h3>\n                  {selectedMissionCommands.length > 0 ? (\n                    <div className=\"vm-mission-command-list\">\n                      {selectedMissionCommands.map((command) => (\n                        <button\n                          key={command}\n                          type=\"button\"\n                          className=\"vm-mission-command-chip\"\n                          onClick={() => {\n                            setCommandInput(command);\n                            setMobileWorkbenchView('terminal');\n                          }}\n                        >\n                          <code>{command}</code>\n                        </button>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"muted\">추천 명령을 찾지 못했습니다. 아래 힌트를 기준으로 직접 입력해 주세요.</p>\n                  )}\n                  <p className=\"muted\">명령을 클릭하면 입력창에 채워지고 터미널 탭으로 전환됩니다.</p>\n                </section>\n\n                <section className=\"vm-mission-precondition-block\">\n                  <h3>실행 전 프리컨디션</h3>\n                  <ul className=\"vm-precondition-list\">\n                    {selectedMissionPreconditions.map((item) => (\n                      <li key={item.key} className={",
  "',\n    description: '현재 패인을 상하로 분할합니다.',\n    examples: ['상단 빌드, 하단 로그'],\n    relatedActions: ['sim.pane.split.horizontal'],\n    difficulty: 'beginner',\n    practicePath: '/practice?lesson=split-resize',\n  },\n  {\n    id: 'cs-window-new',\n    title: '새 윈도우 생성',\n    contentType: 'shortcut',\n    intentTags: ['window', 'new'],\n    shortcut: 'Ctrl+b (prefix) + c',\n    description: '새 tmux window를 생성합니다.',\n    examples: ['서비스별 window 분리'],\n    relatedActions: ['sim.window.new'],\n    difficulty: 'beginner',\n    practicePath: '/practice?lesson=basics',\n  },\n  {\n    id: 'cs-window-next',\n    title: '다음 윈도우 이동',\n    contentType: 'shortcut',\n    intentTags: ['window', 'next', 'navigation'],\n    shortcut: 'Ctrl+b (prefix) + n',\n    description: '다음 window로 이동합니다.',\n    examples: ['모니터링 window 순환'],\n    relatedActions: ['sim.window.next'],\n    difficulty: 'daily',\n    practicePath: '/practice?lesson=pane-focus-flow',\n  },\n  {\n    id: 'cs-copy-mode',\n    title: 'copy-mode 진입',\n    contentType: 'shortcut',\n    intentTags: ['copy-mode', 'search'],\n    shortcut: 'Ctrl+b (prefix) + [',\n    description: '스크롤/검색/선택 복사를 위한 copy-mode로 들어갑니다.',\n    examples: ['로그 검색 후 복사'],\n    relatedActions: ['sim.copymode.enter'],\n    difficulty: 'advanced',\n    practicePath: '/practice?lesson=copy-search',\n  },\n  {\n    id: 'cs-command-mode',\n    title: 'command mode 진입',\n    contentType: 'shortcut',\n    intentTags: ['command', 'colon'],\n    shortcut: 'Ctrl+b (prefix) + :',\n    description: 'tmux 명령을 직접 실행합니다.',\n    examples: ['new-window', 'split-window -h'],\n    relatedActions: ['sim.command.execute'],\n    difficulty: 'advanced',\n    practicePath: '/practice?lesson=command-subset',\n  },\n  {\n    id: 'cs-session-main',\n    title: '세션 유지 시작',\n    contentType: 'command',\n    intentTags: ['session', 'persistent-session', 'detach-attach'],\n    command: 'tmux new -As main',\n    description: '세션이 없으면 생성, 있으면 재사용합니다.',\n    examples: ['원격 서버 접속 직후 실행'],\n    relatedActions: ['sim.session.new'],\n    difficulty: 'daily',\n    practicePath: '/practice?lesson=attach-detach',\n  },\n  {\n    id: 'cs-recommended-config',\n    title: '권장 tmux.conf',\n    contentType: 'playbook',\n    intentTags: ['tmux.conf', 'config', 'recommended'],\n    description: 'mouse/base-index/mode-keys/리로드 바인딩까지 포함한 팀 공통 베이스 설정입니다.',\n    examples: ['set -g mouse on', 'setw -g mode-keys vi', 'bind r source-file ~/.tmux.conf'],\n    relatedActions: ['sim.config.apply'],\n    difficulty: 'daily',\n    playbookSlug: 'recommended-config',\n    practicePath: '/practice?lesson=command-subset',\n  },\n  {\n    id: 'cs-session-persistence',\n    title: '세션 유지 플레이북',\n    contentType: 'playbook',\n    intentTags: ['keep session alive', 'persistent-session', 'detach-attach'],\n    description: 'detach/attach 루틴으로 작업 컨텍스트를 유지합니다.',\n    examples: ['tmux ls', 'tmux attach -t main'],\n    relatedActions: ['sim.session.new', 'sim.window.next'],\n    difficulty: 'daily',\n    playbookSlug: 'session-persistence',\n    practicePath: '/practice?lesson=attach-detach',\n  },\n  {\n    id: 'cs-tailscale-ssh',\n    title: 'Tailscale SSH 원격',\n    contentType: 'playbook',\n    intentTags: ['tailscale', 'remote-ssh', 'secure-remote'],\n    description: 'Tailscale SSH로 안전하게 접속해 tmux 세션(work)을 끊김 없이 복구하는 원격 운영 절차입니다.',\n    examples: ['sudo tailscale set --ssh', 'tailscale ssh user@host": "',\n    description: '현재 패인을 상하로 분할합니다.',\n    examples: ['상단 빌드, 하단 로그'],\n    relatedActions: ['sim.pane.split.horizontal'],\n    difficulty: 'beginner',\n    practicePath: '/practice?lesson=split-resize',\n  },\n  {\n    id: 'cs-window-new',\n    title: '새 윈도우 생성',\n    contentType: 'shortcut',\n    intentTags: ['window', 'new'],\n    shortcut: 'Ctrl+b (prefix) + c',\n    description: '새 tmux window를 생성합니다.',\n    examples: ['서비스별 window 분리'],\n    relatedActions: ['sim.window.new'],\n    difficulty: 'beginner',\n    practicePath: '/practice?lesson=basics',\n  },\n  {\n    id: 'cs-window-next',\n    title: '다음 윈도우 이동',\n    contentType: 'shortcut',\n    intentTags: ['window', 'next', 'navigation'],\n    shortcut: 'Ctrl+b (prefix) + n',\n    description: '다음 window로 이동합니다.',\n    examples: ['모니터링 window 순환'],\n    relatedActions: ['sim.window.next'],\n    difficulty: 'daily',\n    practicePath: '/practice?lesson=pane-focus-flow',\n  },\n  {\n    id: 'cs-copy-mode',\n    title: 'copy-mode 진입',\n    contentType: 'shortcut',\n    intentTags: ['copy-mode', 'search'],\n    shortcut: 'Ctrl+b (prefix) + [',\n    description: '스크롤/검색/선택 복사를 위한 copy-mode로 들어갑니다.',\n    examples: ['로그 검색 후 복사'],\n    relatedActions: ['sim.copymode.enter'],\n    difficulty: 'advanced',\n    practicePath: '/practice?lesson=copy-search',\n  },\n  {\n    id: 'cs-command-mode',\n    title: 'command mode 진입',\n    contentType: 'shortcut',\n    intentTags: ['command', 'colon'],\n    shortcut: 'Ctrl+b (prefix) + :',\n    description: 'tmux 명령을 직접 실행합니다.',\n    examples: ['new-window', 'split-window -h'],\n    relatedActions: ['sim.command.execute'],\n    difficulty: 'advanced',\n    practicePath: '/practice?lesson=command-subset',\n  },\n  {\n    id: 'cs-session-main',\n    title: '세션 유지 시작',\n    contentType: 'command',\n    intentTags: ['session', 'persistent-session', 'detach-attach'],\n    command: 'tmux new -As main',\n    description: '세션이 없으면 생성, 있으면 재사용합니다.',\n    examples: ['원격 서버 접속 직후 실행'],\n    relatedActions: ['sim.session.new'],\n    difficulty: 'daily',\n    practicePath: '/practice?lesson=attach-detach',\n  },\n  {\n    id: 'cs-recommended-config',\n    title: '권장 tmux.conf',\n    contentType: 'playbook',\n    intentTags: ['tmux.conf', 'config', 'recommended'],\n    description: 'mouse/base-index/mode-keys/리로드 바인딩까지 포함한 팀 공통 베이스 설정입니다.',\n    examples: ['set -g mouse on', 'setw -g mode-keys vi', 'bind r source-file ~/.tmux.conf'],\n    relatedActions: ['sim.config.apply'],\n    difficulty: 'daily',\n    playbookSlug: 'recommended-config',\n    practicePath: '/practice?lesson=command-subset',\n  },\n  {\n    id: 'cs-session-persistence',\n    title: '세션 유지 플레이북',\n    contentType: 'playbook',\n    intentTags: ['keep session alive', 'persistent-session', 'detach-attach'],\n    description: 'detach/attach 루틴으로 작업 컨텍스트를 유지합니다.',\n    examples: ['tmux ls', 'tmux attach -t main'],\n    relatedActions: ['sim.session.new', 'sim.window.next'],\n    difficulty: 'daily',\n    playbookSlug: 'session-persistence',\n    practicePath: '/practice?lesson=attach-detach',\n  },\n  {\n    id: 'cs-tailscale-ssh',\n    title: 'Tailscale SSH 원격',\n    contentType: 'playbook',\n    intentTags: ['tailscale', 'remote-ssh', 'secure-remote'],\n    description: 'Tailscale SSH로 안전하게 접속해 tmux 세션(work)을 끊김 없이 복구하는 원격 운영 절차입니다.',\n    examples: ['sudo tailscale set --ssh', 'tailscale ssh user@host",
  "',\n  'sim.choose.tree': 'tmux choose-tree -Z',\n};\nconst SHORTCUT_TOOLTIP_TEXT = '입력 순서: Ctrl 키를 누른 채 b를 누른 뒤 손을 떼고, 다음 키를 입력하세요.';\n\nfunction uniqueStrings(values: string[]) {\n  const normalized = values\n    .map((value) => value.trim())\n    .filter((value) => value.length > 0);\n  return Array.from(new Set(normalized));\n}\n\nfunction extractInlineCodeCandidates(text: string) {\n  return Array.from(text.matchAll(/`([^`]+)`/g))\n    .map((match) => match[1]?.trim() ?? '')\n    .filter((value) => value.length > 0);\n}\n\nfunction getShortcutTooltipForToken(token: string) {\n  const normalized = token.toLowerCase().replace(/\\s+/g, '');\n  if (normalized.includes('ctrl+b') || normalized.startsWith('prefix')) {\n    return SHORTCUT_TOOLTIP_TEXT;\n  }\n\n  return null;\n}\n\nfunction renderPlainHintSegmentWithTooltip(text: string, keyPrefix: string) {\n  return text.split(/(Ctrl\\s*\\+\\s*b)/gi).map((segment, index) => {\n    if (!segment) {\n      return null;\n    }\n\n    if (/^Ctrl\\s*\\+\\s*b$/i.test(segment)) {\n      return (\n        <span\n          key={`${keyPrefix}-shortcut-${index}`}\n          className=": "',\n  'sim.choose.tree': 'tmux choose-tree -Z',\n};\nconst SHORTCUT_TOOLTIP_TEXT = '입력 순서: Ctrl 키를 누른 채 b를 누른 뒤 손을 떼고, 다음 키를 입력하세요.';\n\nfunction uniqueStrings(values: string[]) {\n  const normalized = values\n    .map((value) => value.trim())\n    .filter((value) => value.length > 0);\n  return Array.from(new Set(normalized));\n}\n\nfunction extractInlineCodeCandidates(text: string) {\n  return Array.from(text.matchAll(/`([^`]+)`/g))\n    .map((match) => match[1]?.trim() ?? '')\n    .filter((value) => value.length > 0);\n}\n\nfunction getShortcutTooltipForToken(token: string) {\n  const normalized = token.toLowerCase().replace(/\\s+/g, '');\n  if (normalized.includes('ctrl+b') || normalized.startsWith('prefix')) {\n    return SHORTCUT_TOOLTIP_TEXT;\n  }\n\n  return null;\n}\n\nfunction renderPlainHintSegmentWithTooltip(text: string, keyPrefix: string) {\n  return text.split(/(Ctrl\\s*\\+\\s*b)/gi).map((segment, index) => {\n    if (!segment) {\n      return null;\n    }\n\n    if (/^Ctrl\\s*\\+\\s*b$/i.test(segment)) {\n      return (\n        <span\n          key={`${keyPrefix}-shortcut-${index}`}\n          className=",
  "',\n  },\n  {\n    label: 'Copy Search 성공',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux copy-mode -t lesson:0.0; tmux send-keys -t lesson:0.0 -X search-backward": "',\n  },\n  {\n    label: 'Copy Search 성공',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux copy-mode -t lesson:0.0; tmux send-keys -t lesson:0.0 -X search-backward",
  "',\n  },\n  {\n    label: 'Pane 줌 토글',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux resize-pane -t lesson:0.0 -Z; tmux display-message -p": "',\n  },\n  {\n    label: 'Pane 줌 토글',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux resize-pane -t lesson:0.0 -Z; tmux display-message -p",
  "',\n  },\n  {\n    label: 'Pane Sync ON',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux set-window-option -t lesson:0 synchronize-panes on; tmux show-window-options -t lesson:0 -v synchronize-panes',\n  },\n] as const;\n\nconst LEARNING_PATH_ENTRY_LESSON = 'hello-tmux';\nconst LESSON_FILTER_OPTIONS: Array<{ value: LessonFilter; label: string }> = [\n  { value: 'all', label: '전체' },\n  { value: 'continue', label: '이어하기' },\n  { value: 'incomplete', label: '미완료' },\n  { value: 'completed', label: '완료' },\n];\n\nfunction resolveAssetPath(relativePath: string) {\n  const base = import.meta.env.BASE_URL ?? '/';\n  const normalizedBase = base.endsWith('/') ? base : `${base}/`;\n  const normalizedRelative = relativePath.replace(/^\\/+/, '');\n  return `${normalizedBase}${normalizedRelative}`;\n}\n\nconst VM_BOOT_CONFIG = {\n  wasmPath: resolveAssetPath('vm/v86.wasm'),\n  wasmFallbackPath: resolveAssetPath('vm/v86-fallback.wasm'),\n  biosPath: resolveAssetPath('vm/seabios.bin'),\n  vgaBiosPath: resolveAssetPath('vm/vgabios.bin'),\n  fsBasePath: resolveAssetPath('vm/alpine-tmux-flat/'),\n  fsJsonPath: resolveAssetPath('vm/alpine-tmux-fs.json'),\n  initialStatePath:\n    (import.meta.env.VITE_VM_INITIAL_STATE_PATH as string | undefined)?.trim() ||\n    resolveAssetPath('vm/alpine-tmux-ready.bin.zst'),\n};\n\nfunction hasValidVmStateMagic(buffer: ArrayBuffer) {\n  if (buffer.byteLength < 4) {\n    return false;\n  }\n\n  const magic = new DataView(buffer).getUint32(0, true);\n  return magic === V86_STATE_MAGIC_LE || magic === ZSTD_MAGIC_LE;\n}\n\nasync function loadVmInitialState(initialStatePath: string): Promise<VmInitialState | null> {\n  if (!initialStatePath) {\n    return null;\n  }\n\n  try {\n    const response = await fetch(initialStatePath, { cache: 'no-cache' });\n    if (!response.ok) {\n      return null;\n    }\n\n    const contentType = (response.headers.get('content-type') ?? '').toLowerCase();\n    if (contentType.includes('text/html')) {\n      return null;\n    }\n\n    const stateBuffer = await response.arrayBuffer();\n    if (stateBuffer.byteLength < 1024 || !hasValidVmStateMagic(stateBuffer)) {\n      return null;\n    }\n\n    return { buffer: stateBuffer };\n  } catch {\n    return null;\n  }\n}\n\nfunction trimHistory(history: string[], max: number) {\n  if (history.length <= max) {\n    return history;\n  }\n  return history.slice(history.length - max);\n}\n\nfunction appendHistory(history: string[], nextItem: string, max: number) {\n  const normalized = nextItem.trim();\n  if (!normalized) {\n    return history;\n  }\n\n  if (history[history.length - 1] === normalized) {\n    return history;\n  }\n\n  return trimHistory([...history, normalized], max);\n}\n\nfunction appendActions(history: string[], actions: string[], max: number) {\n  if (actions.length === 0) {\n    return history;\n  }\n\n  return trimHistory([...history, ...actions], max);\n}\n\nfunction getDifficultyLabel(difficulty: AppMission['difficulty']) {\n  switch (difficulty) {\n    case 'beginner':\n      return '입문';\n    case 'daily':\n      return '실전';\n    case 'advanced':\n      return '고급';\n    case 'scenario':\n      return '시나리오';\n    default:\n      return difficulty;\n  }\n}\n\nfunction getMetricBadgeClass(status: VmStatus) {\n  if (status === 'running') {\n    return 'is-running';\n  }\n  if (status === 'booting') {\n    return 'is-booting';\n  }\n  if (status === 'error') {\n    return 'is-error';\n  }\n  return 'is-idle';\n}\n\ntype MissionPreconditionItem = {\n  key: string;\n  label: string;\n  current: string;\n  satisfied: boolean;\n};\n\nconst ACTION_HISTORY_COMMAND_SUGGESTIONS: Record<string, string> = {\n  'sim.pane.resize': 'tmux resize-pane -R 5',\n  'sim.command.prompt': 'tmux command-prompt -p": "',\n  },\n  {\n    label: 'Pane Sync ON',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux set-window-option -t lesson:0 synchronize-panes on; tmux show-window-options -t lesson:0 -v synchronize-panes',\n  },\n] as const;\n\nconst LEARNING_PATH_ENTRY_LESSON = 'hello-tmux';\nconst LESSON_FILTER_OPTIONS: Array<{ value: LessonFilter; label: string }> = [\n  { value: 'all', label: '전체' },\n  { value: 'continue', label: '이어하기' },\n  { value: 'incomplete', label: '미완료' },\n  { value: 'completed', label: '완료' },\n];\n\nfunction resolveAssetPath(relativePath: string) {\n  const base = import.meta.env.BASE_URL ?? '/';\n  const normalizedBase = base.endsWith('/') ? base : `${base}/`;\n  const normalizedRelative = relativePath.replace(/^\\/+/, '');\n  return `${normalizedBase}${normalizedRelative}`;\n}\n\nconst VM_BOOT_CONFIG = {\n  wasmPath: resolveAssetPath('vm/v86.wasm'),\n  wasmFallbackPath: resolveAssetPath('vm/v86-fallback.wasm'),\n  biosPath: resolveAssetPath('vm/seabios.bin'),\n  vgaBiosPath: resolveAssetPath('vm/vgabios.bin'),\n  fsBasePath: resolveAssetPath('vm/alpine-tmux-flat/'),\n  fsJsonPath: resolveAssetPath('vm/alpine-tmux-fs.json'),\n  initialStatePath:\n    (import.meta.env.VITE_VM_INITIAL_STATE_PATH as string | undefined)?.trim() ||\n    resolveAssetPath('vm/alpine-tmux-ready.bin.zst'),\n};\n\nfunction hasValidVmStateMagic(buffer: ArrayBuffer) {\n  if (buffer.byteLength < 4) {\n    return false;\n  }\n\n  const magic = new DataView(buffer).getUint32(0, true);\n  return magic === V86_STATE_MAGIC_LE || magic === ZSTD_MAGIC_LE;\n}\n\nasync function loadVmInitialState(initialStatePath: string): Promise<VmInitialState | null> {\n  if (!initialStatePath) {\n    return null;\n  }\n\n  try {\n    const response = await fetch(initialStatePath, { cache: 'no-cache' });\n    if (!response.ok) {\n      return null;\n    }\n\n    const contentType = (response.headers.get('content-type') ?? '').toLowerCase();\n    if (contentType.includes('text/html')) {\n      return null;\n    }\n\n    const stateBuffer = await response.arrayBuffer();\n    if (stateBuffer.byteLength < 1024 || !hasValidVmStateMagic(stateBuffer)) {\n      return null;\n    }\n\n    return { buffer: stateBuffer };\n  } catch {\n    return null;\n  }\n}\n\nfunction trimHistory(history: string[], max: number) {\n  if (history.length <= max) {\n    return history;\n  }\n  return history.slice(history.length - max);\n}\n\nfunction appendHistory(history: string[], nextItem: string, max: number) {\n  const normalized = nextItem.trim();\n  if (!normalized) {\n    return history;\n  }\n\n  if (history[history.length - 1] === normalized) {\n    return history;\n  }\n\n  return trimHistory([...history, normalized], max);\n}\n\nfunction appendActions(history: string[], actions: string[], max: number) {\n  if (actions.length === 0) {\n    return history;\n  }\n\n  return trimHistory([...history, ...actions], max);\n}\n\nfunction getDifficultyLabel(difficulty: AppMission['difficulty']) {\n  switch (difficulty) {\n    case 'beginner':\n      return '입문';\n    case 'daily':\n      return '실전';\n    case 'advanced':\n      return '고급';\n    case 'scenario':\n      return '시나리오';\n    default:\n      return difficulty;\n  }\n}\n\nfunction getMetricBadgeClass(status: VmStatus) {\n  if (status === 'running') {\n    return 'is-running';\n  }\n  if (status === 'booting') {\n    return 'is-booting';\n  }\n  if (status === 'error') {\n    return 'is-error';\n  }\n  return 'is-idle';\n}\n\ntype MissionPreconditionItem = {\n  key: string;\n  label: string;\n  current: string;\n  satisfied: boolean;\n};\n\nconst ACTION_HISTORY_COMMAND_SUGGESTIONS: Record<string, string> = {\n  'sim.pane.resize': 'tmux resize-pane -R 5',\n  'sim.command.prompt': 'tmux command-prompt -p",
  "'];\n    default:\n      return [];\n  }\n}\n\nfunction buildMissionCommandSuggestions(mission: AppMission | null) {\n  if (!mission) {\n    return [];\n  }\n\n  const commandsFromRules = mission.passRules.flatMap((rule) => getRuleCommandSuggestions(rule));\n  const commandsFromHints = mission.hints\n    .flatMap((hint) => extractInlineCodeCandidates(hint))\n    .filter((candidate) => isLikelyCommandText(candidate));\n\n  return uniqueStrings([...commandsFromRules, ...commandsFromHints]).slice(0, 6);\n}\n\nfunction getRuleMetricValue(snapshot: VmBridgeSnapshot, kind: string): unknown {\n  switch (kind) {\n    case 'sessionCount':\n      return snapshot.sessionCount;\n    case 'windowCount':\n      return snapshot.windowCount;\n    case 'paneCount':\n      return snapshot.paneCount;\n    case 'modeIs':\n      return snapshot.modeIs;\n    case 'sessionName':\n      return snapshot.sessionName;\n    case 'activeWindowIndex':\n      return snapshot.activeWindowIndex;\n    case 'windowLayout':\n      return snapshot.windowLayout;\n    case 'windowZoomed':\n      return snapshot.windowZoomed;\n    case 'paneSynchronized':\n      return snapshot.paneSynchronized;\n    case 'searchExecuted':\n      return snapshot.searchExecuted;\n    case 'searchMatchFound':\n      return snapshot.searchMatchFound;\n    case 'actionHistoryText':\n      return snapshot.actionHistory.join(' ');\n    case 'shellHistoryText':\n      return snapshot.commandHistory.join(' ');\n    default:\n      return undefined;\n  }\n}\n\nfunction evaluateRuleOperator(actual: unknown, operator: string, expected: unknown) {\n  switch (operator) {\n    case 'equals':\n      return actual === expected;\n    case '>=':\n      return typeof actual === 'number' && typeof expected === 'number' && actual >= expected;\n    case '<=':\n      return typeof actual === 'number' && typeof expected === 'number' && actual <= expected;\n    case 'contains':\n      if (typeof actual === 'string' && typeof expected === 'string') {\n        return actual.includes(expected);\n      }\n      if (Array.isArray(actual)) {\n        return actual.some((value) => value === expected);\n      }\n      return false;\n    default:\n      return false;\n  }\n}\n\nfunction getRulePreconditionLabel(rule: AppMission['passRules'][number]) {\n  switch (rule.kind) {\n    case 'sessionCount':\n      return `세션 수가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'windowCount':\n      return `윈도우 수가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'paneCount':\n      return `패인 수가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'activeWindowIndex':\n      return `활성 윈도우 인덱스가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'modeIs':\n      return rule.value === 'COPY_MODE'\n        ? 'Copy Mode에 진입해야 함'\n        : `mode 값이 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'searchExecuted':\n      return 'Copy Mode에서 검색을 실행해야 함';\n    case 'searchMatchFound':\n      return rule.value === true ? '검색 결과가 있어야 함' : '검색 결과가 없어야 함';\n    case 'shellHistoryText':\n      return `쉘 히스토리에 ${JSON.stringify(rule.value)} 실행 기록이 있어야 함`;\n    case 'actionHistoryText':\n      return `tmux 액션 로그에 ${JSON.stringify(rule.value)} 기록이 있어야 함`;\n    default:\n      return `${rule.kind} ${rule.operator} ${JSON.stringify(rule.value)} 조건`;\n  }\n}\n\nfunction getRuleCurrentStateText(rule: AppMission['passRules'][number], snapshot: VmBridgeSnapshot) {\n  switch (rule.kind) {\n    case 'sessionCount':\n      return `현재 session: ${snapshot.sessionCount ?? '-'}`;\n    case 'windowCount':\n      return `현재 window: ${snapshot.windowCount ?? '-'}`;\n    case 'paneCount':\n      return `현재 pane: ${snapshot.paneCount ?? '-'}`;\n    case 'activeWindowIndex':\n      return `현재 activeWindow: ${snapshot.activeWindowIndex ?? '-'}`;\n    case 'modeIs':\n      return `현재 mode: ${snapshot.modeIs ?? '-'}`;\n    case 'searchExecuted':\n      return `현재 searchExecuted: ${snapshot.searchExecuted === null ? '-' : snapshot.searchExecuted ? 'yes' : 'no'}`;\n    case 'searchMatchFound':\n      return `현재 searchMatchFound: ${\n        snapshot.searchMatchFound === null ? '-' : snapshot.searchMatchFound ? 'yes' : 'no'\n      }`;\n    case 'shellHistoryText': {\n      const expected = typeof rule.value === 'string' ? rule.value : null;\n      if (!expected) {\n        return `최근 명령 ${snapshot.commandHistory.length}개`;\n      }\n      const found = snapshot.commandHistory.some((command) => command.includes(expected));\n      return found ? `최근 명령에서": "'];\n    default:\n      return [];\n  }\n}\n\nfunction buildMissionCommandSuggestions(mission: AppMission | null) {\n  if (!mission) {\n    return [];\n  }\n\n  const commandsFromRules = mission.passRules.flatMap((rule) => getRuleCommandSuggestions(rule));\n  const commandsFromHints = mission.hints\n    .flatMap((hint) => extractInlineCodeCandidates(hint))\n    .filter((candidate) => isLikelyCommandText(candidate));\n\n  return uniqueStrings([...commandsFromRules, ...commandsFromHints]).slice(0, 6);\n}\n\nfunction getRuleMetricValue(snapshot: VmBridgeSnapshot, kind: string): unknown {\n  switch (kind) {\n    case 'sessionCount':\n      return snapshot.sessionCount;\n    case 'windowCount':\n      return snapshot.windowCount;\n    case 'paneCount':\n      return snapshot.paneCount;\n    case 'modeIs':\n      return snapshot.modeIs;\n    case 'sessionName':\n      return snapshot.sessionName;\n    case 'activeWindowIndex':\n      return snapshot.activeWindowIndex;\n    case 'windowLayout':\n      return snapshot.windowLayout;\n    case 'windowZoomed':\n      return snapshot.windowZoomed;\n    case 'paneSynchronized':\n      return snapshot.paneSynchronized;\n    case 'searchExecuted':\n      return snapshot.searchExecuted;\n    case 'searchMatchFound':\n      return snapshot.searchMatchFound;\n    case 'actionHistoryText':\n      return snapshot.actionHistory.join(' ');\n    case 'shellHistoryText':\n      return snapshot.commandHistory.join(' ');\n    default:\n      return undefined;\n  }\n}\n\nfunction evaluateRuleOperator(actual: unknown, operator: string, expected: unknown) {\n  switch (operator) {\n    case 'equals':\n      return actual === expected;\n    case '>=':\n      return typeof actual === 'number' && typeof expected === 'number' && actual >= expected;\n    case '<=':\n      return typeof actual === 'number' && typeof expected === 'number' && actual <= expected;\n    case 'contains':\n      if (typeof actual === 'string' && typeof expected === 'string') {\n        return actual.includes(expected);\n      }\n      if (Array.isArray(actual)) {\n        return actual.some((value) => value === expected);\n      }\n      return false;\n    default:\n      return false;\n  }\n}\n\nfunction getRulePreconditionLabel(rule: AppMission['passRules'][number]) {\n  switch (rule.kind) {\n    case 'sessionCount':\n      return `세션 수가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'windowCount':\n      return `윈도우 수가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'paneCount':\n      return `패인 수가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'activeWindowIndex':\n      return `활성 윈도우 인덱스가 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'modeIs':\n      return rule.value === 'COPY_MODE'\n        ? 'Copy Mode에 진입해야 함'\n        : `mode 값이 ${rule.operator} ${String(rule.value)} 이어야 함`;\n    case 'searchExecuted':\n      return 'Copy Mode에서 검색을 실행해야 함';\n    case 'searchMatchFound':\n      return rule.value === true ? '검색 결과가 있어야 함' : '검색 결과가 없어야 함';\n    case 'shellHistoryText':\n      return `쉘 히스토리에 ${JSON.stringify(rule.value)} 실행 기록이 있어야 함`;\n    case 'actionHistoryText':\n      return `tmux 액션 로그에 ${JSON.stringify(rule.value)} 기록이 있어야 함`;\n    default:\n      return `${rule.kind} ${rule.operator} ${JSON.stringify(rule.value)} 조건`;\n  }\n}\n\nfunction getRuleCurrentStateText(rule: AppMission['passRules'][number], snapshot: VmBridgeSnapshot) {\n  switch (rule.kind) {\n    case 'sessionCount':\n      return `현재 session: ${snapshot.sessionCount ?? '-'}`;\n    case 'windowCount':\n      return `현재 window: ${snapshot.windowCount ?? '-'}`;\n    case 'paneCount':\n      return `현재 pane: ${snapshot.paneCount ?? '-'}`;\n    case 'activeWindowIndex':\n      return `현재 activeWindow: ${snapshot.activeWindowIndex ?? '-'}`;\n    case 'modeIs':\n      return `현재 mode: ${snapshot.modeIs ?? '-'}`;\n    case 'searchExecuted':\n      return `현재 searchExecuted: ${snapshot.searchExecuted === null ? '-' : snapshot.searchExecuted ? 'yes' : 'no'}`;\n    case 'searchMatchFound':\n      return `현재 searchMatchFound: ${\n        snapshot.searchMatchFound === null ? '-' : snapshot.searchMatchFound ? 'yes' : 'no'\n      }`;\n    case 'shellHistoryText': {\n      const expected = typeof rule.value === 'string' ? rule.value : null;\n      if (!expected) {\n        return `최근 명령 ${snapshot.commandHistory.length}개`;\n      }\n      const found = snapshot.commandHistory.some((command) => command.includes(expected));\n      return found ? `최근 명령에서",
  ")\n              .join(' / ') || '데이터 없음'}\n          </p>\n        </article>\n        <article className=\"bookmark-metric-card\">\n          <h2>상위 태그</h2>\n          <p className=\"muted\">\n            {topTags.map(([tag, count]) =>": ")\n              .join(' / ') || '데이터 없음'}\n          </p>\n        </article>\n        <article className=\"bookmark-metric-card\">\n          <h2>상위 태그</h2>\n          <p className=\"muted\">\n            {topTags.map(([tag, count]) =>",
  ")\n    .join(', ');\n}\n\nfunction formatPrimaryRule(result: MissionGradeResult) {\n  const firstRule = result.failedRules[0];\n  if (!firstRule) {\n    return '실패 룰 없음';\n  }\n\n  return": ")\n    .join(', ');\n}\n\nfunction formatPrimaryRule(result: MissionGradeResult) {\n  const firstRule = result.failedRules[0];\n  if (!firstRule) {\n    return '실패 룰 없음';\n  }\n\n  return",
  ") {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Lesson\"\n        title=\"레슨 로드 실패\"\n        description=\"콘텐츠를 읽는 중 오류가 발생했습니다.\"\n      >\n        <EmptyState title=\"레슨 정보를 읽지 못했습니다\" description=\"잠시 후 다시 시도해 주세요.\" />\n      </PagePlaceholder>\n    );\n  }\n\n  const { track, chapter, lesson, missions, termGlossary } = pageState;\n  const lessonTerms = resolveLessonTerms(lesson, missions, termGlossary ?? null);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Lesson\"\n      title={`${track.title} · ${chapter.title}`}\n      description={`${lesson.title} · 예상 ${lesson.estimatedMinutes}분`}\n    >\n      <section className=\"lesson-section lesson-action-panel\">\n        <ul className=\"lesson-pill-row\">\n          <li className=\"lesson-pill\">예상 {lesson.estimatedMinutes}분</li>\n          <li className=\"lesson-pill\">학습 목표 {lesson.objectives.length}개</li>\n          <li className=\"lesson-pill\">미션 {missions.length}개</li>\n        </ul>\n        <div className=\"inline-actions\">\n          <Link className=\"primary-btn\" to={`/practice?lesson=${lesson.slug}`}>\n            시뮬레이터에서 레슨 시작\n          </Link>\n          <Link className=\"secondary-btn\" to=\"/learn\">\n            커리큘럼 목록\n          </Link>\n        </div>\n      </section>\n\n      <section className=\"lesson-section lesson-brief\">\n        <h2>레슨 가이드</h2>\n        <div className=\"lesson-summary\">\n          {lesson.overview ? (\n            <p>\n              <strong>레슨 소개:</strong> {renderTextWithShortcutTooltip(lesson.overview,": ") {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Lesson\"\n        title=\"레슨 로드 실패\"\n        description=\"콘텐츠를 읽는 중 오류가 발생했습니다.\"\n      >\n        <EmptyState title=\"레슨 정보를 읽지 못했습니다\" description=\"잠시 후 다시 시도해 주세요.\" />\n      </PagePlaceholder>\n    );\n  }\n\n  const { track, chapter, lesson, missions, termGlossary } = pageState;\n  const lessonTerms = resolveLessonTerms(lesson, missions, termGlossary ?? null);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Lesson\"\n      title={`${track.title} · ${chapter.title}`}\n      description={`${lesson.title} · 예상 ${lesson.estimatedMinutes}분`}\n    >\n      <section className=\"lesson-section lesson-action-panel\">\n        <ul className=\"lesson-pill-row\">\n          <li className=\"lesson-pill\">예상 {lesson.estimatedMinutes}분</li>\n          <li className=\"lesson-pill\">학습 목표 {lesson.objectives.length}개</li>\n          <li className=\"lesson-pill\">미션 {missions.length}개</li>\n        </ul>\n        <div className=\"inline-actions\">\n          <Link className=\"primary-btn\" to={`/practice?lesson=${lesson.slug}`}>\n            시뮬레이터에서 레슨 시작\n          </Link>\n          <Link className=\"secondary-btn\" to=\"/learn\">\n            커리큘럼 목록\n          </Link>\n        </div>\n      </section>\n\n      <section className=\"lesson-section lesson-brief\">\n        <h2>레슨 가이드</h2>\n        <div className=\"lesson-summary\">\n          {lesson.overview ? (\n            <p>\n              <strong>레슨 소개:</strong> {renderTextWithShortcutTooltip(lesson.overview,",
  ") {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Lesson\"\n        title=\"레슨을 찾을 수 없습니다\"\n        description=\"잘못된 경로이거나 콘텐츠가 변경되었습니다.\"\n      >\n        <EmptyState title=\"유효한 레슨이 없습니다\" description=\"커리큘럼 페이지에서 다시 선택해 주세요.\" />\n        <div className=\"inline-actions\">\n          <Link className=\"secondary-btn\" to=\"/learn\">\n            커리큘럼으로 이동\n          </Link>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  if (pageState.status ===": ") {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Lesson\"\n        title=\"레슨을 찾을 수 없습니다\"\n        description=\"잘못된 경로이거나 콘텐츠가 변경되었습니다.\"\n      >\n        <EmptyState title=\"유효한 레슨이 없습니다\" description=\"커리큘럼 페이지에서 다시 선택해 주세요.\" />\n        <div className=\"inline-actions\">\n          <Link className=\"secondary-btn\" to=\"/learn\">\n            커리큘럼으로 이동\n          </Link>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  if (pageState.status ===",
  ");\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Playbook Copied\"\n      title=\"명령 복사 완료\"\n      description=\"플레이북 명령 복사가 기록되었습니다. 이 라우트는 KPI 측정용으로도 사용됩니다.\"\n    >\n      <ul className=\"link-list\">\n        <li>playbook: {playbookSlug ??": ");\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Playbook Copied\"\n      title=\"명령 복사 완료\"\n      description=\"플레이북 명령 복사가 기록되었습니다. 이 라우트는 KPI 측정용으로도 사용됩니다.\"\n    >\n      <ul className=\"link-list\">\n        <li>playbook: {playbookSlug ??",
  ");\n          }}\n        >\n          온보딩 시작\n        </button>\n        <button\n          type=\"button\"\n          className=\"secondary-btn\"\n          onClick={() => navigate(": ");\n          }}\n        >\n          온보딩 시작\n        </button>\n        <button\n          type=\"button\"\n          className=\"secondary-btn\"\n          onClick={() => navigate(",
  ");\n          }}\n        >\n          첫 미션 시작\n        </button>\n        <button type=\"button\" className=\"secondary-btn\" onClick={() => navigate(": ");\n          }}\n        >\n          첫 미션 시작\n        </button>\n        <button type=\"button\" className=\"secondary-btn\" onClick={() => navigate(",
  ");\n  const [playbooks, setPlaybooks] = useState<AppPlaybook[]>([]);\n  const index = useMemo(() => buildCheatsheetIndex(CHEATSHEET_ITEMS), []);\n\n  useEffect(() => {\n    loadAppContent()\n      .then((content) => setPlaybooks(content.playbooks))\n      .catch(() => setPlaybooks([]));\n  }, []);\n\n  const normalizedQuery = query.trim();\n  const results = useMemo(() => searchCheatsheet(index, normalizedQuery, 18), [index, normalizedQuery]);\n  const featuredReferences = useMemo(() => {\n    if (normalizedQuery.length > 0) {\n      return results;\n    }\n\n    return CHEATSHEET_ITEMS.slice(0, 10);\n  }, [normalizedQuery, results]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Reference Hub\"\n      title=\"치트시트 + 플레이북 통합 레퍼런스\"\n      description=\"짧은 명령은 실습 워크벤치에서 바로 검증하고, 운영 절차형 주제는 플레이북으로 깊게 학습하세요.\"\n    >\n      <section className=\"reference-hub-head\">\n        <p className=\"muted\">\n          단축키 표기 안내: `Ctrl+b`는 tmux 기본 prefix 키입니다. 문서의 `prefix`는 보통 `Ctrl+b`를 의미합니다.\n        </p>\n        <input\n          className=\"sim-input reference-search-input\"\n          value={query}\n          onChange={(event) => setQuery(event.target.value)}\n          placeholder=\"예: split, tmux.conf, session, copy-mode\"\n          aria-label=\"Reference search\"\n        />\n        <div className=\"reference-chip-row\">\n          {QUICK_QUERY_PRESETS.map((preset) => (\n            <button key={preset} type=\"button\" className=\"secondary-btn reference-chip\" onClick={() => setQuery(preset)}>\n              {preset}\n            </button>\n          ))}\n        </div>\n      </section>\n\n      <section className=\"reference-section\">\n        <h2>{normalizedQuery.length > 0 ? `검색 결과 (${results.length})` :": ");\n  const [playbooks, setPlaybooks] = useState<AppPlaybook[]>([]);\n  const index = useMemo(() => buildCheatsheetIndex(CHEATSHEET_ITEMS), []);\n\n  useEffect(() => {\n    loadAppContent()\n      .then((content) => setPlaybooks(content.playbooks))\n      .catch(() => setPlaybooks([]));\n  }, []);\n\n  const normalizedQuery = query.trim();\n  const results = useMemo(() => searchCheatsheet(index, normalizedQuery, 18), [index, normalizedQuery]);\n  const featuredReferences = useMemo(() => {\n    if (normalizedQuery.length > 0) {\n      return results;\n    }\n\n    return CHEATSHEET_ITEMS.slice(0, 10);\n  }, [normalizedQuery, results]);\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Reference Hub\"\n      title=\"치트시트 + 플레이북 통합 레퍼런스\"\n      description=\"짧은 명령은 실습 워크벤치에서 바로 검증하고, 운영 절차형 주제는 플레이북으로 깊게 학습하세요.\"\n    >\n      <section className=\"reference-hub-head\">\n        <p className=\"muted\">\n          단축키 표기 안내: `Ctrl+b`는 tmux 기본 prefix 키입니다. 문서의 `prefix`는 보통 `Ctrl+b`를 의미합니다.\n        </p>\n        <input\n          className=\"sim-input reference-search-input\"\n          value={query}\n          onChange={(event) => setQuery(event.target.value)}\n          placeholder=\"예: split, tmux.conf, session, copy-mode\"\n          aria-label=\"Reference search\"\n        />\n        <div className=\"reference-chip-row\">\n          {QUICK_QUERY_PRESETS.map((preset) => (\n            <button key={preset} type=\"button\" className=\"secondary-btn reference-chip\" onClick={() => setQuery(preset)}>\n              {preset}\n            </button>\n          ))}\n        </div>\n      </section>\n\n      <section className=\"reference-section\">\n        <h2>{normalizedQuery.length > 0 ? `검색 결과 (${results.length})` :",
  ").join(', ') || '태그 없음'}\n          </p>\n        </article>\n      </section>\n\n      <form\n        className=\"bookmark-form bookmark-form-card\"\n        onSubmit={(event) => {\n          event.preventDefault();\n          if (!title.trim() || !targetId.trim()) {\n            return;\n          }\n          void createBookmark({\n            type,\n            targetId: targetId.trim(),\n            title: title.trim(),\n            tags: tagsInput\n              .split(',')\n              .map((tag) => tag.trim())\n              .filter(Boolean),\n          });\n          setTitle('');\n          setTargetId('');\n          setTagsInput('');\n        }}\n      >\n        <input\n          className=\"sim-input\"\n          value={title}\n          onChange={(event) => setTitle(event.target.value)}\n          placeholder=\"북마크 제목\"\n          aria-label=\"Bookmark title\"\n        />\n        <input\n          className=\"sim-input\"\n          value={targetId}\n          onChange={(event) => setTargetId(event.target.value)}\n          placeholder=\"대상 ID (예: mission-a-01)\"\n          aria-label=\"Bookmark target id\"\n        />\n        <select className=\"sim-input\" value={type} onChange={(event) => setType(event.target.value as typeof type)}>\n          <option value=\"lesson\">lesson</option>\n          <option value=\"mission\">mission</option>\n          <option value=\"cheatsheet_item\">cheatsheet_item</option>\n          <option value=\"action_pattern\">action_pattern</option>\n          <option value=\"playbook\">playbook</option>\n          <option value=\"snapshot\">snapshot</option>\n        </select>\n        <input\n          className=\"sim-input\"\n          value={tagsInput}\n          onChange={(event) => setTagsInput(event.target.value)}\n          placeholder=\"태그 , 구분 (예: session,remote)\"\n          aria-label=\"Bookmark tags\"\n        />\n        <button type=\"submit\" className=\"primary-btn\">\n          북마크 저장\n        </button>\n      </form>\n\n      <div className=\"inline-actions bookmark-filter-row\">\n        <input\n          className=\"sim-input\"\n          value={tagFilter}\n          onChange={(event) => setTagFilter(event.target.value)}\n          placeholder=\"태그 필터\"\n          aria-label=\"Tag filter\"\n        />\n        <select\n          className=\"sim-input\"\n          value={sortOrder}\n          onChange={(event) => setSortOrder(event.target.value as typeof sortOrder)}\n        >\n          <option value=\"newest\">최신순</option>\n          <option value=\"oldest\">오래된순</option>\n        </select>\n      </div>\n\n      {loading ? (\n        <EmptyState title=\"로딩 중\" description=\"북마크를 불러오고 있습니다.\" />\n      ) : filteredBookmarks.length === 0 ? (\n        <EmptyState\n          title=\"아직 저장된 항목이 없습니다\"\n          description=\"실습 중 중요한 레슨/패턴을 저장하면 여기에 누적됩니다.\"\n        />\n      ) : (\n        <div className=\"bookmark-list-grid\">\n          {filteredBookmarks.map((bookmark) => (\n            <article key={bookmark.id} className=\"bookmark-list-card\">\n              <h2>\n                {bookmark.title} <span className=\"muted\">[{bookmark.type}]</span>\n              </h2>\n              <p className=\"muted\">\n                target: {bookmark.targetId} / tags: {bookmark.tags.join(', ') || '(none)'}\n              </p>\n              <div className=\"inline-actions\">\n                {buildBookmarkPracticeLink(bookmark) ? (\n                  <Link to={buildBookmarkPracticeLink(bookmark) ?? '/practice'} className=\"secondary-btn\">\n                    실습 열기\n                  </Link>\n                ) : null}\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => {\n                    void deleteBookmark(bookmark.id);\n                  }}\n                >\n                  삭제\n                </button>\n              </div>\n              <textarea\n                className=\"bookmark-note\"\n                value={notesByBookmarkId[bookmark.id] ?? ''}\n                onChange={(event) => {\n                  void saveBookmarkNote(bookmark.id, event.target.value);\n                }}\n                placeholder=\"개인 노트\"\n                aria-label={": ").join(', ') || '태그 없음'}\n          </p>\n        </article>\n      </section>\n\n      <form\n        className=\"bookmark-form bookmark-form-card\"\n        onSubmit={(event) => {\n          event.preventDefault();\n          if (!title.trim() || !targetId.trim()) {\n            return;\n          }\n          void createBookmark({\n            type,\n            targetId: targetId.trim(),\n            title: title.trim(),\n            tags: tagsInput\n              .split(',')\n              .map((tag) => tag.trim())\n              .filter(Boolean),\n          });\n          setTitle('');\n          setTargetId('');\n          setTagsInput('');\n        }}\n      >\n        <input\n          className=\"sim-input\"\n          value={title}\n          onChange={(event) => setTitle(event.target.value)}\n          placeholder=\"북마크 제목\"\n          aria-label=\"Bookmark title\"\n        />\n        <input\n          className=\"sim-input\"\n          value={targetId}\n          onChange={(event) => setTargetId(event.target.value)}\n          placeholder=\"대상 ID (예: mission-a-01)\"\n          aria-label=\"Bookmark target id\"\n        />\n        <select className=\"sim-input\" value={type} onChange={(event) => setType(event.target.value as typeof type)}>\n          <option value=\"lesson\">lesson</option>\n          <option value=\"mission\">mission</option>\n          <option value=\"cheatsheet_item\">cheatsheet_item</option>\n          <option value=\"action_pattern\">action_pattern</option>\n          <option value=\"playbook\">playbook</option>\n          <option value=\"snapshot\">snapshot</option>\n        </select>\n        <input\n          className=\"sim-input\"\n          value={tagsInput}\n          onChange={(event) => setTagsInput(event.target.value)}\n          placeholder=\"태그 , 구분 (예: session,remote)\"\n          aria-label=\"Bookmark tags\"\n        />\n        <button type=\"submit\" className=\"primary-btn\">\n          북마크 저장\n        </button>\n      </form>\n\n      <div className=\"inline-actions bookmark-filter-row\">\n        <input\n          className=\"sim-input\"\n          value={tagFilter}\n          onChange={(event) => setTagFilter(event.target.value)}\n          placeholder=\"태그 필터\"\n          aria-label=\"Tag filter\"\n        />\n        <select\n          className=\"sim-input\"\n          value={sortOrder}\n          onChange={(event) => setSortOrder(event.target.value as typeof sortOrder)}\n        >\n          <option value=\"newest\">최신순</option>\n          <option value=\"oldest\">오래된순</option>\n        </select>\n      </div>\n\n      {loading ? (\n        <EmptyState title=\"로딩 중\" description=\"북마크를 불러오고 있습니다.\" />\n      ) : filteredBookmarks.length === 0 ? (\n        <EmptyState\n          title=\"아직 저장된 항목이 없습니다\"\n          description=\"실습 중 중요한 레슨/패턴을 저장하면 여기에 누적됩니다.\"\n        />\n      ) : (\n        <div className=\"bookmark-list-grid\">\n          {filteredBookmarks.map((bookmark) => (\n            <article key={bookmark.id} className=\"bookmark-list-card\">\n              <h2>\n                {bookmark.title} <span className=\"muted\">[{bookmark.type}]</span>\n              </h2>\n              <p className=\"muted\">\n                target: {bookmark.targetId} / tags: {bookmark.tags.join(', ') || '(none)'}\n              </p>\n              <div className=\"inline-actions\">\n                {buildBookmarkPracticeLink(bookmark) ? (\n                  <Link to={buildBookmarkPracticeLink(bookmark) ?? '/practice'} className=\"secondary-btn\">\n                    실습 열기\n                  </Link>\n                ) : null}\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => {\n                    void deleteBookmark(bookmark.id);\n                  }}\n                >\n                  삭제\n                </button>\n              </div>\n              <textarea\n                className=\"bookmark-note\"\n                value={notesByBookmarkId[bookmark.id] ?? ''}\n                onChange={(event) => {\n                  void saveBookmarkNote(bookmark.id, event.target.value);\n                }}\n                placeholder=\"개인 노트\"\n                aria-label={",
  ").map((achievement) => ({\n      ...achievement,\n      unlocked: unlockedSet.has(achievement.id),\n    }));\n  }, [unlockedFunAchievements]);\n\n  const milestoneLinks = useMemo(() => {\n    const date = new Date().toISOString().slice(0, 10);\n\n    return milestoneProgress.unlockedMilestones.map((milestoneSlug) => {\n      const meta = getMilestoneMeta(milestoneSlug);\n      return {\n        milestoneSlug,\n        title: meta?.title ?? milestoneSlug,\n        href: buildSharePath(milestoneSlug, {\n          level,\n          xp,\n          date,\n          badge: meta?.badge ?? milestoneSlug,\n        }),\n      };\n    });\n  }, [level, milestoneProgress.unlockedMilestones, xp]);\n\n  const simulateMissionPass = (mission: AppMission) => {\n    const gainedXp = recordMissionPass({\n      missionSlug: mission.slug,\n      difficulty: mission.difficulty,\n      hintLevel: 0,\n      attemptNumber: 1,\n      completedTrackSlugs,\n    });\n\n    window.alert(`샘플 완료 처리: +${gainedXp} XP`);\n  };\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Progress\"\n      title=\"학습 진행도\"\n      description=\"XP, 레벨, 스트릭, 트랙별 완료 현황을 확인합니다.\"\n    >\n      {!content ? (\n        <EmptyState title=\"진행 데이터를 로드할 수 없습니다\" description=\"콘텐츠 로드를 다시 확인해 주세요.\" />\n      ) : (\n        <div className=\"sim-panel\">\n          <div className=\"sim-summary\">\n            <p>\n              <strong>XP:</strong> {xp}\n            </p>\n            <p>\n              <strong>레벨:</strong> {level}\n            </p>\n            <p>\n              <strong>연속 학습:</strong> {streakDays}일\n            </p>\n            <p>\n              <strong>완료 미션:</strong> {completedMissionSlugs.length}\n            </p>\n            <p>\n              <strong>pane 분할 누적:</strong> {tmuxSkillStats.splitCount}\n            </p>\n          </div>\n\n          <section className=\"playbook-section\">\n            <h2>세션 히스토리</h2>\n            <div className=\"progress-session-grid\">\n              <article>\n                <h3>진행 중 세션</h3>\n                {inProgressSessions.length === 0 ? (\n                  <p className=\"muted\">진행 중인 세션이 없습니다.</p>\n                ) : (\n                  <ul className=\"link-list\">\n                    {inProgressSessions.map((session) => {\n                      const mission = missionBySlug.get(session.missionSlug);\n                      const lessonSlug = session.lessonSlug ?? mission?.lessonSlug ??": ").map((achievement) => ({\n      ...achievement,\n      unlocked: unlockedSet.has(achievement.id),\n    }));\n  }, [unlockedFunAchievements]);\n\n  const milestoneLinks = useMemo(() => {\n    const date = new Date().toISOString().slice(0, 10);\n\n    return milestoneProgress.unlockedMilestones.map((milestoneSlug) => {\n      const meta = getMilestoneMeta(milestoneSlug);\n      return {\n        milestoneSlug,\n        title: meta?.title ?? milestoneSlug,\n        href: buildSharePath(milestoneSlug, {\n          level,\n          xp,\n          date,\n          badge: meta?.badge ?? milestoneSlug,\n        }),\n      };\n    });\n  }, [level, milestoneProgress.unlockedMilestones, xp]);\n\n  const simulateMissionPass = (mission: AppMission) => {\n    const gainedXp = recordMissionPass({\n      missionSlug: mission.slug,\n      difficulty: mission.difficulty,\n      hintLevel: 0,\n      attemptNumber: 1,\n      completedTrackSlugs,\n    });\n\n    window.alert(`샘플 완료 처리: +${gainedXp} XP`);\n  };\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Progress\"\n      title=\"학습 진행도\"\n      description=\"XP, 레벨, 스트릭, 트랙별 완료 현황을 확인합니다.\"\n    >\n      {!content ? (\n        <EmptyState title=\"진행 데이터를 로드할 수 없습니다\" description=\"콘텐츠 로드를 다시 확인해 주세요.\" />\n      ) : (\n        <div className=\"sim-panel\">\n          <div className=\"sim-summary\">\n            <p>\n              <strong>XP:</strong> {xp}\n            </p>\n            <p>\n              <strong>레벨:</strong> {level}\n            </p>\n            <p>\n              <strong>연속 학습:</strong> {streakDays}일\n            </p>\n            <p>\n              <strong>완료 미션:</strong> {completedMissionSlugs.length}\n            </p>\n            <p>\n              <strong>pane 분할 누적:</strong> {tmuxSkillStats.splitCount}\n            </p>\n          </div>\n\n          <section className=\"playbook-section\">\n            <h2>세션 히스토리</h2>\n            <div className=\"progress-session-grid\">\n              <article>\n                <h3>진행 중 세션</h3>\n                {inProgressSessions.length === 0 ? (\n                  <p className=\"muted\">진행 중인 세션이 없습니다.</p>\n                ) : (\n                  <ul className=\"link-list\">\n                    {inProgressSessions.map((session) => {\n                      const mission = missionBySlug.get(session.missionSlug);\n                      const lessonSlug = session.lessonSlug ?? mission?.lessonSlug ??",
  ")) && !decodedPayload;\n\n  if (!achievement) {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Share\"\n        title=\"알 수 없는 업적 공유 링크\"\n        description=\"지원하지 않는 업적 공유 경로입니다.\"\n      >\n        <div className=\"inline-actions\">\n          <Link to=\"/progress\" className=\"primary-btn\">\n            Progress로 이동\n          </Link>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  return (\n    <PagePlaceholder eyebrow=\"Share\" title={achievement.title} description={achievement.description}>\n      <div className=\"share-preview-card\">\n        <p className=\"page-eyebrow\">Achievement Challenge</p>\n        <h2>{achievement.title}</h2>\n        <p>{achievement.description}</p>\n        <ul className=\"link-list\">\n          <li>닉네임: {effectivePayload.name}</li>\n          <li>레벨: {effectivePayload.level}</li>\n          <li>XP: {effectivePayload.xp}</li>\n          <li>연속 학습일: {streakDays}</li>\n          <li>달성일: {effectivePayload.date}</li>\n          <li>추천 챌린지: {challengeTarget?.challengeLabel ??": ")) && !decodedPayload;\n\n  if (!achievement) {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Share\"\n        title=\"알 수 없는 업적 공유 링크\"\n        description=\"지원하지 않는 업적 공유 경로입니다.\"\n      >\n        <div className=\"inline-actions\">\n          <Link to=\"/progress\" className=\"primary-btn\">\n            Progress로 이동\n          </Link>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  return (\n    <PagePlaceholder eyebrow=\"Share\" title={achievement.title} description={achievement.description}>\n      <div className=\"share-preview-card\">\n        <p className=\"page-eyebrow\">Achievement Challenge</p>\n        <h2>{achievement.title}</h2>\n        <p>{achievement.description}</p>\n        <ul className=\"link-list\">\n          <li>닉네임: {effectivePayload.name}</li>\n          <li>레벨: {effectivePayload.level}</li>\n          <li>XP: {effectivePayload.xp}</li>\n          <li>연속 학습일: {streakDays}</li>\n          <li>달성일: {effectivePayload.date}</li>\n          <li>추천 챌린지: {challengeTarget?.challengeLabel ??",
  ")) && !decodedPayload;\n\n  if (!milestone) {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Share\"\n        title=\"알 수 없는 마일스톤\"\n        description=\"지원하지 않는 공유 경로입니다. Progress 페이지에서 다시 생성해 주세요.\"\n      >\n        <div className=\"inline-actions\">\n          <Link to=\"/progress\" className=\"primary-btn\">\n            Progress로 이동\n          </Link>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Share\"\n      title={milestone.title}\n      description={milestone.description}\n    >\n      <div className=\"share-preview-card\">\n        <p className=\"page-eyebrow\">Preview</p>\n        <h2>{milestone.title}</h2>\n        <p>{milestone.description}</p>\n        <ul className=\"link-list\">\n          <li>닉네임: {effectivePayload.name}</li>\n          <li>레벨: {effectivePayload.level}</li>\n          <li>XP: {effectivePayload.xp}</li>\n          <li>연속 학습일: {streakDays}</li>\n          <li>달성일: {effectivePayload.date}</li>\n        </ul>\n      </div>\n\n      <section className=\"onboarding-card\">\n        <h2>공유 설정</h2>\n        <p className=\"muted\">닉네임은 선택값이며 개인 식별 정보 입력은 권장하지 않습니다.</p>\n        <div className=\"inline-actions\">\n          <input\n            className=\"sim-input\"\n            value={alias}\n            onChange={(event) => setAlias(event.target.value)}\n            placeholder=\"닉네임 (선택)\"\n            aria-label=\"Share nickname\"\n          />\n          <button\n            type=\"button\"\n            className=\"secondary-btn\"\n            onClick={() => {\n              copyTextToClipboard(shareUrl)\n                .then(() => setCopyStatus(": ")) && !decodedPayload;\n\n  if (!milestone) {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Share\"\n        title=\"알 수 없는 마일스톤\"\n        description=\"지원하지 않는 공유 경로입니다. Progress 페이지에서 다시 생성해 주세요.\"\n      >\n        <div className=\"inline-actions\">\n          <Link to=\"/progress\" className=\"primary-btn\">\n            Progress로 이동\n          </Link>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Share\"\n      title={milestone.title}\n      description={milestone.description}\n    >\n      <div className=\"share-preview-card\">\n        <p className=\"page-eyebrow\">Preview</p>\n        <h2>{milestone.title}</h2>\n        <p>{milestone.description}</p>\n        <ul className=\"link-list\">\n          <li>닉네임: {effectivePayload.name}</li>\n          <li>레벨: {effectivePayload.level}</li>\n          <li>XP: {effectivePayload.xp}</li>\n          <li>연속 학습일: {streakDays}</li>\n          <li>달성일: {effectivePayload.date}</li>\n        </ul>\n      </div>\n\n      <section className=\"onboarding-card\">\n        <h2>공유 설정</h2>\n        <p className=\"muted\">닉네임은 선택값이며 개인 식별 정보 입력은 권장하지 않습니다.</p>\n        <div className=\"inline-actions\">\n          <input\n            className=\"sim-input\"\n            value={alias}\n            onChange={(event) => setAlias(event.target.value)}\n            placeholder=\"닉네임 (선택)\"\n            aria-label=\"Share nickname\"\n          />\n          <button\n            type=\"button\"\n            className=\"secondary-btn\"\n            onClick={() => {\n              copyTextToClipboard(shareUrl)\n                .then(() => setCopyStatus(",
  ")}\n                        </li>\n                      ))}\n                    </ul>\n                  ) : (\n                    <p className=\"muted\">힌트가 없습니다.</p>\n                  )}\n                  {restHints.length > 0 ? (\n                    <details className=\"lesson-mission-more\">\n                      <summary>힌트 {restHints.length}개 더 보기</summary>\n                      <ul className=\"link-list lesson-mission-hints\">\n                        {restHints.map((hint, index) => (\n                          <li key={": ")}\n                        </li>\n                      ))}\n                    </ul>\n                  ) : (\n                    <p className=\"muted\">힌트가 없습니다.</p>\n                  )}\n                  {restHints.length > 0 ? (\n                    <details className=\"lesson-mission-more\">\n                      <summary>힌트 {restHints.length}개 더 보기</summary>\n                      <ul className=\"link-list lesson-mission-hints\">\n                        {restHints.map((hint, index) => (\n                          <li key={",
  ")}\n              />\n              <span>\n                <strong>Ctrl+a</strong>\n                <small>GNU screen 호환 선호 시</small>\n              </span>\n            </label>\n          </div>\n        </section>\n\n        <section className=\"onboarding-card\">\n          <h2>키보드 레이아웃</h2>\n          <div className=\"onboarding-control-group\">\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"keyboardLayout\"\n                value=\"mac\"\n                checked={keyboardLayout ===": ")}\n              />\n              <span>\n                <strong>Ctrl+a</strong>\n                <small>GNU screen 호환 선호 시</small>\n              </span>\n            </label>\n          </div>\n        </section>\n\n        <section className=\"onboarding-card\">\n          <h2>키보드 레이아웃</h2>\n          <div className=\"onboarding-control-group\">\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"keyboardLayout\"\n                value=\"mac\"\n                checked={keyboardLayout ===",
  ")}\n              />\n              <span>\n                <strong>Ctrl+b (권장)</strong>\n                <small>tmux 기본값</small>\n              </span>\n            </label>\n\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"prefixKey\"\n                value=\"C-a\"\n                checked={prefixKey ===": ")}\n              />\n              <span>\n                <strong>Ctrl+b (권장)</strong>\n                <small>tmux 기본값</small>\n              </span>\n            </label>\n\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"prefixKey\"\n                value=\"C-a\"\n                checked={prefixKey ===",
  ")}\n              />\n              <span>\n                <strong>Mac</strong>\n                <small>Option/Command 키 표기 기준</small>\n              </span>\n            </label>\n\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"keyboardLayout\"\n                value=\"windows\"\n                checked={keyboardLayout ===": ")}\n              />\n              <span>\n                <strong>Mac</strong>\n                <small>Option/Command 키 표기 기준</small>\n              </span>\n            </label>\n\n            <label className=\"onboarding-radio\">\n              <input\n                type=\"radio\"\n                name=\"keyboardLayout\"\n                value=\"windows\"\n                checked={keyboardLayout ===",
  ")}\n              />\n              <span>\n                <strong>Windows/Linux</strong>\n                <small>Ctrl/Alt 표기 기준</small>\n              </span>\n            </label>\n          </div>\n        </section>\n      </div>\n\n      <div className=\"inline-actions\">\n        <button\n          type=\"button\"\n          className=\"primary-btn\"\n          onClick={() => {\n            setPreferences({ prefixKey, keyboardLayout });\n            setSimulatorPrefix(prefixKey);\n            navigate(": ")}\n              />\n              <span>\n                <strong>Windows/Linux</strong>\n                <small>Ctrl/Alt 표기 기준</small>\n              </span>\n            </label>\n          </div>\n        </section>\n      </div>\n\n      <div className=\"inline-actions\">\n        <button\n          type=\"button\"\n          className=\"primary-btn\"\n          onClick={() => {\n            setPreferences({ prefixKey, keyboardLayout });\n            setSimulatorPrefix(prefixKey);\n            navigate(",
  ")}\n            </li>\n          ))}\n        </ul>\n\n        {lesson.successCriteria && lesson.successCriteria.length > 0 ? (\n          <details className=\"lesson-detail-group\">\n            <summary>완료 기준 {lesson.successCriteria.length}개</summary>\n            <ul className=\"link-list\">\n              {lesson.successCriteria.map((item, index) => (\n                <li key={": ")}\n            </li>\n          ))}\n        </ul>\n\n        {lesson.successCriteria && lesson.successCriteria.length > 0 ? (\n          <details className=\"lesson-detail-group\">\n            <summary>완료 기준 {lesson.successCriteria.length}개</summary>\n            <ul className=\"link-list\">\n              {lesson.successCriteria.map((item, index) => (\n                <li key={",
  ")}\n            </p>\n          ) : null}\n          {lesson.goal ? (\n            <p>\n              <strong>이 레슨의 목표:</strong> {renderTextWithShortcutTooltip(lesson.goal,": ")}\n            </p>\n          ) : null}\n          {lesson.goal ? (\n            <p>\n              <strong>이 레슨의 목표:</strong> {renderTextWithShortcutTooltip(lesson.goal,",
  ")}\n        >\n          바로 커리큘럼 보기\n        </button>\n      </div>\n\n      <p className=\"muted\">\n        시작 상태: {startedAt ?": ")}\n        >\n          바로 커리큘럼 보기\n        </button>\n      </div>\n\n      <p className=\"muted\">\n        시작 상태: {startedAt ?",
  ")}</li>\n                      ))}\n                    </ul>\n                  </details>\n                ) : null}\n                {selectedMissionStatus ? (\n                  <div className=\"vm-mission-status\">\n                    <p>\n                      <strong>판정:</strong> {selectedMissionStatus.status} · {selectedMissionStatus.reason}\n                    </p>\n                    {selectedMissionStatus.status === 'manual' ? (\n                      <button type=\"button\" className=\"secondary-btn\" onClick={handleManualMissionComplete}>\n                        수동 완료 처리\n                      </button>\n                    ) : null}\n                  </div>\n                ) : null}\n              </article>\n            ) : null}\n\n            <section className=\"vm-next-action-card\">\n              <p className=\"vm-next-action-eyebrow\">Next Action</p>\n              <h2>지금 할 일</h2>\n              {!selectedMission ? (\n                <p className=\"muted\">미션을 선택하면 바로 실행할 다음 행동을 안내합니다.</p>\n              ) : null}\n              {selectedMission && selectedMissionStatus?.status === 'complete' && !selectedMissionCompleted ? (\n                <p className=\"muted\">완료 판정 반영 중입니다. 잠시 후 자동으로 완료 처리됩니다.</p>\n              ) : null}\n              {selectedMission && selectedMissionCompleted && nextIncompleteMission ? (\n                <>\n                  <p>\n                    <strong>{selectedMission.title}</strong> 완료됨. 다음 미션으로 이동해 이어서 진행하세요.\n                  </p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-next-action-btn\"\n                    onClick={() => selectMissionForAction(nextIncompleteMission.slug)}\n                  >\n                    다음 미션으로 이동\n                  </button>\n                  <p className=\"muted\">다음: {nextIncompleteMission.title}</p>\n                </>\n              ) : null}\n              {selectedMission && selectedMissionCompleted && !nextIncompleteMission && lessonCompleted && nextLesson ? (\n                <>\n                  <p>\n                    <strong>현재 레슨 완료.</strong> 다음 레슨으로 넘어가 학습 흐름을 이어가세요.\n                  </p>\n                  <button type=\"button\" className=\"primary-btn vm-next-action-btn\" onClick={selectNextLessonForAction}>\n                    다음 레슨 시작\n                  </button>\n                  <p className=\"muted\">다음: {nextLesson.title}</p>\n                </>\n              ) : null}\n              {selectedMission && selectedMissionCompleted && !nextIncompleteMission && lessonCompleted && !nextLesson ? (\n                <>\n                  <p>\n                    <strong>전체 레슨을 완료했습니다.</strong> 진행 현황에서 업적과 누적 XP를 확인하세요.\n                  </p>\n                  <Link className=\"primary-btn vm-next-action-btn\" to=\"/progress\">\n                    진행 현황 보기\n                  </Link>\n                </>\n              ) : null}\n              {selectedMission && !selectedMissionCompleted && selectedMissionStatus?.status === 'manual' ? (\n                <>\n                  <p>\n                    <strong>{selectedMission.title}</strong>는 자동 판정이 어려워 수동 완료가 필요합니다.\n                  </p>\n                  <button type=\"button\" className=\"primary-btn vm-next-action-btn\" onClick={handleManualMissionComplete}>\n                    수동 완료 처리\n                  </button>\n                </>\n              ) : null}\n              {selectedMission &&\n              !selectedMissionCompleted &&\n              selectedMissionStatus?.status !== 'manual' &&\n              selectedMissionStatus?.status !== 'complete' ? (\n                <>\n                  <p>\n                    <strong>{selectedMission.title}</strong> 미션 수행 중입니다. 터미널에서 힌트를 실행하고 완료 판정을 받으세요.\n                  </p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-next-action-btn\"\n                    onClick={() => setMobileWorkbenchView('terminal')}\n                  >\n                    터미널로 이동\n                  </button>\n                </>\n              ) : null}\n              {selectedMissionStatus ? (\n                <p className=\"vm-next-action-meta\">\n                  현재 판정: {selectedMissionStatus.status} · {selectedMissionStatus.reason}\n                </p>\n              ) : null}\n            </section>\n\n            <section className=\"vm-mission-list-card\">\n              <h2>미션 목록</h2>\n              <div className=\"vm-mission-list\">\n                {lessonMissions.map((mission, index) => {\n                  const missionStatus = missionStatusMap.get(mission.slug);\n                  const isSelected = mission.slug === selectedMissionSlug;\n                  const isCompleted = completedMissionSlugs.includes(mission.slug);\n\n                  let badgeClass = 'is-pending';\n                  let badgeLabel = '대기';\n\n                  if (isCompleted) {\n                    badgeClass = 'is-complete';\n                    badgeLabel = '완료';\n                  } else if (missionStatus?.status === 'complete') {\n                    badgeClass = 'is-live-complete';\n                    badgeLabel = '실시간 통과';\n                  } else if (missionStatus?.status === 'manual') {\n                    badgeClass = 'is-manual';\n                    badgeLabel = '수동';\n                  }\n\n                  return (\n                    <button\n                      key={mission.id}\n                      type=\"button\"\n                      className={": ")}</li>\n                      ))}\n                    </ul>\n                  </details>\n                ) : null}\n                {selectedMissionStatus ? (\n                  <div className=\"vm-mission-status\">\n                    <p>\n                      <strong>판정:</strong> {selectedMissionStatus.status} · {selectedMissionStatus.reason}\n                    </p>\n                    {selectedMissionStatus.status === 'manual' ? (\n                      <button type=\"button\" className=\"secondary-btn\" onClick={handleManualMissionComplete}>\n                        수동 완료 처리\n                      </button>\n                    ) : null}\n                  </div>\n                ) : null}\n              </article>\n            ) : null}\n\n            <section className=\"vm-next-action-card\">\n              <p className=\"vm-next-action-eyebrow\">Next Action</p>\n              <h2>지금 할 일</h2>\n              {!selectedMission ? (\n                <p className=\"muted\">미션을 선택하면 바로 실행할 다음 행동을 안내합니다.</p>\n              ) : null}\n              {selectedMission && selectedMissionStatus?.status === 'complete' && !selectedMissionCompleted ? (\n                <p className=\"muted\">완료 판정 반영 중입니다. 잠시 후 자동으로 완료 처리됩니다.</p>\n              ) : null}\n              {selectedMission && selectedMissionCompleted && nextIncompleteMission ? (\n                <>\n                  <p>\n                    <strong>{selectedMission.title}</strong> 완료됨. 다음 미션으로 이동해 이어서 진행하세요.\n                  </p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-next-action-btn\"\n                    onClick={() => selectMissionForAction(nextIncompleteMission.slug)}\n                  >\n                    다음 미션으로 이동\n                  </button>\n                  <p className=\"muted\">다음: {nextIncompleteMission.title}</p>\n                </>\n              ) : null}\n              {selectedMission && selectedMissionCompleted && !nextIncompleteMission && lessonCompleted && nextLesson ? (\n                <>\n                  <p>\n                    <strong>현재 레슨 완료.</strong> 다음 레슨으로 넘어가 학습 흐름을 이어가세요.\n                  </p>\n                  <button type=\"button\" className=\"primary-btn vm-next-action-btn\" onClick={selectNextLessonForAction}>\n                    다음 레슨 시작\n                  </button>\n                  <p className=\"muted\">다음: {nextLesson.title}</p>\n                </>\n              ) : null}\n              {selectedMission && selectedMissionCompleted && !nextIncompleteMission && lessonCompleted && !nextLesson ? (\n                <>\n                  <p>\n                    <strong>전체 레슨을 완료했습니다.</strong> 진행 현황에서 업적과 누적 XP를 확인하세요.\n                  </p>\n                  <Link className=\"primary-btn vm-next-action-btn\" to=\"/progress\">\n                    진행 현황 보기\n                  </Link>\n                </>\n              ) : null}\n              {selectedMission && !selectedMissionCompleted && selectedMissionStatus?.status === 'manual' ? (\n                <>\n                  <p>\n                    <strong>{selectedMission.title}</strong>는 자동 판정이 어려워 수동 완료가 필요합니다.\n                  </p>\n                  <button type=\"button\" className=\"primary-btn vm-next-action-btn\" onClick={handleManualMissionComplete}>\n                    수동 완료 처리\n                  </button>\n                </>\n              ) : null}\n              {selectedMission &&\n              !selectedMissionCompleted &&\n              selectedMissionStatus?.status !== 'manual' &&\n              selectedMissionStatus?.status !== 'complete' ? (\n                <>\n                  <p>\n                    <strong>{selectedMission.title}</strong> 미션 수행 중입니다. 터미널에서 힌트를 실행하고 완료 판정을 받으세요.\n                  </p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-next-action-btn\"\n                    onClick={() => setMobileWorkbenchView('terminal')}\n                  >\n                    터미널로 이동\n                  </button>\n                </>\n              ) : null}\n              {selectedMissionStatus ? (\n                <p className=\"vm-next-action-meta\">\n                  현재 판정: {selectedMissionStatus.status} · {selectedMissionStatus.reason}\n                </p>\n              ) : null}\n            </section>\n\n            <section className=\"vm-mission-list-card\">\n              <h2>미션 목록</h2>\n              <div className=\"vm-mission-list\">\n                {lessonMissions.map((mission, index) => {\n                  const missionStatus = missionStatusMap.get(mission.slug);\n                  const isSelected = mission.slug === selectedMissionSlug;\n                  const isCompleted = completedMissionSlugs.includes(mission.slug);\n\n                  let badgeClass = 'is-pending';\n                  let badgeLabel = '대기';\n\n                  if (isCompleted) {\n                    badgeClass = 'is-complete';\n                    badgeLabel = '완료';\n                  } else if (missionStatus?.status === 'complete') {\n                    badgeClass = 'is-live-complete';\n                    badgeLabel = '실시간 통과';\n                  } else if (missionStatus?.status === 'manual') {\n                    badgeClass = 'is-manual';\n                    badgeLabel = '수동';\n                  }\n\n                  return (\n                    <button\n                      key={mission.id}\n                      type=\"button\"\n                      className={",
  ")}</li>\n                  ))}\n                </ul>\n                {hiddenMissionHintCount > 0 ? (\n                  <details className=\"vm-mission-hints-more\">\n                    <summary>힌트 {hiddenMissionHintCount}개 더 보기</summary>\n                    <ul className=\"link-list\">\n                      {selectedMission.hints.slice(missionHintPreview.length).map((hint, index) => (\n                        <li key={hint}>{renderHintTextWithTooltips(hint,": ")}</li>\n                  ))}\n                </ul>\n                {hiddenMissionHintCount > 0 ? (\n                  <details className=\"vm-mission-hints-more\">\n                    <summary>힌트 {hiddenMissionHintCount}개 더 보기</summary>\n                    <ul className=\"link-list\">\n                      {selectedMission.hints.slice(missionHintPreview.length).map((hint, index) => (\n                        <li key={hint}>{renderHintTextWithTooltips(hint,",
  ")}</li>\n              ))}\n            </ul>\n          </details>\n        ) : null}\n\n        {lessonTerms.length > 0 ? (\n          <>\n            <h3>용어 빠른 설명</h3>\n            <ul className=\"link-list\">\n              {lessonTerms.map((term) => (\n                <li key={term.id}>\n                  <strong>{term.title}:</strong> {term.description}\n                </li>\n              ))}\n            </ul>\n          </>\n        ) : null}\n\n        <h3>미션 실행 순서 ({missions.length})</h3>\n        {missions.length === 0 ? (\n          <p className=\"muted\">등록된 미션이 없습니다.</p>\n        ) : (\n          <div className=\"lesson-mission-grid\">\n            {missions.map((mission) => {\n              const previewHints = mission.hints.slice(0, 2);\n              const restHints = mission.hints.slice(2);\n\n              return (\n                <article key={mission.id} className=\"lesson-mission-card\">\n                  <h4>{mission.title}</h4>\n                  <p className=\"lesson-mission-meta\">\n                    난이도 {mission.difficulty} · 초기 시나리오 {mission.initialScenario}\n                  </p>\n                  {previewHints.length > 0 ? (\n                    <ul className=\"link-list lesson-mission-hints\">\n                      {previewHints.map((hint, index) => (\n                        <li key={": ")}</li>\n              ))}\n            </ul>\n          </details>\n        ) : null}\n\n        {lessonTerms.length > 0 ? (\n          <>\n            <h3>용어 빠른 설명</h3>\n            <ul className=\"link-list\">\n              {lessonTerms.map((term) => (\n                <li key={term.id}>\n                  <strong>{term.title}:</strong> {term.description}\n                </li>\n              ))}\n            </ul>\n          </>\n        ) : null}\n\n        <h3>미션 실행 순서 ({missions.length})</h3>\n        {missions.length === 0 ? (\n          <p className=\"muted\">등록된 미션이 없습니다.</p>\n        ) : (\n          <div className=\"lesson-mission-grid\">\n            {missions.map((mission) => {\n              const previewHints = mission.hints.slice(0, 2);\n              const restHints = mission.hints.slice(2);\n\n              return (\n                <article key={mission.id} className=\"lesson-mission-card\">\n                  <h4>{mission.title}</h4>\n                  <p className=\"lesson-mission-meta\">\n                    난이도 {mission.difficulty} · 초기 시나리오 {mission.initialScenario}\n                  </p>\n                  {previewHints.length > 0 ? (\n                    <ul className=\"link-list lesson-mission-hints\">\n                      {previewHints.map((hint, index) => (\n                        <li key={",
  ")}</li>\n              ))}\n            </ul>\n          </details>\n        ) : null}\n        {lesson.failureStates && lesson.failureStates.length > 0 ? (\n          <details className=\"lesson-detail-group\">\n            <summary>부족 상태 {lesson.failureStates.length}개</summary>\n            <ul className=\"link-list\">\n              {lesson.failureStates.map((item, index) => (\n                <li key={": ")}</li>\n              ))}\n            </ul>\n          </details>\n        ) : null}\n        {lesson.failureStates && lesson.failureStates.length > 0 ? (\n          <details className=\"lesson-detail-group\">\n            <summary>부족 상태 {lesson.failureStates.length}개</summary>\n            <ul className=\"link-list\">\n              {lesson.failureStates.map((item, index) => (\n                <li key={",
  ")}>\n              Prefix + \" (가로 분할)\n            </button>\n            <button type=\"button\" className=\"secondary-btn\" onClick={() => sendPrefixKey(": ")}>\n              Prefix + \" (가로 분할)\n            </button>\n            <button type=\"button\" className=\"secondary-btn\" onClick={() => sendPrefixKey(",
  ")}>\n              Prefix + h (패인 이동)\n            </button>\n            <button\n              type=\"button\"\n              className=\"secondary-btn\"\n              onClick={() => {\n                if (mission) {\n                  initMissionScenario(mission);\n                } else {\n                  resetSimulator();\n                }\n                setSimulatorPrefix(prefixKey);\n                setFeedback(null);\n                setHintText(null);\n                setAttemptCount(0);\n                setMaxHintLevelUsed(0);\n              }}\n            >\n              미션 상태 초기화\n            </button>\n          </div>\n\n          <section className=\"onboarding-card\">\n            <h2>현재 패인</h2>\n            <ul className=\"link-list\">\n              {activeWindow.panes.map((pane) => (\n                <li key={pane.id}>\n                  {pane.id === activeWindow.activePaneId ?": ")}>\n              Prefix + h (패인 이동)\n            </button>\n            <button\n              type=\"button\"\n              className=\"secondary-btn\"\n              onClick={() => {\n                if (mission) {\n                  initMissionScenario(mission);\n                } else {\n                  resetSimulator();\n                }\n                setSimulatorPrefix(prefixKey);\n                setFeedback(null);\n                setHintText(null);\n                setAttemptCount(0);\n                setMaxHintLevelUsed(0);\n              }}\n            >\n              미션 상태 초기화\n            </button>\n          </div>\n\n          <section className=\"onboarding-card\">\n            <h2>현재 패인</h2>\n            <ul className=\"link-list\">\n              {activeWindow.panes.map((pane) => (\n                <li key={pane.id}>\n                  {pane.id === activeWindow.activePaneId ?",
  "}\n                  {selectedLessonChapter?.title ?? selectedLesson.chapterSlug}\n                </p>\n                <h2>{selectedLesson.title}</h2>\n                <p className=\"muted\">\n                  예상 {selectedLesson.estimatedMinutes}분 · 목표 {selectedLesson.objectives.length}개\n                </p>\n                {selectedLesson.goal ? (\n                  <p>\n                    <strong>레슨 목표:</strong> {selectedLesson.goal}\n                  </p>\n                ) : null}\n                {lessonSuccessCriteriaPreview.length > 0 ? (\n                  <p className=\"muted\">\n                    <strong>완료 기준:</strong> {lessonSuccessCriteriaPreview[0]}\n                    {hiddenSuccessCriteriaCount > 0 ? ` (+${hiddenSuccessCriteriaCount}개)` :": "}\n                  {selectedLessonChapter?.title ?? selectedLesson.chapterSlug}\n                </p>\n                <h2>{selectedLesson.title}</h2>\n                <p className=\"muted\">\n                  예상 {selectedLesson.estimatedMinutes}분 · 목표 {selectedLesson.objectives.length}개\n                </p>\n                {selectedLesson.goal ? (\n                  <p>\n                    <strong>레슨 목표:</strong> {selectedLesson.goal}\n                  </p>\n                ) : null}\n                {lessonSuccessCriteriaPreview.length > 0 ? (\n                  <p className=\"muted\">\n                    <strong>완료 기준:</strong> {lessonSuccessCriteriaPreview[0]}\n                    {hiddenSuccessCriteriaCount > 0 ? ` (+${hiddenSuccessCriteriaCount}개)` :",
  "}\n                  </p>\n                ) : null}\n                {lessonFailureStatePreview.length > 0 ? (\n                  <p className=\"muted\">\n                    <strong>부족 상태:</strong> {lessonFailureStatePreview[0]}\n                    {hiddenFailureStateCount > 0 ? ` (+${hiddenFailureStateCount}개)` :": "}\n                  </p>\n                ) : null}\n                {lessonFailureStatePreview.length > 0 ? (\n                  <p className=\"muted\">\n                    <strong>부족 상태:</strong> {lessonFailureStatePreview[0]}\n                    {hiddenFailureStateCount > 0 ? ` (+${hiddenFailureStateCount}개)` :",
  "}\n                  </p>\n                ) : null}\n                <ul className=\"link-list\">\n                  {lessonObjectivePreview.map((objective) => (\n                    <li key={objective}>{objective}</li>\n                  ))}\n                  {hiddenObjectiveCount > 0 ? <li className=\"muted\">+ {hiddenObjectiveCount}개 목표 더 있음</li> : null}\n                </ul>\n                <div className=\"inline-actions\">\n                  <Link\n                    className=\"secondary-btn\"\n                    to={`/learn/${selectedLesson.trackSlug}/${selectedLesson.chapterSlug}/${selectedLesson.slug}`}\n                  >\n                    레슨 상세 보기\n                  </Link>\n                </div>\n              </section>\n            ) : null}\n\n            <section className=\"vm-curriculum-panel vm-curriculum-row-layout\">\n              <div className=\"inline-actions\">\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => selectLessonForAction(LEARNING_PATH_ENTRY_LESSON, { resetFilter: true })}\n                >\n                  통합 학습 경로 처음으로\n                </button>\n              </div>\n              <div className=\"vm-lesson-filter\" role=\"tablist\" aria-label=\"레슨 필터\">\n                {LESSON_FILTER_OPTIONS.map((option) => (\n                  <button\n                    key={option.value}\n                    type=\"button\"\n                    className={`secondary-btn vm-lesson-filter-btn ${lessonFilter === option.value ?": "}\n                  </p>\n                ) : null}\n                <ul className=\"link-list\">\n                  {lessonObjectivePreview.map((objective) => (\n                    <li key={objective}>{objective}</li>\n                  ))}\n                  {hiddenObjectiveCount > 0 ? <li className=\"muted\">+ {hiddenObjectiveCount}개 목표 더 있음</li> : null}\n                </ul>\n                <div className=\"inline-actions\">\n                  <Link\n                    className=\"secondary-btn\"\n                    to={`/learn/${selectedLesson.trackSlug}/${selectedLesson.chapterSlug}/${selectedLesson.slug}`}\n                  >\n                    레슨 상세 보기\n                  </Link>\n                </div>\n              </section>\n            ) : null}\n\n            <section className=\"vm-curriculum-panel vm-curriculum-row-layout\">\n              <div className=\"inline-actions\">\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => selectLessonForAction(LEARNING_PATH_ENTRY_LESSON, { resetFilter: true })}\n                >\n                  통합 학습 경로 처음으로\n                </button>\n              </div>\n              <div className=\"vm-lesson-filter\" role=\"tablist\" aria-label=\"레슨 필터\">\n                {LESSON_FILTER_OPTIONS.map((option) => (\n                  <button\n                    key={option.value}\n                    type=\"button\"\n                    className={`secondary-btn vm-lesson-filter-btn ${lessonFilter === option.value ?",
  "}\n                  >\n                    <strong>{lesson.title}</strong>\n                    <span>{lesson.estimatedMinutes}분 · 미션 {pageData.missionCounts[lesson.slug] ?? 0}개</span>\n                  </Link>\n                  <Link className=\"secondary-btn\" to={": "}\n                  >\n                    <strong>{lesson.title}</strong>\n                    <span>{lesson.estimatedMinutes}분 · 미션 {pageData.missionCounts[lesson.slug] ?? 0}개</span>\n                  </Link>\n                  <Link className=\"secondary-btn\" to={",
  "}\n                >\n                  <h3>{achievement.title}</h3>\n                  <p>{achievement.description}</p>\n                  <p className=\"muted\">{achievement.unlocked ? '달성됨' : '미달성'}</p>\n                  {achievement.unlocked ? (\n                    <a\n                      className=\"text-link\"\n                      href={buildTwitterIntentUrl(\n                        buildAbsoluteAchievementShareUrl(achievement.id, {\n                          level,\n                          xp,\n                          date: shareDate,\n                          badge: achievement.id,\n                        }),\n                        buildAchievementChallengeShareText(achievement.shareText, achievement.id),\n                      )}\n                      target=\"_blank\"\n                      rel=\"noreferrer\"\n                    >\n                      X 챌린지 공유\n                    </a>\n                  ) : null}\n                </article>\n              ))}\n            </div>\n          </section>\n\n          <section className=\"playbook-section\">\n            <h2>Fun 업적</h2>\n            <p className=\"muted\">\n              {unlockedFunAchievements.length}/{funAchievementRows.length} 달성\n            </p>\n            <ul className=\"link-list\">\n              <li>pane 분할 누적: {tmuxSkillStats.splitCount}</li>\n              <li>최대 pane 수: {tmuxSkillStats.maxPaneCount}</li>\n              <li>window 생성: {tmuxSkillStats.newWindowCount}</li>\n              <li>session 생성: {tmuxSkillStats.newSessionCount}</li>\n              <li>copy-mode 진입: {tmuxSkillStats.copyModeCount}</li>\n              <li>pane resize 누적: {tmuxSkillStats.paneResizeCount}</li>\n              <li>pane 이동/선택 누적: {tmuxSkillStats.paneSelectCount}</li>\n              <li>layout 변경 누적: {tmuxSkillStats.layoutSelectCount}</li>\n              <li>zoom 토글 누적: {tmuxSkillStats.zoomToggleCount}</li>\n              <li>sync 토글 누적: {tmuxSkillStats.syncToggleCount}</li>\n              <li>command-prompt 실행: {tmuxSkillStats.commandPromptCount}</li>\n              <li>choose-tree 실행: {tmuxSkillStats.chooseTreeCount}</li>\n            </ul>\n            <div className=\"achievement-grid\">\n              {funAchievementRows.map((achievement) => (\n                <article\n                  key={achievement.id}\n                  className={": "}\n                >\n                  <h3>{achievement.title}</h3>\n                  <p>{achievement.description}</p>\n                  <p className=\"muted\">{achievement.unlocked ? '달성됨' : '미달성'}</p>\n                  {achievement.unlocked ? (\n                    <a\n                      className=\"text-link\"\n                      href={buildTwitterIntentUrl(\n                        buildAbsoluteAchievementShareUrl(achievement.id, {\n                          level,\n                          xp,\n                          date: shareDate,\n                          badge: achievement.id,\n                        }),\n                        buildAchievementChallengeShareText(achievement.shareText, achievement.id),\n                      )}\n                      target=\"_blank\"\n                      rel=\"noreferrer\"\n                    >\n                      X 챌린지 공유\n                    </a>\n                  ) : null}\n                </article>\n              ))}\n            </div>\n          </section>\n\n          <section className=\"playbook-section\">\n            <h2>Fun 업적</h2>\n            <p className=\"muted\">\n              {unlockedFunAchievements.length}/{funAchievementRows.length} 달성\n            </p>\n            <ul className=\"link-list\">\n              <li>pane 분할 누적: {tmuxSkillStats.splitCount}</li>\n              <li>최대 pane 수: {tmuxSkillStats.maxPaneCount}</li>\n              <li>window 생성: {tmuxSkillStats.newWindowCount}</li>\n              <li>session 생성: {tmuxSkillStats.newSessionCount}</li>\n              <li>copy-mode 진입: {tmuxSkillStats.copyModeCount}</li>\n              <li>pane resize 누적: {tmuxSkillStats.paneResizeCount}</li>\n              <li>pane 이동/선택 누적: {tmuxSkillStats.paneSelectCount}</li>\n              <li>layout 변경 누적: {tmuxSkillStats.layoutSelectCount}</li>\n              <li>zoom 토글 누적: {tmuxSkillStats.zoomToggleCount}</li>\n              <li>sync 토글 누적: {tmuxSkillStats.syncToggleCount}</li>\n              <li>command-prompt 실행: {tmuxSkillStats.commandPromptCount}</li>\n              <li>choose-tree 실행: {tmuxSkillStats.chooseTreeCount}</li>\n            </ul>\n            <div className=\"achievement-grid\">\n              {funAchievementRows.map((achievement) => (\n                <article\n                  key={achievement.id}\n                  className={",
  "}\n              </p>\n            </section>\n\n            <section className=\"vm-terminal-shell\" aria-label=\"VM terminal\">\n              <div className=\"vm-terminal-host\" ref={terminalHostRef} />\n            </section>\n\n            <details className=\"vm-poc-debug\">\n              <summary>브리지 디버그</summary>\n              <div className=\"vm-debug-grid\">\n                <article>\n                  <h3>Recent Action History</h3>\n                  <pre className=\"vm-poc-debug-text\">{actionHistory.slice(-20).join(": "}\n              </p>\n            </section>\n\n            <section className=\"vm-terminal-shell\" aria-label=\"VM terminal\">\n              <div className=\"vm-terminal-host\" ref={terminalHostRef} />\n            </section>\n\n            <details className=\"vm-poc-debug\">\n              <summary>브리지 디버그</summary>\n              <div className=\"vm-debug-grid\">\n                <article>\n                  <h3>Recent Action History</h3>\n                  <pre className=\"vm-poc-debug-text\">{actionHistory.slice(-20).join(",
  "}\n              role={isAchievementCelebration ? 'status' : 'dialog'}\n              aria-modal={isAchievementCelebration ? undefined : true}\n              aria-live=\"polite\"\n              aria-label=\"완료 피드백\"\n            >\n              <div className=\"vm-celebration-burst\" aria-hidden=\"true\">\n                <span />\n                <span />\n                <span />\n              </div>\n              <div className=\"vm-celebration-header\">\n                <span className={": "}\n              role={isAchievementCelebration ? 'status' : 'dialog'}\n              aria-modal={isAchievementCelebration ? undefined : true}\n              aria-live=\"polite\"\n              aria-label=\"완료 피드백\"\n            >\n              <div className=\"vm-celebration-burst\" aria-hidden=\"true\">\n                <span />\n                <span />\n                <span />\n              </div>\n              <div className=\"vm-celebration-header\">\n                <span className={",
  "}\n            onClick={() => setMobileWorkbenchView('mission')}\n          >\n            미션\n          </button>\n          <button\n            type=\"button\"\n            className={": "}\n            onClick={() => setMobileWorkbenchView('mission')}\n          >\n            미션\n          </button>\n          <button\n            type=\"button\"\n            className={",
  "}\n            onClick={() => setMobileWorkbenchView('terminal')}\n          >\n            터미널\n          </button>\n        </div>\n\n        <section className={": "}\n            onClick={() => setMobileWorkbenchView('terminal')}\n          >\n            터미널\n          </button>\n        </div>\n\n        <section className={",
  "}\n      title={t('learn.title')}\n      description={t('learn.description')}\n    >\n      {pageData.lessons.length === 0 ? (\n        <EmptyState title={t('learn.empty.title')} description={t('learn.empty.description')} />\n      ) : (\n        <div className=\"curriculum-track-list\">\n          {pageData.learningJourney ? (\n            <section className=\"learning-journey-card\" aria-label=\"Learning Journey\">\n              <p className=\"page-eyebrow\">tmux-tuto 방식</p>\n              <h2>{pageData.learningJourney.title}</h2>\n              <p>{pageData.learningJourney.intro}</p>\n              <p>\n                <strong>최종 목표:</strong> {pageData.learningJourney.targetOutcome}\n              </p>\n              <div className=\"inline-actions\">\n                {learningPathEntry ? (\n                  <Link className=\"primary-btn\" to={": "}\n      title={t('learn.title')}\n      description={t('learn.description')}\n    >\n      {pageData.lessons.length === 0 ? (\n        <EmptyState title={t('learn.empty.title')} description={t('learn.empty.description')} />\n      ) : (\n        <div className=\"curriculum-track-list\">\n          {pageData.learningJourney ? (\n            <section className=\"learning-journey-card\" aria-label=\"Learning Journey\">\n              <p className=\"page-eyebrow\">tmux-tuto 방식</p>\n              <h2>{pageData.learningJourney.title}</h2>\n              <p>{pageData.learningJourney.intro}</p>\n              <p>\n                <strong>최종 목표:</strong> {pageData.learningJourney.targetOutcome}\n              </p>\n              <div className=\"inline-actions\">\n                {learningPathEntry ? (\n                  <Link className=\"primary-btn\" to={",
  "}`}\n                        onClick={() => selectLessonForAction(row.lesson.slug)}\n                        aria-pressed={isActive}\n                      >\n                        <span className=\"vm-lesson-row-main\">\n                          <strong>{row.lesson.title}</strong>\n                          <small>\n                            {trackTitle} · {chapterTitle}\n                          </small>\n                        </span>\n                        <span className=\"vm-lesson-row-meta\">\n                          <small>\n                            {row.completedMissionCount}/{row.totalMissionCount}\n                          </small>\n                          <span className={`vm-lesson-row-status ${getLessonStatusClass(row.status)}`}>\n                            {getLessonStatusLabel(row.status)}\n                          </span>\n                        </span>\n                      </button>\n                    );\n                  })\n                )}\n              </section>\n              <div className=\"vm-lesson-progress\">\n                <p>\n                  <strong>Lesson 진행:</strong> {lessonCompletedMissionCount}/{lessonMissions.length}\n                </p>\n                <p className=\"muted\">manual 판정 미션: {manualMissionCandidates.length}</p>\n              </div>\n              <div className={`vm-runtime-badge ${getMetricBadgeClass(vmStatus)}`}>\n                <span>VM 상태: {vmStatus}</span>\n                <span>{vmStatusText}</span>\n              </div>\n            </section>\n          </aside>\n\n          <section className=\"vm-lab-panel\">\n            <section className=\"vm-poc-controls\">\n              <div className=\"inline-actions\">\n                <Link className=\"secondary-btn\" to=\"/learn\">\n                  커리큘럼으로 이동\n                </Link>\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => {\n                    setVmEpoch((value) => value + 1);\n                  }}\n                >\n                  VM 재시작\n                </button>\n                <label className=\"vm-poc-check\" htmlFor=\"auto-probe-toggle\">\n                  <input\n                    id=\"auto-probe-toggle\"\n                    type=\"checkbox\"\n                    checked={autoProbe}\n                    onChange={(event) => setAutoProbe(event.target.checked)}\n                  />\n                  Auto probe\n                </label>\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => {\n                    sendInternalCommand(PROBE_TRIGGER_COMMAND);\n                  }}\n                >\n                  Probe 지금 실행\n                </button>\n              </div>\n\n              <form\n                className=\"vm-poc-command-form\"\n                onSubmit={(event) => {\n                  event.preventDefault();\n                  sendCommand(commandInput);\n                }}\n              >\n                <input\n                  className=\"vm-poc-command-input\"\n                  value={commandInput}\n                  onChange={(event) => setCommandInput(event.target.value)}\n                  placeholder=\"tmux new-session -d -s lesson\"\n                  aria-label=\"VM shell command\"\n                />\n                <button type=\"submit\" className=\"primary-btn\" disabled={vmStatus ===": "}`}\n                        onClick={() => selectLessonForAction(row.lesson.slug)}\n                        aria-pressed={isActive}\n                      >\n                        <span className=\"vm-lesson-row-main\">\n                          <strong>{row.lesson.title}</strong>\n                          <small>\n                            {trackTitle} · {chapterTitle}\n                          </small>\n                        </span>\n                        <span className=\"vm-lesson-row-meta\">\n                          <small>\n                            {row.completedMissionCount}/{row.totalMissionCount}\n                          </small>\n                          <span className={`vm-lesson-row-status ${getLessonStatusClass(row.status)}`}>\n                            {getLessonStatusLabel(row.status)}\n                          </span>\n                        </span>\n                      </button>\n                    );\n                  })\n                )}\n              </section>\n              <div className=\"vm-lesson-progress\">\n                <p>\n                  <strong>Lesson 진행:</strong> {lessonCompletedMissionCount}/{lessonMissions.length}\n                </p>\n                <p className=\"muted\">manual 판정 미션: {manualMissionCandidates.length}</p>\n              </div>\n              <div className={`vm-runtime-badge ${getMetricBadgeClass(vmStatus)}`}>\n                <span>VM 상태: {vmStatus}</span>\n                <span>{vmStatusText}</span>\n              </div>\n            </section>\n          </aside>\n\n          <section className=\"vm-lab-panel\">\n            <section className=\"vm-poc-controls\">\n              <div className=\"inline-actions\">\n                <Link className=\"secondary-btn\" to=\"/learn\">\n                  커리큘럼으로 이동\n                </Link>\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => {\n                    setVmEpoch((value) => value + 1);\n                  }}\n                >\n                  VM 재시작\n                </button>\n                <label className=\"vm-poc-check\" htmlFor=\"auto-probe-toggle\">\n                  <input\n                    id=\"auto-probe-toggle\"\n                    type=\"checkbox\"\n                    checked={autoProbe}\n                    onChange={(event) => setAutoProbe(event.target.checked)}\n                  />\n                  Auto probe\n                </label>\n                <button\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={() => {\n                    sendInternalCommand(PROBE_TRIGGER_COMMAND);\n                  }}\n                >\n                  Probe 지금 실행\n                </button>\n              </div>\n\n              <form\n                className=\"vm-poc-command-form\"\n                onSubmit={(event) => {\n                  event.preventDefault();\n                  sendCommand(commandInput);\n                }}\n              >\n                <input\n                  className=\"vm-poc-command-input\"\n                  value={commandInput}\n                  onChange={(event) => setCommandInput(event.target.value)}\n                  placeholder=\"tmux new-session -d -s lesson\"\n                  aria-label=\"VM shell command\"\n                />\n                <button type=\"submit\" className=\"primary-btn\" disabled={vmStatus ===",
  "}`}\n                      onClick={() => selectMissionForAction(mission.slug)}\n                    >\n                      <span className=\"vm-mission-row-main\">\n                        <strong>\n                          {index + 1}. {mission.title}\n                        </strong>\n                        <small>난이도 {getDifficultyLabel(mission.difficulty)}</small>\n                      </span>\n                      <span className={`vm-mission-row-badge ${badgeClass}`}>{badgeLabel}</span>\n                    </button>\n                  );\n                })}\n              </div>\n            </section>\n\n            {selectedMissionSession ? (\n              <section className=\"vm-session-card\">\n                <p className=\"vm-session-card-eyebrow\">현재 세션 상태</p>\n                <p>\n                  <strong>\n                    {selectedMissionSession.status ===": "}`}\n                      onClick={() => selectMissionForAction(mission.slug)}\n                    >\n                      <span className=\"vm-mission-row-main\">\n                        <strong>\n                          {index + 1}. {mission.title}\n                        </strong>\n                        <small>난이도 {getDifficultyLabel(mission.difficulty)}</small>\n                      </span>\n                      <span className={`vm-mission-row-badge ${badgeClass}`}>{badgeLabel}</span>\n                    </button>\n                  );\n                })}\n              </div>\n            </section>\n\n            {selectedMissionSession ? (\n              <section className=\"vm-session-card\">\n                <p className=\"vm-session-card-eyebrow\">현재 세션 상태</p>\n                <p>\n                  <strong>\n                    {selectedMissionSession.status ===",
  "}`}\n                    onClick={() => setLessonFilter(option.value)}\n                  >\n                    {option.label}\n                  </button>\n                ))}\n              </div>\n              <section className=\"vm-lesson-catalog\" aria-label=\"레슨 목록\">\n                {filteredLessonRows.length === 0 ? (\n                  <p className=\"muted\">선택한 필터에 해당하는 레슨이 없습니다.</p>\n                ) : (\n                  filteredLessonRows.map((row) => {\n                    const isActive = row.lesson.slug === selectedLessonSlug;\n                    const trackTitle = trackTitleMap.get(row.lesson.trackSlug) ?? row.lesson.trackSlug;\n                    const chapterTitle = chapterTitleMap.get(row.lesson.chapterSlug) ?? row.lesson.chapterSlug;\n\n                    return (\n                      <button\n                        key={row.lesson.id}\n                        type=\"button\"\n                        className={`vm-lesson-row ${isActive ?": "}`}\n                    onClick={() => setLessonFilter(option.value)}\n                  >\n                    {option.label}\n                  </button>\n                ))}\n              </div>\n              <section className=\"vm-lesson-catalog\" aria-label=\"레슨 목록\">\n                {filteredLessonRows.length === 0 ? (\n                  <p className=\"muted\">선택한 필터에 해당하는 레슨이 없습니다.</p>\n                ) : (\n                  filteredLessonRows.map((row) => {\n                    const isActive = row.lesson.slug === selectedLessonSlug;\n                    const trackTitle = trackTitleMap.get(row.lesson.trackSlug) ?? row.lesson.trackSlug;\n                    const chapterTitle = chapterTitleMap.get(row.lesson.chapterSlug) ?? row.lesson.chapterSlug;\n\n                    return (\n                      <button\n                        key={row.lesson.id}\n                        type=\"button\"\n                        className={`vm-lesson-row ${isActive ?",
  "}</h2>\n        {featuredReferences.length === 0 ? (\n          <EmptyState title=\"검색 결과가 없습니다\" description=\"다른 키워드로 다시 검색해 보세요.\" />\n        ) : (\n          <div className=\"reference-grid\">\n            {featuredReferences.map((item) => (\n              <article key={item.id} className=\"reference-card\">\n                <p className=\"reference-type\">{item.contentType}</p>\n                <h3>{item.title}</h3>\n                <p className=\"muted\">{item.description}</p>\n                <div className=\"inline-actions\">\n                  {item.contentType ===": "}</h2>\n        {featuredReferences.length === 0 ? (\n          <EmptyState title=\"검색 결과가 없습니다\" description=\"다른 키워드로 다시 검색해 보세요.\" />\n        ) : (\n          <div className=\"reference-grid\">\n            {featuredReferences.map((item) => (\n              <article key={item.id} className=\"reference-card\">\n                <p className=\"reference-type\">{item.contentType}</p>\n                <h3>{item.title}</h3>\n                <p className=\"muted\">{item.description}</p>\n                <div className=\"inline-actions\">\n                  {item.contentType ===",
  "}</li>\n            <li>Prefix: {prefixKey}</li>\n            <li>키보드: {keyboardLayout ===": "}</li>\n            <li>Prefix: {prefixKey}</li>\n            <li>키보드: {keyboardLayout ===",
  "}>\n                        <span>{item.label}</span>\n                        <small>{item.current}</small>\n                      </li>\n                    ))}\n                  </ul>\n                </section>\n\n                <div className=\"inline-actions\">\n                  <button\n                    type=\"button\"\n                    className=\"secondary-btn\"\n                    onClick={() => setMobileWorkbenchView('terminal')}\n                  >\n                    터미널로 바로 이동\n                  </button>\n                </div>\n\n                <ul className=\"link-list\">\n                  {missionHintPreview.map((hint, index) => (\n                    <li key={hint}>{renderHintTextWithTooltips(hint,": "}>\n                        <span>{item.label}</span>\n                        <small>{item.current}</small>\n                      </li>\n                    ))}\n                  </ul>\n                </section>\n\n                <div className=\"inline-actions\">\n                  <button\n                    type=\"button\"\n                    className=\"secondary-btn\"\n                    onClick={() => setMobileWorkbenchView('terminal')}\n                  >\n                    터미널로 바로 이동\n                  </button>\n                </div>\n\n                <ul className=\"link-list\">\n                  {missionHintPreview.map((hint, index) => (\n                    <li key={hint}>{renderHintTextWithTooltips(hint,",
  "}>\n                    통합 경로 바로 시작\n                  </Link>\n                ) : null}\n                {paneNavigationEntry ? (\n                  <Link className=\"secondary-btn\" to={": "}>\n                    통합 경로 바로 시작\n                  </Link>\n                ) : null}\n                {paneNavigationEntry ? (\n                  <Link className=\"secondary-btn\" to={",
  "}>\n                    pane 이동부터 시작\n                  </Link>\n                ) : null}\n              </div>\n            </section>\n          ) : null}\n\n          <section className=\"curriculum-track-card learning-level-card\">\n            <header className=\"curriculum-track-head\">\n              <div>\n                <h2>{pageData.learningPath?.title ?? '통합 레슨 경로'}</h2>\n                <p className=\"muted\">\n                  목표: {pageData.learningPath?.description ?? 'session/window/pane 기초 조작부터 pane 이동, copy-mode, command-mode, 원격 운영까지 한 흐름으로 완료'}\n                </p>\n              </div>\n              {learningPathEntry ? (\n                <Link className=\"primary-btn\" to={": "}>\n                    pane 이동부터 시작\n                  </Link>\n                ) : null}\n              </div>\n            </section>\n          ) : null}\n\n          <section className=\"curriculum-track-card learning-level-card\">\n            <header className=\"curriculum-track-head\">\n              <div>\n                <h2>{pageData.learningPath?.title ?? '통합 레슨 경로'}</h2>\n                <p className=\"muted\">\n                  목표: {pageData.learningPath?.description ?? 'session/window/pane 기초 조작부터 pane 이동, copy-mode, command-mode, 원격 운영까지 한 흐름으로 완료'}\n                </p>\n              </div>\n              {learningPathEntry ? (\n                <Link className=\"primary-btn\" to={",
  "}>\n                  {getCelebrationKindLabel(celebration.kind)}\n                </span>\n                {celebrationQueueCount > 0 ? (\n                  <span className=\"vm-celebration-queue-chip\">다음 {celebrationQueueCount}</span>\n                ) : null}\n              </div>\n              <p>\n                <strong>{celebration.message}</strong>\n              </p>\n              <p>{celebration.detail}</p>\n              {celebration.kind === 'mission' && nextIncompleteMission ? (\n                <section className=\"vm-celebration-next-action\">\n                  <p className=\"vm-celebration-next-label\">추천 다음 단계</p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-celebration-primary-btn\"\n                    onClick={() => {\n                      selectMissionForAction(nextIncompleteMission.slug);\n                      advanceCelebration();\n                    }}\n                  >\n                    다음 미션 시작\n                  </button>\n                  <p className=\"muted\">다음: {nextIncompleteMission.title}</p>\n                </section>\n              ) : null}\n              {celebration.kind === 'lesson' && nextLesson ? (\n                <section className=\"vm-celebration-next-action\">\n                  <p className=\"vm-celebration-next-label\">추천 다음 단계</p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-celebration-primary-btn\"\n                    onClick={() => {\n                      selectNextLessonForAction();\n                      advanceCelebration();\n                    }}\n                  >\n                    다음 레슨 시작\n                  </button>\n                  <p className=\"muted\">다음: {nextLesson.title}</p>\n                </section>\n              ) : null}\n              {celebration.kind === 'lesson' && !nextLesson ? (\n                <section className=\"vm-celebration-next-action\">\n                  <p className=\"vm-celebration-next-label\">추천 다음 단계</p>\n                  <Link className=\"primary-btn vm-celebration-primary-btn\" to=\"/progress\">\n                    학습 완료 현황 보기\n                  </Link>\n                </section>\n              ) : null}\n              <div className=\"inline-actions vm-celebration-actions\">\n                <Link className=\"secondary-btn\" to=\"/progress\">\n                  업적 보기\n                </Link>\n                {celebrationShareHref ? (\n                  <a className=\"text-link\" href={celebrationShareHref} target=\"_blank\" rel=\"noreferrer\">\n                    X 챌린지 공유\n                  </a>\n                ) : null}\n                <button\n                  ref={celebrationCloseButtonRef}\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={advanceCelebration}\n                >\n                  닫기 (Esc)\n                </button>\n              </div>\n            </section>\n          </section>\n        ) : null}\n\n        <div className=\"vm-mobile-switch\" role=\"tablist\" aria-label=\"실습 화면 전환\">\n          <button\n            type=\"button\"\n            className={": "}>\n                  {getCelebrationKindLabel(celebration.kind)}\n                </span>\n                {celebrationQueueCount > 0 ? (\n                  <span className=\"vm-celebration-queue-chip\">다음 {celebrationQueueCount}</span>\n                ) : null}\n              </div>\n              <p>\n                <strong>{celebration.message}</strong>\n              </p>\n              <p>{celebration.detail}</p>\n              {celebration.kind === 'mission' && nextIncompleteMission ? (\n                <section className=\"vm-celebration-next-action\">\n                  <p className=\"vm-celebration-next-label\">추천 다음 단계</p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-celebration-primary-btn\"\n                    onClick={() => {\n                      selectMissionForAction(nextIncompleteMission.slug);\n                      advanceCelebration();\n                    }}\n                  >\n                    다음 미션 시작\n                  </button>\n                  <p className=\"muted\">다음: {nextIncompleteMission.title}</p>\n                </section>\n              ) : null}\n              {celebration.kind === 'lesson' && nextLesson ? (\n                <section className=\"vm-celebration-next-action\">\n                  <p className=\"vm-celebration-next-label\">추천 다음 단계</p>\n                  <button\n                    type=\"button\"\n                    className=\"primary-btn vm-celebration-primary-btn\"\n                    onClick={() => {\n                      selectNextLessonForAction();\n                      advanceCelebration();\n                    }}\n                  >\n                    다음 레슨 시작\n                  </button>\n                  <p className=\"muted\">다음: {nextLesson.title}</p>\n                </section>\n              ) : null}\n              {celebration.kind === 'lesson' && !nextLesson ? (\n                <section className=\"vm-celebration-next-action\">\n                  <p className=\"vm-celebration-next-label\">추천 다음 단계</p>\n                  <Link className=\"primary-btn vm-celebration-primary-btn\" to=\"/progress\">\n                    학습 완료 현황 보기\n                  </Link>\n                </section>\n              ) : null}\n              <div className=\"inline-actions vm-celebration-actions\">\n                <Link className=\"secondary-btn\" to=\"/progress\">\n                  업적 보기\n                </Link>\n                {celebrationShareHref ? (\n                  <a className=\"text-link\" href={celebrationShareHref} target=\"_blank\" rel=\"noreferrer\">\n                    X 챌린지 공유\n                  </a>\n                ) : null}\n                <button\n                  ref={celebrationCloseButtonRef}\n                  type=\"button\"\n                  className=\"secondary-btn\"\n                  onClick={advanceCelebration}\n                >\n                  닫기 (Esc)\n                </button>\n              </div>\n            </section>\n          </section>\n        ) : null}\n\n        <div className=\"vm-mobile-switch\" role=\"tablist\" aria-label=\"실습 화면 전환\">\n          <button\n            type=\"button\"\n            className={",
  "}>\n                  명령 실행\n                </button>\n              </form>\n\n              <details className=\"vm-poc-quick-wrap\">\n                <summary>자주 쓰는 명령 빠르게 실행</summary>\n                <div className=\"vm-poc-quick\">\n                  {QUICK_COMMANDS.map((item) => (\n                    <button key={item.label} type=\"button\" className=\"secondary-btn\" onClick={() => sendCommand(item.command)}>\n                      {item.label}\n                    </button>\n                  ))}\n                </div>\n              </details>\n\n              <p className=\"vm-poc-status\">\n                metrics · sessions {metrics.sessionCount ??": "}>\n                  명령 실행\n                </button>\n              </form>\n\n              <details className=\"vm-poc-quick-wrap\">\n                <summary>자주 쓰는 명령 빠르게 실행</summary>\n                <div className=\"vm-poc-quick\">\n                  {QUICK_COMMANDS.map((item) => (\n                    <button key={item.label} type=\"button\" className=\"secondary-btn\" onClick={() => sendCommand(item.command)}>\n                      {item.label}\n                    </button>\n                  ))}\n                </div>\n              </details>\n\n              <p className=\"vm-poc-status\">\n                metrics · sessions {metrics.sessionCount ??",
  "}>\n                  처음부터 시작\n                </Link>\n              ) : null}\n            </header>\n            <div className=\"curriculum-lesson-list\">\n              {orderedLessons.map((lesson) => (\n                <div key={lesson.id} className=\"curriculum-lesson-row\">\n                  <Link\n                    className=\"curriculum-lesson-link\"\n                    to={": "}>\n                  처음부터 시작\n                </Link>\n              ) : null}\n            </header>\n            <div className=\"curriculum-lesson-list\">\n              {orderedLessons.map((lesson) => (\n                <div key={lesson.id} className=\"curriculum-lesson-row\">\n                  <Link\n                    className=\"curriculum-lesson-link\"\n                    to={",
  "}>\n          <aside className=\"vm-study-panel\">\n            {selectedMission ? (\n              <article className=\"vm-mission-card vm-mission-priority-card\">\n                <p className=\"vm-mission-priority-eyebrow\">Priority 1</p>\n                <h2>\n                  현재 미션\n                  {selectedMissionOrder ?": "}>\n          <aside className=\"vm-study-panel\">\n            {selectedMission ? (\n              <article className=\"vm-mission-card vm-mission-priority-card\">\n                <p className=\"vm-mission-priority-eyebrow\">Priority 1</p>\n                <h2>\n                  현재 미션\n                  {selectedMissionOrder ?",
  "&& item.playbookSlug ? (\n                    <Link to={`/playbooks/${item.playbookSlug}`} className=\"secondary-btn\">\n                      플레이북 단계 보기\n                    </Link>\n                  ) : (\n                    <Link to={resolvePracticePath(item)} className=\"secondary-btn\">\n                      실습 워크벤치 열기\n                    </Link>\n                  )}\n                </div>\n                {item.command ? <code className=\"playbook-command\">{item.command}</code> : null}\n                {item.shortcut ? <code className=\"playbook-command\">{item.shortcut}</code> : null}\n              </article>\n            ))}\n          </div>\n        )}\n      </section>\n\n      <section className=\"reference-section\">\n        <h2>핵심 플레이북</h2>\n        {playbooks.length === 0 ? (\n          <EmptyState title=\"플레이북 데이터 없음\" description=\"콘텐츠 로드를 확인해 주세요.\" />\n        ) : (\n          <div className=\"reference-playbook-grid\">\n            {playbooks.slice(0, 6).map((playbook) => (\n              <article key={playbook.slug} className=\"reference-playbook-card\">\n                <p className=\"reference-type\">{playbook.category}</p>\n                <h3>{playbook.title}</h3>\n                <p className=\"muted\">\n                  {playbook.estimatedMinutes}분 · 단계 {playbook.steps.length}개\n                </p>\n                <p className=\"muted\">선행: {playbook.prerequisites.join(": "&& item.playbookSlug ? (\n                    <Link to={`/playbooks/${item.playbookSlug}`} className=\"secondary-btn\">\n                      플레이북 단계 보기\n                    </Link>\n                  ) : (\n                    <Link to={resolvePracticePath(item)} className=\"secondary-btn\">\n                      실습 워크벤치 열기\n                    </Link>\n                  )}\n                </div>\n                {item.command ? <code className=\"playbook-command\">{item.command}</code> : null}\n                {item.shortcut ? <code className=\"playbook-command\">{item.shortcut}</code> : null}\n              </article>\n            ))}\n          </div>\n        )}\n      </section>\n\n      <section className=\"reference-section\">\n        <h2>핵심 플레이북</h2>\n        {playbooks.length === 0 ? (\n          <EmptyState title=\"플레이북 데이터 없음\" description=\"콘텐츠 로드를 확인해 주세요.\" />\n        ) : (\n          <div className=\"reference-playbook-grid\">\n            {playbooks.slice(0, 6).map((playbook) => (\n              <article key={playbook.slug} className=\"reference-playbook-card\">\n                <p className=\"reference-type\">{playbook.category}</p>\n                <h3>{playbook.title}</h3>\n                <p className=\"muted\">\n                  {playbook.estimatedMinutes}분 · 단계 {playbook.steps.length}개\n                </p>\n                <p className=\"muted\">선행: {playbook.prerequisites.join(",
  ">\n                      X 챌린지 공유\n                    </a>\n                  ) : null}\n                </article>\n              ))}\n            </div>\n          </section>\n\n          <section className=": ">\n                      X 챌린지 공유\n                    </a>\n                  ) : null}\n                </article>\n              ))}\n            </div>\n          </section>\n\n          <section className=",
  ">\n                  상세 가이드 보기\n                </Link>\n              </article>\n            ))}\n          </div>\n        )}\n        <div className=": ">\n                  상세 가이드 보기\n                </Link>\n              </article>\n            ))}\n          </div>\n        )}\n        <div className=",
  ">\n                  힌트 Lv.{maxHintLevelUsed}: {hintText}\n                </p>\n              ) : null}\n            </section>\n          ) : null}\n\n          <div className=": ">\n                  힌트 Lv.{maxHintLevelUsed}: {hintText}\n                </p>\n              ) : null}\n            </section>\n          ) : null}\n\n          <div className=",
  ">\n              <h2>실패 피드백</h2>\n              <p className=": ">\n              <h2>실패 피드백</h2>\n              <p className=",
  ">\n              <li>현재 윈도우에서 pane 수를 2개 이상으로 만든다.</li>\n              <li>완료 후 제출 버튼으로 채점한다.</li>\n            </ul>\n            <p className=": ">\n              <li>현재 윈도우에서 pane 수를 2개 이상으로 만든다.</li>\n              <li>완료 후 제출 버튼으로 채점한다.</li>\n            </ul>\n            <p className=",
  ">\n              현재 상태: pane {activeWindow.panes.length}개 / mode {simulatorState.mode.value}\n            </p>\n          </section>\n\n          <section className=": ">\n              현재 상태: pane {activeWindow.panes.length}개 / mode {simulatorState.mode.value}\n            </p>\n          </section>\n\n          <section className=",
  ">\n            <h2>다음 추천 미션</h2>\n            {recommendedMissions.length === 0 ? (\n              <p className=": ">\n            <h2>다음 추천 미션</h2>\n            {recommendedMissions.length === 0 ? (\n              <p className=",
  ">\n            <h2>마일스톤 공유</h2>\n            {milestoneLinks.length === 0 ? (\n              <p className=": ">\n            <h2>마일스톤 공유</h2>\n            {milestoneLinks.length === 0 ? (\n              <p className=",
  ">\n            <h2>목표</h2>\n            <ul className=": ">\n            <h2>목표</h2>\n            <ul className=",
  ">\n            <h2>실시간 힌트</h2>\n            <p className=": ">\n            <h2>실시간 힌트</h2>\n            <p className=",
  ">\n            <li>\n              추천 트랙: <strong>{recommendedTrackTitle}</strong>\n              <p className=": ">\n            <li>\n              추천 트랙: <strong>{recommendedTrackTitle}</strong>\n              <p className=",
  ">\n            <li>미션: {missionSlug}</li>\n            <li>획득 XP: +{gainedXp}</li>\n          </ul>\n          <p className=": ">\n            <li>미션: {missionSlug}</li>\n            <li>획득 XP: +{gainedXp}</li>\n          </ul>\n          <p className=",
  ">\n            이 페이지는 Cloudflare 분석에서 온보딩 첫 성공 이벤트 라우트로 사용됩니다.\n          </p>\n        </section>\n      </div>\n\n      <div className=": ">\n            이 페이지는 Cloudflare 분석에서 온보딩 첫 성공 이벤트 라우트로 사용됩니다.\n          </p>\n        </section>\n      </div>\n\n      <div className=",
  ">\n            X에서 공유\n          </a>\n        </div>\n        {copyStatus ? (\n          <p className=": ">\n            X에서 공유\n          </a>\n        </div>\n        {copyStatus ? (\n          <p className=",
  ">\n          <h2>개인화 추천</h2>\n          <ul className=": ">\n          <h2>개인화 추천</h2>\n          <ul className=",
  ">\n          <h2>통과 요약</h2>\n          <ul className=": ">\n          <h2>통과 요약</h2>\n          <ul className=",
  ">\n          오늘 1개 미션 시작\n        </Link>\n        <Link to={`/playbooks/${recommendation.playbookSlug}`} className=": ">\n          오늘 1개 미션 시작\n        </Link>\n        <Link to={`/playbooks/${recommendation.playbookSlug}`} className=",
  ">\n          온보딩 완료 화면으로\n        </Link>\n        <Link to=": ">\n          온보딩 완료 화면으로\n        </Link>\n        <Link to=",
  ">\n          플레이북으로 돌아가기\n        </Link>\n        <Link to=": ">\n          플레이북으로 돌아가기\n        </Link>\n        <Link to=",
  ">\n        <h2>공유 설정</h2>\n        <p className=": ">\n        <h2>공유 설정</h2>\n        <p className=",
  ">\n        <h2>공유 URL</h2>\n        <p className=": ">\n        <h2>공유 URL</h2>\n        <p className=",
  "> /dev/ttyS1',\n  },\n  {\n    label: '레이아웃 변경',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux select-layout -t lesson:0 even-horizontal; tmux display-message -p": "> /dev/ttyS1',\n  },\n  {\n    label: '레이아웃 변경',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux select-layout -t lesson:0 even-horizontal; tmux display-message -p",
  "> /dev/ttyS1',\n  },\n  {\n    label: 'Copy Search 실패',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux copy-mode -t lesson:0.0; tmux send-keys -t lesson:0.0 -X search-backward": "> /dev/ttyS1',\n  },\n  {\n    label: 'Copy Search 실패',\n    command:\n      'tmux has-session -t lesson 2>/dev/null || tmux new-session -d -s lesson; tmux copy-mode -t lesson:0.0; tmux send-keys -t lesson:0.0 -X search-backward",
  ">{achievement.unlocked ? '달성됨' : '미달성'}</p>\n                  {achievement.unlocked ? (\n                    <a\n                      className=": ">{achievement.unlocked ? '달성됨' : '미달성'}</p>\n                  {achievement.unlocked ? (\n                    <a\n                      className=",
  ">{liveHint?.hintText ?? '현재 상태를 분석 중입니다.'}</p>\n          </section>\n\n          <div className=": ">{liveHint?.hintText ?? '현재 상태를 분석 중입니다.'}</p>\n          </section>\n\n          <div className=",
  ">{recommendation.trackReason}</p>\n            </li>\n            <li>\n              추천 플레이북: <strong>{recommendedPlaybookTitle}</strong>\n              <p className=": ">{recommendation.trackReason}</p>\n            </li>\n            <li>\n              추천 플레이북: <strong>{recommendedPlaybookTitle}</strong>\n              <p className=",
  ">공유 가능한 마일스톤이 아직 없습니다.</p>\n            ) : (\n              <ul className=": ">공유 가능한 마일스톤이 아직 없습니다.</p>\n            ) : (\n              <ul className=",
  ">닉네임은 선택값이며 개인 식별 정보 입력은 권장하지 않습니다.</p>\n        <div className=": ">닉네임은 선택값이며 개인 식별 정보 입력은 권장하지 않습니다.</p>\n        <div className=",
  ">모든 미션을 완료했습니다.</p>\n            ) : (\n              <ul className=": ">모든 미션을 완료했습니다.</p>\n            ) : (\n              <ul className=",
  ">시작: {formatSessionDateTime(selectedMissionSession.startedAt)}</p>\n                {selectedMissionSession.completedAt ? (\n                  <p className=": ">시작: {formatSessionDateTime(selectedMissionSession.startedAt)}</p>\n                {selectedMissionSession.completedAt ? (\n                  <p className=",
  ">완료: {formatSessionDateTime(selectedMissionSession.completedAt)}</p>\n                ) : null}\n                {selectedMissionSession.gainedXp !== null ? (\n                  <p className=": ">완료: {formatSessionDateTime(selectedMissionSession.completedAt)}</p>\n                ) : null}\n                {selectedMissionSession.gainedXp !== null ? (\n                  <p className=",
  ">획득 XP: +{selectedMissionSession.gainedXp}</p>\n                ) : null}\n              </section>\n            ) : null}\n\n            {selectedLesson ? (\n              <section className=": ">획득 XP: +{selectedMissionSession.gainedXp}</p>\n                ) : null}\n              </section>\n            ) : null}\n\n            {selectedLesson ? (\n              <section className=",
  ">payload가 파손되어 기본값으로 렌더링했습니다.</p>\n        ) : null}\n      </section>\n\n      <section className=": ">payload가 파손되어 기본값으로 렌더링했습니다.</p>\n        ) : null}\n      </section>\n\n      <section className=",
  "|| !content) {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Practice\"\n        title=\"VM Practice 로드 실패\"\n        description=\"커리큘럼 데이터를 읽지 못했습니다.\"\n      >\n        <div className=\"inline-actions\">\n          <button\n            type=\"button\"\n            className=\"secondary-btn\"\n            onClick={() => {\n              window.location.reload();\n            }}\n          >\n            새로고침\n          </button>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Practice\"\n      title=\"tmux 실습\"\n      description=\"\"\n    >\n      <div className=\"vm-poc-panel\">\n        <details className=\"vm-poc-note\">\n          <summary>실습 환경 안내</summary>\n          <p>\n            <strong>실행 방식:</strong> 브라우저 안에서 v86 + Alpine Linux + tmux를 직접 실행합니다. 입력은\n            xterm.js를 통해 시리얼 콘솔로 전달됩니다.\n          </p>\n          <p>\n            <strong>브리지:</strong> VM 출력에서 tmux 상태/행동을 probe로 수집해 미션 완료를 자동 판정합니다.\n          </p>\n        </details>\n\n        {celebration ? (\n          <section className={`vm-celebration-overlay ${isAchievementCelebration ?": "|| !content) {\n    return (\n      <PagePlaceholder\n        eyebrow=\"Practice\"\n        title=\"VM Practice 로드 실패\"\n        description=\"커리큘럼 데이터를 읽지 못했습니다.\"\n      >\n        <div className=\"inline-actions\">\n          <button\n            type=\"button\"\n            className=\"secondary-btn\"\n            onClick={() => {\n              window.location.reload();\n            }}\n          >\n            새로고침\n          </button>\n        </div>\n      </PagePlaceholder>\n    );\n  }\n\n  return (\n    <PagePlaceholder\n      eyebrow=\"Practice\"\n      title=\"tmux 실습\"\n      description=\"\"\n    >\n      <div className=\"vm-poc-panel\">\n        <details className=\"vm-poc-note\">\n          <summary>실습 환경 안내</summary>\n          <p>\n            <strong>실행 방식:</strong> 브라우저 안에서 v86 + Alpine Linux + tmux를 직접 실행합니다. 입력은\n            xterm.js를 통해 시리얼 콘솔로 전달됩니다.\n          </p>\n          <p>\n            <strong>브리지:</strong> VM 출력에서 tmux 상태/행동을 probe로 수집해 미션 완료를 자동 판정합니다.\n          </p>\n        </details>\n\n        {celebration ? (\n          <section className={`vm-celebration-overlay ${isAchievementCelebration ?",
  "${rule.kind} ${rule.operator} ${JSON.stringify(rule.value)} 조건을 충족하지 못했습니다.": "${rule.kind} ${rule.operator} ${JSON.stringify(rule.value)} 조건을 충족하지 못했습니다.",
  "2~3분짜리 미션입니다. 분할 후 제출하면 즉시 통과 여부를 확인합니다.": "2~3분짜리 미션입니다. 분할 후 제출하면 즉시 통과 여부를 확인합니다.",
  "7일 스트릭": "7일 스트릭",
  "7일 연속 학습 스트릭을 달성했어요.": "7일 연속 학습 스트릭을 달성했어요.",
  "7일 연속 학습을 달성했습니다.": "7일 연속 학습을 달성했습니다.",
  "검색 시작": "검색 시작",
  "경로 열기": "경로 열기",
  "경로를 확인하거나 홈으로 이동해 주세요.": "경로를 확인하거나 홈으로 이동해 주세요.",
  "고급 루틴까지 완주": "고급 루틴까지 완주",
  "고난도 패인 챌린지": "고난도 패인 챌린지",
  "기본 조작: Session/Window/Pane": "기본 조작: Session/Window/Pane",
  "기초 운영 루프": "기초 운영 루프",
  "기초 트랙 실습을 완료했습니다.": "기초 트랙 실습을 완료했습니다.",
  "닉네임 (선택)": "닉네임 (선택)",
  "다음 윈도우": "다음 윈도우",
  "다음 트랙: 분할과 리사이즈": "다음 트랙: 분할과 리사이즈",
  "다음 트랙: Copy Mode 검색": "다음 트랙: Copy Mode 검색",
  "단축키 복습 중심": "단축키 복습 중심",
  "데이터를 불러오는 중입니다...": "데이터를 불러오는 중입니다...",
  "동의하고 계속": "동의하고 계속",
  "동의하지 않음": "동의하지 않음",
  "또는 검색 입력) 한 번을 실행하세요.';\n    case 'searchMatchFound':\n      return '검색어를 조정해 매치 존재/부재 조건을 정확히 맞추세요.';\n    case 'actionHistoryText':\n      return '요구된 tmux 동작 로그가 남아야 합니다. 단축키 동작을 실제로 실행하세요.';\n    case 'shellHistoryText':\n      return '명령줄에서 요구 명령을 직접 실행해 shell history 조건을 만족시키세요.';\n    default:\n      return '실패 조건에 맞춰 상태를 갱신한 뒤 다시 제출하세요.';\n  }\n}\n\nexport function getLiveHintForMission(\n  mission: AppMission,\n  result: MissionGradeResult,\n): HintPayload {\n  if (result.passed) {\n    return {\n      hintLevel: 1,\n      hintText: '현재 상태가 통과 조건을 만족합니다. 제출하고 채점해 보세요.',\n    };\n  }\n\n  const firstRule = result.failedRules[0];\n  if (!firstRule) {\n    return {\n      hintLevel: 1,\n      hintText: mission.hints[0] ?? '핵심 목표를 다시 확인해 보세요.',\n    };\n  }\n\n  return {\n    hintLevel: 1,\n    hintText:": "또는 검색 입력) 한 번을 실행하세요.';\n    case 'searchMatchFound':\n      return '검색어를 조정해 매치 존재/부재 조건을 정확히 맞추세요.';\n    case 'actionHistoryText':\n      return '요구된 tmux 동작 로그가 남아야 합니다. 단축키 동작을 실제로 실행하세요.';\n    case 'shellHistoryText':\n      return '명령줄에서 요구 명령을 직접 실행해 shell history 조건을 만족시키세요.';\n    default:\n      return '실패 조건에 맞춰 상태를 갱신한 뒤 다시 제출하세요.';\n  }\n}\n\nexport function getLiveHintForMission(\n  mission: AppMission,\n  result: MissionGradeResult,\n): HintPayload {\n  if (result.passed) {\n    return {\n      hintLevel: 1,\n      hintText: '현재 상태가 통과 조건을 만족합니다. 제출하고 채점해 보세요.',\n    };\n  }\n\n  const firstRule = result.failedRules[0];\n  if (!firstRule) {\n    return {\n      hintLevel: 1,\n      hintText: mission.hints[0] ?? '핵심 목표를 다시 확인해 보세요.',\n    };\n  }\n\n  return {\n    hintLevel: 1,\n    hintText:",
  "레슨 로딩 중": "레슨 로딩 중",
  "레슨 정보를 불러오고 있습니다.": "레슨 정보를 불러오고 있습니다.",
  "레슨 탐험가": "레슨 탐험가",
  "레슨 탐험가 업적을 달성했어요.": "레슨 탐험가 업적을 달성했어요.",
  "레슨, 미션, 명령 제안을 한 화면에서 관리하며 바로 실행합니다.": "레슨, 미션, 명령 제안을 한 화면에서 관리하며 바로 실행합니다.",
  "레이아웃 연금술사": "레이아웃 연금술사",
  "레이아웃 연금술사 업적을 달성했어요.": "레이아웃 연금술사 업적을 달성했어요.",
  "레이아웃 조정 챌린지": "레이아웃 조정 챌린지",
  "레이아웃을 바꾸거나 다양한 레이아웃을 실험했습니다.": "레이아웃을 바꾸거나 다양한 레이아웃을 실험했습니다.",
  "레퍼런스": "레퍼런스",
  "레퍼런스 허브": "레퍼런스 허브",
  "로그와 쉘을 동시에 보기": "로그와 쉘을 동시에 보기",
  "로드된 레슨이 없습니다": "로드된 레슨이 없습니다",
  "로컬에서 원격 세션 운영으로 확장": "로컬에서 원격 세션 운영으로 확장",
  "메뉴 구성": "메뉴 구성",
  "명령 입력과 즉시 피드백 중심": "명령 입력과 즉시 피드백 중심",
  "명령 흐름 입문": "명령 흐름 입문",
  "명령 흐름 입문 업적을 달성했어요.": "명령 흐름 입문 업적을 달성했어요.",
  "명령/단축키/플레이북을 한 메뉴에서 검색하고 바로 실습으로 연결합니다.": "명령/단축키/플레이북을 한 메뉴에서 검색하고 바로 실습으로 연결합니다.",
  "미션 로드 실패": "미션 로드 실패",
  "미션 통과 라우트(분석용)와 결과 요약 화면입니다.": "미션 통과 라우트(분석용)와 결과 요약 화면입니다.",
  "미시작": "미시작",
  "미완료": "미완료",
  "미확인`;\n    }\n    case 'actionHistoryText': {\n      const expected = typeof rule.value === 'string' ? rule.value : null;\n      if (!expected) {\n        return `최근 액션 ${snapshot.actionHistory.length}개`;\n      }\n      const found = snapshot.actionHistory.some((action) => action.includes(expected));\n      return found ? `최근 액션에서": "미확인`;\n    }\n    case 'actionHistoryText': {\n      const expected = typeof rule.value === 'string' ? rule.value : null;\n      if (!expected) {\n        return `최근 액션 ${snapshot.actionHistory.length}개`;\n      }\n      const found = snapshot.actionHistory.some((action) => action.includes(expected));\n      return found ? `최근 액션에서",
  "미확인`;\n    }\n    default:\n      return '현재 상태 측정값 없음';\n  }\n}\n\nfunction getInitialScenarioLabel(initialScenario: string) {\n  switch (initialScenario) {\n    case 'single-pane':\n      return '초기 시나리오: 단일 pane에서 시작';\n    case 'log-buffer':\n      return '초기 시나리오: 로그 버퍼가 준비된 pane에서 시작';\n    default:\n      return `초기 시나리오: ${initialScenario}`;\n  }\n}\n\nfunction buildMissionPreconditionItems(mission: AppMission | null, snapshot: VmBridgeSnapshot): MissionPreconditionItem[] {\n  if (!mission) {\n    return [];\n  }\n\n  const ruleItems = mission.passRules.map<MissionPreconditionItem>((rule, index) => {\n    const actual = getRuleMetricValue(snapshot, rule.kind);\n    const satisfied = actual !== null && actual !== undefined && evaluateRuleOperator(actual, rule.operator, rule.value);\n\n    return {\n      key: `${rule.kind}-${index}`,\n      label: getRulePreconditionLabel(rule),\n      current: getRuleCurrentStateText(rule, snapshot),\n      satisfied,\n    };\n  });\n\n  return [\n    {\n      key: 'initial-scenario',\n      label: getInitialScenarioLabel(mission.initialScenario),\n      current: '미션 진입 시 자동 적용',\n      satisfied: true,\n    },\n    ...ruleItems,\n  ];\n}\n\nfunction computeCompletedTrackSlugs(content: AppContent, completedMissionSlugs: string[]) {\n  const completedSet = new Set(completedMissionSlugs);\n  const lessonTrackMap = new Map(content.lessons.map((lesson) => [lesson.slug, lesson.trackSlug]));\n\n  return content.tracks\n    .filter((track) => {\n      const trackMissionSlugs = content.missions\n        .filter((mission) => lessonTrackMap.get(mission.lessonSlug) === track.slug)\n        .map((mission) => mission.slug);\n\n      if (trackMissionSlugs.length === 0) {\n        return false;\n      }\n\n      return trackMissionSlugs.every((slug) => completedSet.has(slug));\n    })\n    .map((track) => track.slug);\n}\n\nfunction createInitialMetrics(): VmMetricState {\n  return {\n    sessionCount: null,\n    windowCount: null,\n    paneCount: null,\n    modeIs: null,\n    sessionName: null,\n    activeWindowIndex: null,\n    windowLayout: null,\n    windowZoomed: null,\n    paneSynchronized: null,\n    searchExecuted: null,\n    searchMatchFound: null,\n  };\n}\n\nfunction formatLayout(layout: string | null) {\n  if (!layout) {\n    return '-';\n  }\n\n  if (layout.length <= 28) {\n    return layout;\n  }\n\n  return `${layout.slice(0, 28)}...`;\n}\n\nfunction formatSessionDateTime(iso: string | null) {\n  if (!iso) {\n    return '-';\n  }\n\n  const date = new Date(iso);\n  if (Number.isNaN(date.getTime())) {\n    return '-';\n  }\n\n  return date.toLocaleString('ko-KR', {\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n}\n\nfunction getLessonStatusLabel(status: LessonCompletionStatus) {\n  switch (status) {\n    case 'completed':\n      return '완료';\n    case 'in-progress':\n      return '진행중';\n    case 'not-started':\n    default:\n      return '미시작';\n  }\n}\n\nfunction getLessonStatusClass(status: LessonCompletionStatus) {\n  switch (status) {\n    case 'completed':\n      return 'is-complete';\n    case 'in-progress':\n      return 'is-in-progress';\n    case 'not-started':\n    default:\n      return 'is-not-started';\n  }\n}\n\nfunction getCelebrationKindLabel(kind: CelebrationState['kind']) {\n  switch (kind) {\n    case 'mission':\n      return 'Mission Complete';\n    case 'lesson':\n      return 'Lesson Complete';\n    case 'achievement':\n      return 'Achievement';\n    default:\n      return 'Update';\n  }\n}\n\nexport function PracticeVmPocPage() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [contentState, setContentState] = useState<{\n    status: 'loading' | 'ready' | 'error';\n    content: AppContent | null;\n  }>({\n    status: 'loading',\n    content: null,\n  });\n\n  const [selectedLessonSlug, setSelectedLessonSlug] = useState('');\n  const [selectedMissionSlug, setSelectedMissionSlug] = useState('');\n  const [vmEpoch, setVmEpoch] = useState(0);\n  const [vmStatus, setVmStatus] = useState<VmStatus>('idle');\n  const [vmStatusText, setVmStatusText] = useState('대기 중');\n  const [commandInput, setCommandInput] = useState('tmux list-sessions');\n  const [debugLines, setDebugLines] = useState<string[]>([]);\n  const [actionHistory, setActionHistory] = useState<string[]>([]);\n  const [commandHistory, setCommandHistory] = useState<string[]>([]);\n  const [metrics, setMetrics] = useState<VmMetricState>(createInitialMetrics());\n  const [celebrationState, setCelebrationState] = useState<CelebrationQueueState>({\n    active: null,\n    queue: [],\n  });\n  const [autoProbe, setAutoProbe] = useState(true);\n  const [lessonFilter, setLessonFilter] = useState<LessonFilter>('all');\n  const [mobileWorkbenchView, setMobileWorkbenchView] = useState<'mission' | 'terminal'>('terminal');\n\n  const completedMissionSlugs = useProgressStore((store) => store.completedMissionSlugs);\n  const level = useProgressStore((store) => store.level);\n  const xp = useProgressStore((store) => store.xp);\n  const unlockedAchievements = useProgressStore((store) => store.unlockedAchievements);\n  const missionSessions = useProgressStore((store) => store.missionSessions);\n  const recordMissionPass = useProgressStore((store) => store.recordMissionPass);\n  const recordTmuxActivity = useProgressStore((store) => store.recordTmuxActivity);\n  const startMissionSession = useProgressStore((store) => store.startMissionSession);\n\n  const terminalHostRef = useRef<HTMLDivElement | null>(null);\n  const terminalRef = useRef<Terminal | null>(null);\n  const emulatorRef = useRef<V86 | null>(null);\n  const celebrationCloseButtonRef = useRef<HTMLButtonElement | null>(null);\n  const inputLineBufferRef = useRef('');\n  const inputEscapeSequenceRef = useRef(false);\n  const outputEscapeSequenceRef = useRef(false);\n  const lineBufferRef = useRef('');\n  const probeLineBufferRef = useRef('');\n  const autoProbeRef = useRef(autoProbe);\n  const celebratedMissionSetRef = useRef(new Set<string>());\n  const seenCelebrationKeysRef = useRef(new Set<string>());\n  const lastEmulatorOptionsRef = useRef<V86Options | null>(null);\n  const vmInternalBridgeReadyRef = useRef(false);\n  const vmWarmBannerPendingRef = useRef(false);\n  const selectedLessonSlugRef = useRef(selectedLessonSlug);\n  const recordTmuxActivityRef = useRef(recordTmuxActivity);\n  const metricsRef = useRef<VmMetricState>(createInitialMetrics());\n  const shortcutTelemetryStateRef = useRef(createTmuxShortcutTelemetryState());\n  const searchProbeTimerRef = useRef<number | null>(null);\n\n  const lessonParam = searchParams.get('lesson') ?? '';\n  const missionParam = searchParams.get('mission') ?? '';\n  const warmParam = searchParams.get('warm') ?? '';\n  const disableWarmStart = warmParam === '0' || warmParam.toLowerCase() === 'off';\n\n  const content = contentState.content;\n  const trackTitleMap = useMemo(() => {\n    if (!content) {\n      return new Map<string, string>();\n    }\n\n    return new Map(content.tracks.map((track) => [track.slug, track.title]));\n  }, [content]);\n  const chapterTitleMap = useMemo(() => {\n    if (!content) {\n      return new Map<string, string>();\n    }\n\n    return new Map(content.chapters.map((chapter) => [chapter.slug, chapter.title]));\n  }, [content]);\n  const lessonProgressRows = useMemo(() => {\n    if (!content) {\n      return [];\n    }\n\n    return buildLessonProgressRows(content, completedMissionSlugs);\n  }, [completedMissionSlugs, content]);\n  const filteredLessonRows = useMemo(\n    () => filterLessonProgressRows(lessonProgressRows, lessonFilter),\n    [lessonFilter, lessonProgressRows],\n  );\n\n  const lessonMissions = useMemo(() => {\n    if (!content || !selectedLessonSlug) {\n      return [];\n    }\n\n    return content.missions.filter((mission) => mission.lessonSlug === selectedLessonSlug);\n  }, [content, selectedLessonSlug]);\n\n  const selectedMission = useMemo(() => {\n    if (!selectedMissionSlug) {\n      return null;\n    }\n\n    return lessonMissions.find((mission) => mission.slug === selectedMissionSlug) ?? null;\n  }, [lessonMissions, selectedMissionSlug]);\n\n  const vmSnapshot = useMemo(\n    () => ({\n      sessionCount: metrics.sessionCount,\n      windowCount: metrics.windowCount,\n      paneCount: metrics.paneCount,\n      modeIs: metrics.modeIs,\n      sessionName: metrics.sessionName,\n      activeWindowIndex: metrics.activeWindowIndex,\n      windowLayout: metrics.windowLayout,\n      windowZoomed: metrics.windowZoomed,\n      paneSynchronized: metrics.paneSynchronized,\n      searchExecuted: metrics.searchExecuted,\n      searchMatchFound: metrics.searchMatchFound,\n      actionHistory,\n      commandHistory,\n    }),\n    [actionHistory, commandHistory, metrics],\n  );\n\n  const selectedMissionStatus = useMemo(() => {\n    if (!selectedMission) {\n      return null;\n    }\n\n    return evaluateMissionWithVmSnapshot(selectedMission, vmSnapshot);\n  }, [selectedMission, vmSnapshot]);\n\n  const selectedLesson = useMemo(() => {\n    if (!content || !selectedLessonSlug) {\n      return null;\n    }\n\n    return content.lessons.find((lesson) => lesson.slug === selectedLessonSlug) ?? null;\n  }, [content, selectedLessonSlug]);\n\n  const selectedLessonTrack = useMemo(() => {\n    if (!content || !selectedLesson) {\n      return null;\n    }\n\n    return content.tracks.find((track) => track.slug === selectedLesson.trackSlug) ?? null;\n  }, [content, selectedLesson]);\n\n  const selectedLessonChapter = useMemo(() => {\n    if (!content || !selectedLesson) {\n      return null;\n    }\n\n    return content.chapters.find((chapter) => chapter.slug === selectedLesson.chapterSlug) ?? null;\n  }, [content, selectedLesson]);\n\n  const missionStatusMap = useMemo(() => {\n    const result = new Map<string, ReturnType<typeof evaluateMissionWithVmSnapshot>>();\n\n    lessonMissions.forEach((mission) => {\n      result.set(mission.slug, evaluateMissionWithVmSnapshot(mission, vmSnapshot));\n    });\n\n    return result;\n  }, [lessonMissions, vmSnapshot]);\n\n  const lessonCompletedMissionCount = useMemo(() => {\n    const completedSet = new Set(completedMissionSlugs);\n    return lessonMissions.filter((mission) => completedSet.has(mission.slug)).length;\n  }, [completedMissionSlugs, lessonMissions]);\n\n  const manualMissionCandidates = useMemo(() => {\n    return lessonMissions.filter((mission) => missionStatusMap.get(mission.slug)?.status === 'manual');\n  }, [lessonMissions, missionStatusMap]);\n\n  const selectedMissionOrder = useMemo(() => {\n    if (!selectedMission) {\n      return null;\n    }\n\n    const index = lessonMissions.findIndex((mission) => mission.slug === selectedMission.slug);\n    return index === -1 ? null : index + 1;\n  }, [lessonMissions, selectedMission]);\n\n  const nextLesson = useMemo(() => {\n    if (!content || !selectedLesson) {\n      return null;\n    }\n\n    const index = content.lessons.findIndex((lesson) => lesson.slug === selectedLesson.slug);\n    if (index === -1) {\n      return null;\n    }\n\n    return content.lessons[index + 1] ?? null;\n  }, [content, selectedLesson]);\n\n  const selectedMissionCompleted = useMemo(() => {\n    if (!selectedMission) {\n      return false;\n    }\n    return completedMissionSlugs.includes(selectedMission.slug);\n  }, [completedMissionSlugs, selectedMission]);\n  const selectedMissionSession = useMemo(() => {\n    if (!selectedMission) {\n      return null;\n    }\n\n    for (let index = missionSessions.length - 1; index >= 0; index -= 1) {\n      const session = missionSessions[index];\n      if (session.missionSlug === selectedMission.slug) {\n        return session;\n      }\n    }\n\n    return null;\n  }, [missionSessions, selectedMission]);\n\n  const firstIncompleteMissionInLesson = useMemo(() => {\n    return lessonMissions.find((mission) => !completedMissionSlugs.includes(mission.slug)) ?? null;\n  }, [completedMissionSlugs, lessonMissions]);\n\n  const nextIncompleteMission = useMemo(() => {\n    if (!selectedMission) {\n      return firstIncompleteMissionInLesson;\n    }\n\n    const index = lessonMissions.findIndex((mission) => mission.slug === selectedMission.slug);\n    if (index === -1) {\n      return firstIncompleteMissionInLesson;\n    }\n\n    for (let cursor = index + 1; cursor < lessonMissions.length; cursor += 1) {\n      const mission = lessonMissions[cursor];\n      if (!completedMissionSlugs.includes(mission.slug)) {\n        return mission;\n      }\n    }\n\n    if (firstIncompleteMissionInLesson?.slug === selectedMission.slug) {\n      return null;\n    }\n    return firstIncompleteMissionInLesson;\n  }, [completedMissionSlugs, firstIncompleteMissionInLesson, lessonMissions, selectedMission]);\n\n  const lessonCompleted = lessonMissions.length > 0 && lessonCompletedMissionCount === lessonMissions.length;\n\n  const selectLessonForAction = useCallback(\n    (lessonSlug: string, options?: { resetFilter?: boolean }) => {\n      if (!content) {\n        return;\n      }\n\n      if (!content.lessons.some((lesson) => lesson.slug === lessonSlug)) {\n        return;\n      }\n\n      if (options?.resetFilter) {\n        setLessonFilter('all');\n      }\n\n      const nextLessonMissions = content.missions.filter((mission) => mission.lessonSlug === lessonSlug);\n      const nextMissionSlug = resolveDefaultMissionSlugForLesson(nextLessonMissions, completedMissionSlugs);\n      setSelectedLessonSlug(lessonSlug);\n      setSelectedMissionSlug(nextMissionSlug);\n      if (nextMissionSlug) {\n        startMissionSession({\n          missionSlug: nextMissionSlug,\n          lessonSlug,\n        });\n      }\n      setMobileWorkbenchView('mission');\n    },\n    [completedMissionSlugs, content, startMissionSession],\n  );\n\n  const selectMissionForAction = useCallback(\n    (missionSlug: string) => {\n      setSelectedMissionSlug(missionSlug);\n      startMissionSession({\n        missionSlug,\n        lessonSlug: selectedLessonSlugRef.current,\n      });\n      setMobileWorkbenchView('mission');\n    },\n    [startMissionSession],\n  );\n\n  const selectNextLessonForAction = useCallback(() => {\n    if (!content || !nextLesson) {\n      return;\n    }\n\n    setSelectedLessonSlug(nextLesson.slug);\n    const nextLessonMissions = content.missions.filter((mission) => mission.lessonSlug === nextLesson.slug);\n    const nextMissionSlug = resolveDefaultMissionSlugForLesson(nextLessonMissions, completedMissionSlugs);\n    setSelectedMissionSlug(nextMissionSlug);\n    if (nextMissionSlug) {\n      startMissionSession({\n        missionSlug: nextMissionSlug,\n        lessonSlug: nextLesson.slug,\n      });\n    }\n    setMobileWorkbenchView('mission');\n  }, [completedMissionSlugs, content, nextLesson, startMissionSession]);\n\n  const celebration = celebrationState.active;\n  const celebrationQueueCount = celebrationState.queue.length;\n  const isAchievementCelebration = celebration?.kind === 'achievement';\n\n  const enqueueCelebration = useCallback((nextCelebration: CelebrationState) => {\n    if (seenCelebrationKeysRef.current.has(nextCelebration.key)) {\n      return;\n    }\n    seenCelebrationKeysRef.current.add(nextCelebration.key);\n\n    setCelebrationState((previous) => enqueueCompletionFeedback(previous, nextCelebration));\n  }, []);\n\n  const advanceCelebration = useCallback(() => {\n    setCelebrationState((previous) => advanceCompletionFeedback(previous));\n  }, []);\n\n  const announceAchievements = useCallback(\n    (achievementIds: string[]) => {\n      const uniqueIds = Array.from(new Set(achievementIds));\n      const definitions = uniqueIds\n        .map((achievementId) => getAchievementDefinition(achievementId))\n        .filter((definition): definition is NonNullable<ReturnType<typeof getAchievementDefinition>> =>\n          Boolean(definition),\n        );\n\n      if (definitions.length === 0) {\n        return;\n      }\n\n      const unseenDefinitions = definitions.filter(\n        (definition) => !seenCelebrationKeysRef.current.has(`achievement:${definition.id}`),\n      );\n      if (unseenDefinitions.length === 0) {\n        return;\n      }\n\n      if (unseenDefinitions.length === 1) {\n        const definition = unseenDefinitions[0];\n        enqueueCelebration({\n          key: `achievement:${definition.id}`,\n          kind: 'achievement',\n          message: `업적 달성: ${definition.title}`,\n          detail: definition.description,\n          achievementId: definition.id,\n        });\n        return;\n      }\n\n      const batchIds = unseenDefinitions.map((definition) => definition.id);\n      batchIds.forEach((id) => {\n        seenCelebrationKeysRef.current.add(`achievement:${id}`);\n      });\n\n      const preview = unseenDefinitions\n        .slice(0, 3)\n        .map((definition) => definition.title)\n        .join(' · ');\n      const hiddenCount = unseenDefinitions.length - 3;\n\n      enqueueCelebration({\n        key: `achievement-batch:${batchIds.join(',')}`,\n        kind: 'achievement',\n        message: `업적 ${unseenDefinitions.length}개 달성`,\n        detail: hiddenCount > 0 ? `${preview} 외 ${hiddenCount}개` : preview,\n      });\n    },\n    [enqueueCelebration],\n  );\n\n  const celebrationAchievement = useMemo(() => {\n    if (!celebration?.achievementId) {\n      return null;\n    }\n\n    return getAchievementDefinition(celebration.achievementId);\n  }, [celebration?.achievementId]);\n\n  const celebrationShareHref = useMemo(() => {\n    if (!celebrationAchievement) {\n      return null;\n    }\n\n    const shareUrl = buildAbsoluteAchievementShareUrl(celebrationAchievement.id, {\n      level,\n      xp,\n      date: new Date().toISOString().slice(0, 10),\n      badge: celebrationAchievement.id,\n    });\n    const shareText = buildAchievementChallengeShareText(celebrationAchievement.shareText, celebrationAchievement.id);\n    return buildTwitterIntentUrl(shareUrl, shareText);\n  }, [celebrationAchievement, level, xp]);\n\n  useEffect(() => {\n    autoProbeRef.current = autoProbe;\n  }, [autoProbe]);\n\n  useEffect(() => {\n    selectedLessonSlugRef.current = selectedLessonSlug;\n  }, [selectedLessonSlug]);\n\n  useEffect(() => {\n    recordTmuxActivityRef.current = recordTmuxActivity;\n  }, [recordTmuxActivity]);\n\n  useEffect(() => {\n    metricsRef.current = metrics;\n  }, [metrics]);\n\n  useEffect(() => {\n    if (!celebration) {\n      return;\n    }\n\n    if (!isAchievementCelebration) {\n      celebrationCloseButtonRef.current?.focus({ preventScroll: true });\n    }\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key !== 'Escape') {\n        return;\n      }\n\n      event.preventDefault();\n      advanceCelebration();\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [advanceCelebration, celebration, isAchievementCelebration]);\n\n  useEffect(() => {\n    if (!celebration || celebration.kind !== 'achievement') {\n      return;\n    }\n\n    const timer = window.setTimeout(() => {\n      advanceCelebration();\n    }, 4200);\n\n    return () => {\n      window.clearTimeout(timer);\n    };\n  }, [advanceCelebration, celebration]);\n\n  useEffect(() => {\n    if (!celebration || celebration.kind === 'achievement') {\n      return;\n    }\n\n    const previousOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    return () => {\n      document.body.style.overflow = previousOverflow;\n    };\n  }, [celebration]);\n\n  useEffect(() => {\n    let isMounted = true;\n\n    loadAppContent()\n      .then((nextContent) => {\n        if (!isMounted) {\n          return;\n        }\n\n        setContentState({\n          status: 'ready',\n          content: nextContent,\n        });\n      })\n      .catch(() => {\n        if (!isMounted) {\n          return;\n        }\n\n        setContentState({\n          status: 'error',\n          content: null,\n        });\n      });\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!content || selectedLessonSlug) {\n      return;\n    }\n\n    const firstLessonSlug = content.lessons[0]?.slug ?? '';\n    const fromParam = content.lessons.some((lesson) => lesson.slug === lessonParam) ? lessonParam : '';\n    setSelectedLessonSlug(fromParam || firstLessonSlug);\n  }, [content, lessonParam, selectedLessonSlug]);\n\n  useEffect(() => {\n    if (!content || filteredLessonRows.length === 0) {\n      return;\n    }\n\n    if (filteredLessonRows.some((row) => row.lesson.slug === selectedLessonSlug)) {\n      return;\n    }\n\n    const nextLessonSlug = filteredLessonRows[0].lesson.slug;\n    const nextLessonMissions = content.missions.filter((mission) => mission.lessonSlug === nextLessonSlug);\n    setSelectedLessonSlug(nextLessonSlug);\n    setSelectedMissionSlug(resolveDefaultMissionSlugForLesson(nextLessonMissions, completedMissionSlugs));\n  }, [completedMissionSlugs, content, filteredLessonRows, selectedLessonSlug]);\n\n  useEffect(() => {\n    if (!content || !selectedLessonSlug) {\n      return;\n    }\n\n    const missions = content.missions.filter((mission) => mission.lessonSlug === selectedLessonSlug);\n\n    if (missions.length === 0) {\n      if (selectedMissionSlug) {\n        setSelectedMissionSlug('');\n      }\n      return;\n    }\n\n    if (missions.some((mission) => mission.slug === selectedMissionSlug)) {\n      return;\n    }\n\n    const fromParam = missions.some((mission) => mission.slug === missionParam) ? missionParam : '';\n    setSelectedMissionSlug(fromParam || resolveDefaultMissionSlugForLesson(missions, completedMissionSlugs));\n  }, [completedMissionSlugs, content, missionParam, selectedLessonSlug, selectedMissionSlug]);\n\n  useEffect(() => {\n    if (!selectedLessonSlug || !selectedMissionSlug) {\n      return;\n    }\n\n    if (completedMissionSlugs.includes(selectedMissionSlug)) {\n      return;\n    }\n\n    startMissionSession({\n      missionSlug: selectedMissionSlug,\n      lessonSlug: selectedLessonSlug,\n    });\n  }, [completedMissionSlugs, selectedLessonSlug, selectedMissionSlug, startMissionSession]);\n\n  useEffect(() => {\n    if (!selectedLessonSlug) {\n      return;\n    }\n\n    const nextParams = new URLSearchParams(searchParams);\n    let changed = false;\n\n    if (nextParams.get('lesson') !== selectedLessonSlug) {\n      nextParams.set('lesson', selectedLessonSlug);\n      changed = true;\n    }\n\n    if (selectedMissionSlug) {\n      if (nextParams.get('mission') !== selectedMissionSlug) {\n        nextParams.set('mission', selectedMissionSlug);\n        changed = true;\n      }\n    } else if (nextParams.has('mission')) {\n      nextParams.delete('mission');\n      changed = true;\n    }\n\n    if (changed) {\n      setSearchParams(nextParams, { replace: true });\n    }\n  }, [searchParams, selectedLessonSlug, selectedMissionSlug, setSearchParams]);\n\n  const pushDebugLine = useCallback((line: string) => {\n    const normalized = line.trimEnd();\n    if (!normalized) {\n      return;\n    }\n\n    setDebugLines((previous) => trimHistory([...previous, normalized], MAX_DEBUG_LINES));\n  }, []);\n\n  const updateMetricByProbe = useCallback(\n    (metric: VmProbeMetric) => {\n      setVmStatus('running');\n      setVmStatusText('부팅 완료, 명령 입력 가능');\n\n      setMetrics((previous) => {\n        switch (metric.key) {\n          case 'session':\n            return {\n              ...previous,\n              sessionCount: metric.value >= 0 ? metric.value : null,\n            };\n          case 'window':\n            return {\n              ...previous,\n              windowCount: metric.value >= 0 ? metric.value : null,\n            };\n          case 'pane':\n            return {\n              ...previous,\n              paneCount: metric.value >= 0 ? metric.value : null,\n            };\n          case 'mode':\n            return {\n              ...previous,\n              modeIs: metric.value === 1 ? 'COPY_MODE' : null,\n            };\n          case 'sessionName':\n            return {\n              ...previous,\n              sessionName: metric.value.trim() || null,\n            };\n          case 'activeWindow':\n            return {\n              ...previous,\n              activeWindowIndex: metric.value >= 0 ? metric.value : null,\n            };\n          case 'layout':\n            return {\n              ...previous,\n              windowLayout: metric.value.trim() || null,\n            };\n          case 'zoomed':\n            return {\n              ...previous,\n              windowZoomed: metric.value === 1,\n            };\n          case 'sync':\n            return {\n              ...previous,\n              paneSynchronized: metric.value === 1,\n            };\n          case 'search':\n            return {\n              ...previous,\n              searchExecuted: metric.value === 1,\n            };\n          case 'searchMatched':\n            return {\n              ...previous,\n              searchMatchFound: metric.value === 1,\n            };\n          default:\n            return previous;\n        }\n      });\n\n      if (metric.key === 'pane' || metric.key === 'layout' || metric.key === 'zoomed' || metric.key === 'sync') {\n        const nextPaneCount = metric.key === 'pane' ? (metric.value >= 0 ? metric.value : null) : undefined;\n        const nextLayout = metric.key === 'layout' ? metric.value.trim() || null : undefined;\n        const nextZoomed = metric.key === 'zoomed' ? metric.value === 1 : undefined;\n        const nextSynchronized = metric.key === 'sync' ? metric.value === 1 : undefined;\n        const unlocked = recordTmuxActivityRef.current({\n          actions: [],\n          paneCount: nextPaneCount,\n          windowLayout: nextLayout,\n          windowZoomed: nextZoomed,\n          paneSynchronized: nextSynchronized,\n          lessonSlug: selectedLessonSlugRef.current,\n        });\n        if (unlocked.length > 0) {\n          announceAchievements(unlocked);\n        }\n      }\n    },\n    [announceAchievements],\n  );\n\n  const sendInternalCommand = useCallback((command: string) => {\n    const normalized = command.trim();\n    if (!normalized || !emulatorRef.current) {\n      return;\n    }\n\n    emulatorRef.current.serial0_send(`${normalized}\\n`);\n  }, []);\n\n  const requestSearchProbe = useCallback(() => {\n    if (!emulatorRef.current || !vmInternalBridgeReadyRef.current) {\n      return;\n    }\n\n    if (searchProbeTimerRef.current !== null) {\n      window.clearTimeout(searchProbeTimerRef.current);\n    }\n\n    searchProbeTimerRef.current = window.setTimeout(() => {\n      searchProbeTimerRef.current = null;\n      sendInternalCommand(SEARCH_PROBE_TRIGGER_COMMAND);\n    }, 140);\n  }, [sendInternalCommand]);\n\n  const registerCommand = useCallback(\n    (\n      command: string,\n      options?: {\n        source?: 'shell' | 'shortcut';\n        extraActions?: string[];\n      },\n    ) => {\n      const normalizedCommand = command.trim();\n      if (!normalizedCommand) {\n        return;\n      }\n\n      const source = options?.source ?? 'shell';\n      setCommandHistory((previous) => appendHistory(previous, normalizedCommand, MAX_HISTORY));\n\n      const actions = parseTmuxActionsFromCommand(normalizedCommand);\n      if (options?.extraActions && options.extraActions.length > 0) {\n        actions.push(...options.extraActions);\n      }\n      if (source === 'shortcut') {\n        actions.push('sim.shortcut.execute');\n      }\n\n      if (actions.length > 0) {\n        const uniqueActions = Array.from(new Set(actions));\n        setActionHistory((previous) => appendActions(previous, uniqueActions, MAX_HISTORY));\n\n        const unlocked = recordTmuxActivityRef.current({\n          actions: uniqueActions,\n          lessonSlug: selectedLessonSlugRef.current,\n        });\n        if (unlocked.length > 0) {\n          announceAchievements(unlocked);\n        }\n      }\n\n      const lower = normalizedCommand.toLowerCase();\n\n      if (/\\btmux\\s+copy-mode\\b/.test(lower)) {\n        setMetrics((previous) => ({\n          ...previous,\n          modeIs: 'COPY_MODE',\n        }));\n      }\n\n      if (/(search-forward|search-backward|search -)/.test(lower) || /send-keys\\s+.*-x\\s+search/.test(lower)) {\n        setMetrics((previous) => ({\n          ...previous,\n          searchExecuted: true,\n        }));\n        requestSearchProbe();\n      }\n    },\n    [announceAchievements, requestSearchProbe],\n  );\n\n  const completeSelectedMission = useCallback(\n    (mode: 'auto' | 'manual') => {\n      if (!content || !selectedMission || !selectedLesson) {\n        return;\n      }\n\n      const missionSlug = selectedMission.slug;\n      if (completedMissionSlugs.includes(missionSlug)) {\n        return;\n      }\n\n      const previousUnlockedSet = new Set(unlockedAchievements);\n      const nextCompletedMissionSlugs = [...completedMissionSlugs, missionSlug];\n      const completedTrackSlugs = computeCompletedTrackSlugs(content, nextCompletedMissionSlugs);\n\n      const gainedXp = recordMissionPass({\n        missionSlug,\n        difficulty: selectedMission.difficulty,\n        hintLevel: mode === 'manual' ? 1 : 0,\n        attemptNumber: 1,\n        completedTrackSlugs,\n      });\n\n      const completedSetBefore = new Set(completedMissionSlugs);\n      const completedSetAfter = new Set(nextCompletedMissionSlugs);\n      const lessonWasCompleted =\n        lessonMissions.length > 0 && lessonMissions.every((mission) => completedSetBefore.has(mission.slug));\n      const lessonNowCompleted =\n        lessonMissions.length > 0 && lessonMissions.every((mission) => completedSetAfter.has(mission.slug));\n      const lessonJustCompleted = !lessonWasCompleted && lessonNowCompleted;\n\n      if (lessonJustCompleted) {\n        enqueueCelebration({\n          key: `lesson:${selectedLesson.slug}`,\n          kind: 'lesson',\n          message: `레슨 완료: ${selectedLesson.title}`,\n          detail: `${lessonMissions.length}개 미션을 모두 완료했습니다. XP +${gainedXp}`,\n        });\n      } else {\n        enqueueCelebration({\n          key: `mission:${missionSlug}`,\n          kind: 'mission',\n          message: mode === 'manual' ? `수동 완료 처리: ${selectedMission.title}` : `미션 완료: ${selectedMission.title}`,\n          detail: mode === 'manual' ? `수동 브리지 기록 완료, XP +${gainedXp}` : `자동 판정 통과, XP +${gainedXp}`,\n        });\n      }\n\n      const newlyUnlocked = useProgressStore\n        .getState()\n        .unlockedAchievements.filter((achievementId) => !previousUnlockedSet.has(achievementId));\n\n      if (newlyUnlocked.length > 0) {\n        announceAchievements(newlyUnlocked);\n      }\n    },\n    [\n      announceAchievements,\n      completedMissionSlugs,\n      content,\n      enqueueCelebration,\n      lessonMissions,\n      recordMissionPass,\n      selectedLesson,\n      selectedMission,\n      unlockedAchievements,\n    ],\n  );\n\n  const captureInteractiveCommandInput = useCallback(\n    (data: string) => {\n      for (const char of data) {\n        if (inputEscapeSequenceRef.current) {\n          if (char >= '@' && char <= '~') {\n            inputEscapeSequenceRef.current = false;\n          }\n          continue;\n        }\n\n        if (char === '\\u001b') {\n          inputEscapeSequenceRef.current = true;\n          continue;\n        }\n\n        if (char === '\\r' || char === '\\n') {\n          const command = inputLineBufferRef.current.trim();\n          inputLineBufferRef.current = '';\n          if (command) {\n            registerCommand(command, { source: 'shell' });\n          }\n          continue;\n        }\n\n        if (char === '\\u0003' || char === '\\u0004' || char === '\\u0015') {\n          inputLineBufferRef.current = '';\n          continue;\n        }\n\n        if (char === '\\b' || char === String.fromCharCode(127)) {\n          inputLineBufferRef.current = inputLineBufferRef.current.slice(0, -1);\n          continue;\n        }\n\n        if (char >= ' ') {\n          inputLineBufferRef.current += char;\n        }\n      }\n    },\n    [registerCommand],\n  );\n\n  const sendCommand = useCallback(\n    (command: string, options?: { trackCommand?: boolean }) => {\n      const normalized = command.trim();\n      if (!normalized || !emulatorRef.current) {\n        return;\n      }\n\n      emulatorRef.current.serial0_send(`${normalized}\\n`);\n\n      const trackCommand = options?.trackCommand ?? true;\n\n      if (trackCommand) {\n        registerCommand(normalized, { source: 'shell' });\n      }\n    },\n    [registerCommand],\n  );\n\n  useEffect(() => {\n    if (!import.meta.env.DEV) {\n      return undefined;\n    }\n\n    window.__tmuxwebVmBridge = {\n      isReady: () => Boolean(emulatorRef.current),\n      getStatus: () => ({\n        status: vmStatus,\n        text: vmStatusText,\n        metrics,\n        actionHistory,\n        commandHistory,\n        debugLineCount: debugLines.length,\n        lastDebugLine: debugLines.length > 0 ? debugLines[debugLines.length - 1] : null,\n      }),\n      saveState: async () => {\n        const emulator = emulatorRef.current as (V86 & { save_state?: () => Promise<ArrayBuffer> | ArrayBuffer }) | null;\n        if (!emulator || typeof emulator.save_state !== 'function') {\n          return null;\n        }\n\n        const state = await emulator.save_state();\n        return state instanceof ArrayBuffer ? state : null;\n      },\n      sendProbe: () => {\n        sendInternalCommand(PROBE_TRIGGER_COMMAND);\n      },\n      sendCommand: (command: string) => {\n        sendCommand(command);\n      },\n      getBootConfig: () => VM_BOOT_CONFIG,\n      getLastEmulatorOptions: () => lastEmulatorOptionsRef.current,\n    };\n\n    return () => {\n      delete window.__tmuxwebVmBridge;\n    };\n  }, [actionHistory, commandHistory, debugLines, metrics, sendCommand, sendInternalCommand, vmStatus, vmStatusText]);\n\n  useEffect(() => {\n    if (!vmInternalBridgeReadyRef.current || !emulatorRef.current) {\n      return;\n    }\n\n    if (autoProbe) {\n      sendInternalCommand(PROBE_LOOP_START_COMMAND);\n      sendInternalCommand(PROBE_TRIGGER_COMMAND);\n      return;\n    }\n\n    sendInternalCommand(PROBE_LOOP_STOP_COMMAND);\n  }, [autoProbe, sendInternalCommand]);\n\n  useEffect(() => {\n    if (contentState.status !== 'ready') {\n      return undefined;\n    }\n\n    let isMounted = true;\n    let serialListener: ((value?: unknown) => void) | null = null;\n    let serialProbeListener: ((value?: unknown) => void) | null = null;\n    let loadedListener: ((value?: unknown) => void) | null = null;\n    let stopListener: ((value?: unknown) => void) | null = null;\n\n    setVmStatus('booting');\n    setVmStatusText('v86 초기화 중');\n\n    const host = terminalHostRef.current;\n    if (!host) {\n      setVmStatus('error');\n      setVmStatusText('터미널 DOM 초기화 실패');\n      return undefined;\n    }\n\n    const initialMetrics = createInitialMetrics();\n    setMetrics(initialMetrics);\n    metricsRef.current = initialMetrics;\n    setActionHistory([]);\n    setCommandHistory([]);\n    setDebugLines([]);\n    setCelebrationState({ active: null, queue: [] });\n    seenCelebrationKeysRef.current.clear();\n    inputLineBufferRef.current = '';\n    inputEscapeSequenceRef.current = false;\n    outputEscapeSequenceRef.current = false;\n    lineBufferRef.current = '';\n    probeLineBufferRef.current = '';\n    vmInternalBridgeReadyRef.current = false;\n    vmWarmBannerPendingRef.current = false;\n    shortcutTelemetryStateRef.current = createTmuxShortcutTelemetryState();\n    if (searchProbeTimerRef.current !== null) {\n      window.clearTimeout(searchProbeTimerRef.current);\n      searchProbeTimerRef.current = null;\n    }\n\n    const terminal = new Terminal({\n      cursorBlink: true,\n      cols: DEFAULT_TERMINAL_COLS,\n      rows: DEFAULT_TERMINAL_ROWS,\n      fontFamily: 'IBM Plex Mono, ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',\n      fontSize: 14,\n      theme: {\n        background: '#020617',\n        foreground: '#dbeafe',\n        cursor: '#f8fafc',\n      },\n    });\n\n    terminal.open(host);\n    terminal.focus();\n\n    terminalRef.current = terminal;\n\n    const dataDisposable = terminal.onData((data) => {\n      if (!emulatorRef.current) {\n        return;\n      }\n\n      const shortcutTelemetry = parseTmuxShortcutTelemetry(data, shortcutTelemetryStateRef.current, {\n        inCopyMode: metricsRef.current.modeIs === 'COPY_MODE',\n      });\n      shortcutTelemetry.syntheticCommands.forEach((shortcutEvent) => {\n        registerCommand(shortcutEvent.command, {\n          source: 'shortcut',\n          extraActions: [shortcutEvent.shortcutAction],\n        });\n      });\n      if (shortcutTelemetry.shouldProbeSearch) {\n        setMetrics((previous) => ({\n          ...previous,\n          searchExecuted: true,\n        }));\n        requestSearchProbe();\n      }\n\n      captureInteractiveCommandInput(data);\n      emulatorRef.current.serial0_send(data);\n    });\n\n    const writeByte = (value: number) => {\n      terminal.write(Uint8Array.of(value & 0xff));\n\n      const char = String.fromCharCode(value & 0xff);\n\n      if (outputEscapeSequenceRef.current) {\n        if (char >= '@' && char <= '~') {\n          outputEscapeSequenceRef.current = false;\n        }\n        return;\n      }\n\n      if (char === '\\u001b') {\n        outputEscapeSequenceRef.current = true;\n        return;\n      }\n\n      if (char === '\\r') {\n        return;\n      }\n\n      if (char === '\\n') {\n        const completedLine = lineBufferRef.current;\n        lineBufferRef.current = '';\n\n        const probeMetric = parseProbeMetricFromLine(completedLine);\n        if (probeMetric) {\n          updateMetricByProbe(probeMetric);\n          return;\n        }\n\n        pushDebugLine(completedLine);\n\n        const plainLine = stripAnsi(completedLine).replace(/\\r/g, '');\n        const normalizedLine = plainLine.toLowerCase();\n        const hasShellPrompt = /[#$]\\s*$/.test(plainLine.trimEnd());\n        if (normalizedLine.includes('login:') || hasShellPrompt) {\n          setVmStatusText('부팅 완료, 명령 입력 가능');\n          setVmStatus('running');\n        }\n\n        if (hasShellPrompt && !vmInternalBridgeReadyRef.current && emulatorRef.current) {\n          vmInternalBridgeReadyRef.current = true;\n          if (vmWarmBannerPendingRef.current) {\n            sendInternalCommand(BANNER_TRIGGER_COMMAND);\n            vmWarmBannerPendingRef.current = false;\n          }\n          sendInternalCommand(TERMINAL_GEOMETRY_SYNC_COMMAND);\n          if (autoProbeRef.current) {\n            sendInternalCommand(PROBE_LOOP_START_COMMAND);\n          }\n          sendInternalCommand(PROBE_TRIGGER_COMMAND);\n        }\n        return;\n      }\n\n      if (char === '\\b' || char === String.fromCharCode(127)) {\n        lineBufferRef.current = lineBufferRef.current.slice(0, -1);\n        return;\n      }\n\n      if (char >= ' ') {\n        lineBufferRef.current += char;\n      }\n    };\n\n    const writeProbeByte = (value: number) => {\n      const char = String.fromCharCode(value & 0xff);\n      if (char === '\\r') {\n        return;\n      }\n\n      if (char === '\\n') {\n        const completedLine = probeLineBufferRef.current;\n        probeLineBufferRef.current = '';\n        const probeMetric = parseProbeMetricFromLine(completedLine);\n        if (probeMetric) {\n          updateMetricByProbe(probeMetric);\n        }\n        return;\n      }\n\n      if (char >= ' ') {\n        probeLineBufferRef.current += char;\n      }\n    };\n\n    (async () => {\n      try {\n        const module = await import('v86');\n        if (!isMounted) {\n          return;\n        }\n\n        const V86Ctor = module.default;\n        setVmStatusText('VM 시작 이미지 확인 중...');\n\n        const initialState = disableWarmStart ? null : await loadVmInitialState(VM_BOOT_CONFIG.initialStatePath);\n        if (!isMounted) {\n          return;\n        }\n\n        let useWarmStart = Boolean(initialState);\n        if (useWarmStart) {\n          setVmStatusText('빠른 시작 스냅샷 로딩 중...');\n        }\n\n        const baseOptions: V86Options = {\n          wasm_path: VM_BOOT_CONFIG.wasmPath,\n          wasm_fallback_path: VM_BOOT_CONFIG.wasmFallbackPath,\n          memory_size: 256 * 1024 * 1024,\n          vga_memory_size: 8 * 1024 * 1024,\n          bios: { url: VM_BOOT_CONFIG.biosPath },\n          vga_bios: { url: VM_BOOT_CONFIG.vgaBiosPath },\n          filesystem: {\n            basefs: {\n              url: VM_BOOT_CONFIG.fsJsonPath,\n            },\n            baseurl: VM_BOOT_CONFIG.fsBasePath,\n          },\n          bzimage_initrd_from_filesystem: true,\n          cmdline:\n            'rw root=host9p rootfstype=9p rootflags=trans=virtio,cache=loose console=ttyS0 init=/sbin/init quiet loglevel=3',\n          uart1: true,\n          disable_keyboard: true,\n          disable_mouse: true,\n          autostart: true,\n        };\n\n        let emulator: V86;\n        if (useWarmStart) {\n          try {\n            emulator = new V86Ctor({\n              ...baseOptions,\n              initial_state: initialState ?? undefined,\n            });\n          } catch {\n            useWarmStart = false;\n            setVmStatusText('빠른 시작 스냅샷 복원 실패, 일반 부팅으로 전환');\n            emulator = new V86Ctor(baseOptions);\n          }\n        } else {\n          emulator = new V86Ctor(baseOptions);\n        }\n\n        lastEmulatorOptionsRef.current = {\n          ...baseOptions,\n          ...(useWarmStart ? { initial_state: initialState ?? undefined } : {}),\n        };\n        vmWarmBannerPendingRef.current = useWarmStart;\n\n        emulatorRef.current = emulator;\n\n        loadedListener = () => {\n          setVmStatusText(useWarmStart ? '빠른 시작 스냅샷 복원 완료' : '커널 및 루트FS 로딩 완료');\n        };\n\n        stopListener = () => {\n          setVmStatus('stopped');\n          setVmStatusText('VM이 중지되었습니다');\n        };\n\n        serialListener = (value) => {\n          if (typeof value !== 'number') {\n            return;\n          }\n          writeByte(value);\n        };\n\n        serialProbeListener = (value) => {\n          if (typeof value !== 'number') {\n            return;\n          }\n          writeProbeByte(value);\n        };\n\n        emulator.add_listener('emulator-loaded', loadedListener);\n        emulator.add_listener('emulator-stopped', stopListener);\n        emulator.add_listener('serial0-output-byte', serialListener);\n        emulator.add_listener('serial1-output-byte', serialProbeListener);\n\n        setVmStatus('booting');\n        setVmStatusText('VM 부팅 중...');\n\n        const probeBootstrapDelayMs = useWarmStart ? 700 : 2600;\n        window.setTimeout(() => {\n          if (!emulatorRef.current) {\n            return;\n          }\n          emulatorRef.current.serial0_send('\\n');\n          if (useWarmStart) {\n            window.setTimeout(() => {\n              if (!emulatorRef.current) {\n                return;\n              }\n              sendInternalCommand(BANNER_TRIGGER_COMMAND);\n              sendInternalCommand(TERMINAL_GEOMETRY_SYNC_COMMAND);\n              if (autoProbeRef.current) {\n                sendInternalCommand(PROBE_LOOP_START_COMMAND);\n              }\n              sendInternalCommand(PROBE_TRIGGER_COMMAND);\n              vmInternalBridgeReadyRef.current = true;\n              vmWarmBannerPendingRef.current = false;\n            }, 180);\n          }\n        }, probeBootstrapDelayMs);\n      } catch {\n        setVmStatus('error');\n        setVmStatusText('v86 초기화 실패 (bios/wasm 경로 확인 필요)');\n      }\n    })();\n\n    return () => {\n      isMounted = false;\n\n      inputLineBufferRef.current = '';\n      inputEscapeSequenceRef.current = false;\n      outputEscapeSequenceRef.current = false;\n      probeLineBufferRef.current = '';\n      shortcutTelemetryStateRef.current = createTmuxShortcutTelemetryState();\n      if (searchProbeTimerRef.current !== null) {\n        window.clearTimeout(searchProbeTimerRef.current);\n        searchProbeTimerRef.current = null;\n      }\n\n      dataDisposable.dispose();\n\n      if (terminalRef.current) {\n        terminalRef.current.dispose();\n        terminalRef.current = null;\n      }\n\n      const emulator = emulatorRef.current;\n      emulatorRef.current = null;\n\n      if (emulator) {\n        if (loadedListener) {\n          emulator.remove_listener('emulator-loaded', loadedListener);\n        }\n        if (stopListener) {\n          emulator.remove_listener('emulator-stopped', stopListener);\n        }\n        if (serialListener) {\n          emulator.remove_listener('serial0-output-byte', serialListener);\n        }\n        if (serialProbeListener) {\n          emulator.remove_listener('serial1-output-byte', serialProbeListener);\n        }\n\n        void Promise.resolve(emulator.stop()).catch(() => undefined);\n        void Promise.resolve(emulator.destroy()).catch(() => undefined);\n      }\n    };\n  }, [\n    captureInteractiveCommandInput,\n    contentState.status,\n    disableWarmStart,\n    pushDebugLine,\n    registerCommand,\n    requestSearchProbe,\n    sendInternalCommand,\n    updateMetricByProbe,\n    vmEpoch,\n  ]);\n\n  useEffect(() => {\n    if (!content || !selectedMission || !selectedMissionStatus) {\n      return;\n    }\n\n    const missionSlug = selectedMission.slug;\n\n    if (selectedMissionStatus.status !== 'complete') {\n      return;\n    }\n\n    if (celebratedMissionSetRef.current.has(missionSlug)) {\n      return;\n    }\n\n    if (completedMissionSlugs.includes(missionSlug)) {\n      celebratedMissionSetRef.current.add(missionSlug);\n      return;\n    }\n\n    celebratedMissionSetRef.current.add(missionSlug);\n\n    completeSelectedMission('auto');\n  }, [\n    completeSelectedMission,\n    completedMissionSlugs,\n    content,\n    selectedMission,\n    selectedMissionStatus,\n  ]);\n\n  const handleManualMissionComplete = useCallback(() => {\n    if (!selectedMission) {\n      return;\n    }\n\n    const missionSlug = selectedMission.slug;\n    if (completedMissionSlugs.includes(missionSlug)) {\n      return;\n    }\n\n    celebratedMissionSetRef.current.add(missionSlug);\n    completeSelectedMission('manual');\n  }, [completeSelectedMission, completedMissionSlugs, selectedMission]);\n\n  const lessonObjectivePreview = selectedLesson?.objectives.slice(0, 3) ?? [];\n  const hiddenObjectiveCount = selectedLesson\n    ? Math.max(selectedLesson.objectives.length - lessonObjectivePreview.length, 0)\n    : 0;\n  const lessonSuccessCriteriaPreview = selectedLesson?.successCriteria?.slice(0, 1) ?? [];\n  const hiddenSuccessCriteriaCount = selectedLesson\n    ? Math.max((selectedLesson.successCriteria?.length ?? 0) - lessonSuccessCriteriaPreview.length, 0)\n    : 0;\n  const lessonFailureStatePreview = selectedLesson?.failureStates?.slice(0, 1) ?? [];\n  const hiddenFailureStateCount = selectedLesson\n    ? Math.max((selectedLesson.failureStates?.length ?? 0) - lessonFailureStatePreview.length, 0)\n    : 0;\n  const missionHintPreview = selectedMission?.hints.slice(0, 2) ?? [];\n  const hiddenMissionHintCount = selectedMission\n    ? Math.max(selectedMission.hints.length - missionHintPreview.length, 0)\n    : 0;\n  const selectedMissionCommands = useMemo(() => buildMissionCommandSuggestions(selectedMission), [selectedMission]);\n  const selectedMissionPreconditions = useMemo(\n    () => buildMissionPreconditionItems(selectedMission, vmSnapshot),\n    [selectedMission, vmSnapshot],\n  );\n\n  if (contentState.status === 'loading') {\n    return (\n      <PagePlaceholder\n        eyebrow=": "미확인`;\n    }\n    default:\n      return '현재 상태 측정값 없음';\n  }\n}\n\nfunction getInitialScenarioLabel(initialScenario: string) {\n  switch (initialScenario) {\n    case 'single-pane':\n      return '초기 시나리오: 단일 pane에서 시작';\n    case 'log-buffer':\n      return '초기 시나리오: 로그 버퍼가 준비된 pane에서 시작';\n    default:\n      return `초기 시나리오: ${initialScenario}`;\n  }\n}\n\nfunction buildMissionPreconditionItems(mission: AppMission | null, snapshot: VmBridgeSnapshot): MissionPreconditionItem[] {\n  if (!mission) {\n    return [];\n  }\n\n  const ruleItems = mission.passRules.map<MissionPreconditionItem>((rule, index) => {\n    const actual = getRuleMetricValue(snapshot, rule.kind);\n    const satisfied = actual !== null && actual !== undefined && evaluateRuleOperator(actual, rule.operator, rule.value);\n\n    return {\n      key: `${rule.kind}-${index}`,\n      label: getRulePreconditionLabel(rule),\n      current: getRuleCurrentStateText(rule, snapshot),\n      satisfied,\n    };\n  });\n\n  return [\n    {\n      key: 'initial-scenario',\n      label: getInitialScenarioLabel(mission.initialScenario),\n      current: '미션 진입 시 자동 적용',\n      satisfied: true,\n    },\n    ...ruleItems,\n  ];\n}\n\nfunction computeCompletedTrackSlugs(content: AppContent, completedMissionSlugs: string[]) {\n  const completedSet = new Set(completedMissionSlugs);\n  const lessonTrackMap = new Map(content.lessons.map((lesson) => [lesson.slug, lesson.trackSlug]));\n\n  return content.tracks\n    .filter((track) => {\n      const trackMissionSlugs = content.missions\n        .filter((mission) => lessonTrackMap.get(mission.lessonSlug) === track.slug)\n        .map((mission) => mission.slug);\n\n      if (trackMissionSlugs.length === 0) {\n        return false;\n      }\n\n      return trackMissionSlugs.every((slug) => completedSet.has(slug));\n    })\n    .map((track) => track.slug);\n}\n\nfunction createInitialMetrics(): VmMetricState {\n  return {\n    sessionCount: null,\n    windowCount: null,\n    paneCount: null,\n    modeIs: null,\n    sessionName: null,\n    activeWindowIndex: null,\n    windowLayout: null,\n    windowZoomed: null,\n    paneSynchronized: null,\n    searchExecuted: null,\n    searchMatchFound: null,\n  };\n}\n\nfunction formatLayout(layout: string | null) {\n  if (!layout) {\n    return '-';\n  }\n\n  if (layout.length <= 28) {\n    return layout;\n  }\n\n  return `${layout.slice(0, 28)}...`;\n}\n\nfunction formatSessionDateTime(iso: string | null) {\n  if (!iso) {\n    return '-';\n  }\n\n  const date = new Date(iso);\n  if (Number.isNaN(date.getTime())) {\n    return '-';\n  }\n\n  return date.toLocaleString('ko-KR', {\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n}\n\nfunction getLessonStatusLabel(status: LessonCompletionStatus) {\n  switch (status) {\n    case 'completed':\n      return '완료';\n    case 'in-progress':\n      return '진행중';\n    case 'not-started':\n    default:\n      return '미시작';\n  }\n}\n\nfunction getLessonStatusClass(status: LessonCompletionStatus) {\n  switch (status) {\n    case 'completed':\n      return 'is-complete';\n    case 'in-progress':\n      return 'is-in-progress';\n    case 'not-started':\n    default:\n      return 'is-not-started';\n  }\n}\n\nfunction getCelebrationKindLabel(kind: CelebrationState['kind']) {\n  switch (kind) {\n    case 'mission':\n      return 'Mission Complete';\n    case 'lesson':\n      return 'Lesson Complete';\n    case 'achievement':\n      return 'Achievement';\n    default:\n      return 'Update';\n  }\n}\n\nexport function PracticeVmPocPage() {\n  const [searchParams, setSearchParams] = useSearchParams();\n  const [contentState, setContentState] = useState<{\n    status: 'loading' | 'ready' | 'error';\n    content: AppContent | null;\n  }>({\n    status: 'loading',\n    content: null,\n  });\n\n  const [selectedLessonSlug, setSelectedLessonSlug] = useState('');\n  const [selectedMissionSlug, setSelectedMissionSlug] = useState('');\n  const [vmEpoch, setVmEpoch] = useState(0);\n  const [vmStatus, setVmStatus] = useState<VmStatus>('idle');\n  const [vmStatusText, setVmStatusText] = useState('대기 중');\n  const [commandInput, setCommandInput] = useState('tmux list-sessions');\n  const [debugLines, setDebugLines] = useState<string[]>([]);\n  const [actionHistory, setActionHistory] = useState<string[]>([]);\n  const [commandHistory, setCommandHistory] = useState<string[]>([]);\n  const [metrics, setMetrics] = useState<VmMetricState>(createInitialMetrics());\n  const [celebrationState, setCelebrationState] = useState<CelebrationQueueState>({\n    active: null,\n    queue: [],\n  });\n  const [autoProbe, setAutoProbe] = useState(true);\n  const [lessonFilter, setLessonFilter] = useState<LessonFilter>('all');\n  const [mobileWorkbenchView, setMobileWorkbenchView] = useState<'mission' | 'terminal'>('terminal');\n\n  const completedMissionSlugs = useProgressStore((store) => store.completedMissionSlugs);\n  const level = useProgressStore((store) => store.level);\n  const xp = useProgressStore((store) => store.xp);\n  const unlockedAchievements = useProgressStore((store) => store.unlockedAchievements);\n  const missionSessions = useProgressStore((store) => store.missionSessions);\n  const recordMissionPass = useProgressStore((store) => store.recordMissionPass);\n  const recordTmuxActivity = useProgressStore((store) => store.recordTmuxActivity);\n  const startMissionSession = useProgressStore((store) => store.startMissionSession);\n\n  const terminalHostRef = useRef<HTMLDivElement | null>(null);\n  const terminalRef = useRef<Terminal | null>(null);\n  const emulatorRef = useRef<V86 | null>(null);\n  const celebrationCloseButtonRef = useRef<HTMLButtonElement | null>(null);\n  const inputLineBufferRef = useRef('');\n  const inputEscapeSequenceRef = useRef(false);\n  const outputEscapeSequenceRef = useRef(false);\n  const lineBufferRef = useRef('');\n  const probeLineBufferRef = useRef('');\n  const autoProbeRef = useRef(autoProbe);\n  const celebratedMissionSetRef = useRef(new Set<string>());\n  const seenCelebrationKeysRef = useRef(new Set<string>());\n  const lastEmulatorOptionsRef = useRef<V86Options | null>(null);\n  const vmInternalBridgeReadyRef = useRef(false);\n  const vmWarmBannerPendingRef = useRef(false);\n  const selectedLessonSlugRef = useRef(selectedLessonSlug);\n  const recordTmuxActivityRef = useRef(recordTmuxActivity);\n  const metricsRef = useRef<VmMetricState>(createInitialMetrics());\n  const shortcutTelemetryStateRef = useRef(createTmuxShortcutTelemetryState());\n  const searchProbeTimerRef = useRef<number | null>(null);\n\n  const lessonParam = searchParams.get('lesson') ?? '';\n  const missionParam = searchParams.get('mission') ?? '';\n  const warmParam = searchParams.get('warm') ?? '';\n  const disableWarmStart = warmParam === '0' || warmParam.toLowerCase() === 'off';\n\n  const content = contentState.content;\n  const trackTitleMap = useMemo(() => {\n    if (!content) {\n      return new Map<string, string>();\n    }\n\n    return new Map(content.tracks.map((track) => [track.slug, track.title]));\n  }, [content]);\n  const chapterTitleMap = useMemo(() => {\n    if (!content) {\n      return new Map<string, string>();\n    }\n\n    return new Map(content.chapters.map((chapter) => [chapter.slug, chapter.title]));\n  }, [content]);\n  const lessonProgressRows = useMemo(() => {\n    if (!content) {\n      return [];\n    }\n\n    return buildLessonProgressRows(content, completedMissionSlugs);\n  }, [completedMissionSlugs, content]);\n  const filteredLessonRows = useMemo(\n    () => filterLessonProgressRows(lessonProgressRows, lessonFilter),\n    [lessonFilter, lessonProgressRows],\n  );\n\n  const lessonMissions = useMemo(() => {\n    if (!content || !selectedLessonSlug) {\n      return [];\n    }\n\n    return content.missions.filter((mission) => mission.lessonSlug === selectedLessonSlug);\n  }, [content, selectedLessonSlug]);\n\n  const selectedMission = useMemo(() => {\n    if (!selectedMissionSlug) {\n      return null;\n    }\n\n    return lessonMissions.find((mission) => mission.slug === selectedMissionSlug) ?? null;\n  }, [lessonMissions, selectedMissionSlug]);\n\n  const vmSnapshot = useMemo(\n    () => ({\n      sessionCount: metrics.sessionCount,\n      windowCount: metrics.windowCount,\n      paneCount: metrics.paneCount,\n      modeIs: metrics.modeIs,\n      sessionName: metrics.sessionName,\n      activeWindowIndex: metrics.activeWindowIndex,\n      windowLayout: metrics.windowLayout,\n      windowZoomed: metrics.windowZoomed,\n      paneSynchronized: metrics.paneSynchronized,\n      searchExecuted: metrics.searchExecuted,\n      searchMatchFound: metrics.searchMatchFound,\n      actionHistory,\n      commandHistory,\n    }),\n    [actionHistory, commandHistory, metrics],\n  );\n\n  const selectedMissionStatus = useMemo(() => {\n    if (!selectedMission) {\n      return null;\n    }\n\n    return evaluateMissionWithVmSnapshot(selectedMission, vmSnapshot);\n  }, [selectedMission, vmSnapshot]);\n\n  const selectedLesson = useMemo(() => {\n    if (!content || !selectedLessonSlug) {\n      return null;\n    }\n\n    return content.lessons.find((lesson) => lesson.slug === selectedLessonSlug) ?? null;\n  }, [content, selectedLessonSlug]);\n\n  const selectedLessonTrack = useMemo(() => {\n    if (!content || !selectedLesson) {\n      return null;\n    }\n\n    return content.tracks.find((track) => track.slug === selectedLesson.trackSlug) ?? null;\n  }, [content, selectedLesson]);\n\n  const selectedLessonChapter = useMemo(() => {\n    if (!content || !selectedLesson) {\n      return null;\n    }\n\n    return content.chapters.find((chapter) => chapter.slug === selectedLesson.chapterSlug) ?? null;\n  }, [content, selectedLesson]);\n\n  const missionStatusMap = useMemo(() => {\n    const result = new Map<string, ReturnType<typeof evaluateMissionWithVmSnapshot>>();\n\n    lessonMissions.forEach((mission) => {\n      result.set(mission.slug, evaluateMissionWithVmSnapshot(mission, vmSnapshot));\n    });\n\n    return result;\n  }, [lessonMissions, vmSnapshot]);\n\n  const lessonCompletedMissionCount = useMemo(() => {\n    const completedSet = new Set(completedMissionSlugs);\n    return lessonMissions.filter((mission) => completedSet.has(mission.slug)).length;\n  }, [completedMissionSlugs, lessonMissions]);\n\n  const manualMissionCandidates = useMemo(() => {\n    return lessonMissions.filter((mission) => missionStatusMap.get(mission.slug)?.status === 'manual');\n  }, [lessonMissions, missionStatusMap]);\n\n  const selectedMissionOrder = useMemo(() => {\n    if (!selectedMission) {\n      return null;\n    }\n\n    const index = lessonMissions.findIndex((mission) => mission.slug === selectedMission.slug);\n    return index === -1 ? null : index + 1;\n  }, [lessonMissions, selectedMission]);\n\n  const nextLesson = useMemo(() => {\n    if (!content || !selectedLesson) {\n      return null;\n    }\n\n    const index = content.lessons.findIndex((lesson) => lesson.slug === selectedLesson.slug);\n    if (index === -1) {\n      return null;\n    }\n\n    return content.lessons[index + 1] ?? null;\n  }, [content, selectedLesson]);\n\n  const selectedMissionCompleted = useMemo(() => {\n    if (!selectedMission) {\n      return false;\n    }\n    return completedMissionSlugs.includes(selectedMission.slug);\n  }, [completedMissionSlugs, selectedMission]);\n  const selectedMissionSession = useMemo(() => {\n    if (!selectedMission) {\n      return null;\n    }\n\n    for (let index = missionSessions.length - 1; index >= 0; index -= 1) {\n      const session = missionSessions[index];\n      if (session.missionSlug === selectedMission.slug) {\n        return session;\n      }\n    }\n\n    return null;\n  }, [missionSessions, selectedMission]);\n\n  const firstIncompleteMissionInLesson = useMemo(() => {\n    return lessonMissions.find((mission) => !completedMissionSlugs.includes(mission.slug)) ?? null;\n  }, [completedMissionSlugs, lessonMissions]);\n\n  const nextIncompleteMission = useMemo(() => {\n    if (!selectedMission) {\n      return firstIncompleteMissionInLesson;\n    }\n\n    const index = lessonMissions.findIndex((mission) => mission.slug === selectedMission.slug);\n    if (index === -1) {\n      return firstIncompleteMissionInLesson;\n    }\n\n    for (let cursor = index + 1; cursor < lessonMissions.length; cursor += 1) {\n      const mission = lessonMissions[cursor];\n      if (!completedMissionSlugs.includes(mission.slug)) {\n        return mission;\n      }\n    }\n\n    if (firstIncompleteMissionInLesson?.slug === selectedMission.slug) {\n      return null;\n    }\n    return firstIncompleteMissionInLesson;\n  }, [completedMissionSlugs, firstIncompleteMissionInLesson, lessonMissions, selectedMission]);\n\n  const lessonCompleted = lessonMissions.length > 0 && lessonCompletedMissionCount === lessonMissions.length;\n\n  const selectLessonForAction = useCallback(\n    (lessonSlug: string, options?: { resetFilter?: boolean }) => {\n      if (!content) {\n        return;\n      }\n\n      if (!content.lessons.some((lesson) => lesson.slug === lessonSlug)) {\n        return;\n      }\n\n      if (options?.resetFilter) {\n        setLessonFilter('all');\n      }\n\n      const nextLessonMissions = content.missions.filter((mission) => mission.lessonSlug === lessonSlug);\n      const nextMissionSlug = resolveDefaultMissionSlugForLesson(nextLessonMissions, completedMissionSlugs);\n      setSelectedLessonSlug(lessonSlug);\n      setSelectedMissionSlug(nextMissionSlug);\n      if (nextMissionSlug) {\n        startMissionSession({\n          missionSlug: nextMissionSlug,\n          lessonSlug,\n        });\n      }\n      setMobileWorkbenchView('mission');\n    },\n    [completedMissionSlugs, content, startMissionSession],\n  );\n\n  const selectMissionForAction = useCallback(\n    (missionSlug: string) => {\n      setSelectedMissionSlug(missionSlug);\n      startMissionSession({\n        missionSlug,\n        lessonSlug: selectedLessonSlugRef.current,\n      });\n      setMobileWorkbenchView('mission');\n    },\n    [startMissionSession],\n  );\n\n  const selectNextLessonForAction = useCallback(() => {\n    if (!content || !nextLesson) {\n      return;\n    }\n\n    setSelectedLessonSlug(nextLesson.slug);\n    const nextLessonMissions = content.missions.filter((mission) => mission.lessonSlug === nextLesson.slug);\n    const nextMissionSlug = resolveDefaultMissionSlugForLesson(nextLessonMissions, completedMissionSlugs);\n    setSelectedMissionSlug(nextMissionSlug);\n    if (nextMissionSlug) {\n      startMissionSession({\n        missionSlug: nextMissionSlug,\n        lessonSlug: nextLesson.slug,\n      });\n    }\n    setMobileWorkbenchView('mission');\n  }, [completedMissionSlugs, content, nextLesson, startMissionSession]);\n\n  const celebration = celebrationState.active;\n  const celebrationQueueCount = celebrationState.queue.length;\n  const isAchievementCelebration = celebration?.kind === 'achievement';\n\n  const enqueueCelebration = useCallback((nextCelebration: CelebrationState) => {\n    if (seenCelebrationKeysRef.current.has(nextCelebration.key)) {\n      return;\n    }\n    seenCelebrationKeysRef.current.add(nextCelebration.key);\n\n    setCelebrationState((previous) => enqueueCompletionFeedback(previous, nextCelebration));\n  }, []);\n\n  const advanceCelebration = useCallback(() => {\n    setCelebrationState((previous) => advanceCompletionFeedback(previous));\n  }, []);\n\n  const announceAchievements = useCallback(\n    (achievementIds: string[]) => {\n      const uniqueIds = Array.from(new Set(achievementIds));\n      const definitions = uniqueIds\n        .map((achievementId) => getAchievementDefinition(achievementId))\n        .filter((definition): definition is NonNullable<ReturnType<typeof getAchievementDefinition>> =>\n          Boolean(definition),\n        );\n\n      if (definitions.length === 0) {\n        return;\n      }\n\n      const unseenDefinitions = definitions.filter(\n        (definition) => !seenCelebrationKeysRef.current.has(`achievement:${definition.id}`),\n      );\n      if (unseenDefinitions.length === 0) {\n        return;\n      }\n\n      if (unseenDefinitions.length === 1) {\n        const definition = unseenDefinitions[0];\n        enqueueCelebration({\n          key: `achievement:${definition.id}`,\n          kind: 'achievement',\n          message: `업적 달성: ${definition.title}`,\n          detail: definition.description,\n          achievementId: definition.id,\n        });\n        return;\n      }\n\n      const batchIds = unseenDefinitions.map((definition) => definition.id);\n      batchIds.forEach((id) => {\n        seenCelebrationKeysRef.current.add(`achievement:${id}`);\n      });\n\n      const preview = unseenDefinitions\n        .slice(0, 3)\n        .map((definition) => definition.title)\n        .join(' · ');\n      const hiddenCount = unseenDefinitions.length - 3;\n\n      enqueueCelebration({\n        key: `achievement-batch:${batchIds.join(',')}`,\n        kind: 'achievement',\n        message: `업적 ${unseenDefinitions.length}개 달성`,\n        detail: hiddenCount > 0 ? `${preview} 외 ${hiddenCount}개` : preview,\n      });\n    },\n    [enqueueCelebration],\n  );\n\n  const celebrationAchievement = useMemo(() => {\n    if (!celebration?.achievementId) {\n      return null;\n    }\n\n    return getAchievementDefinition(celebration.achievementId);\n  }, [celebration?.achievementId]);\n\n  const celebrationShareHref = useMemo(() => {\n    if (!celebrationAchievement) {\n      return null;\n    }\n\n    const shareUrl = buildAbsoluteAchievementShareUrl(celebrationAchievement.id, {\n      level,\n      xp,\n      date: new Date().toISOString().slice(0, 10),\n      badge: celebrationAchievement.id,\n    });\n    const shareText = buildAchievementChallengeShareText(celebrationAchievement.shareText, celebrationAchievement.id);\n    return buildTwitterIntentUrl(shareUrl, shareText);\n  }, [celebrationAchievement, level, xp]);\n\n  useEffect(() => {\n    autoProbeRef.current = autoProbe;\n  }, [autoProbe]);\n\n  useEffect(() => {\n    selectedLessonSlugRef.current = selectedLessonSlug;\n  }, [selectedLessonSlug]);\n\n  useEffect(() => {\n    recordTmuxActivityRef.current = recordTmuxActivity;\n  }, [recordTmuxActivity]);\n\n  useEffect(() => {\n    metricsRef.current = metrics;\n  }, [metrics]);\n\n  useEffect(() => {\n    if (!celebration) {\n      return;\n    }\n\n    if (!isAchievementCelebration) {\n      celebrationCloseButtonRef.current?.focus({ preventScroll: true });\n    }\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key !== 'Escape') {\n        return;\n      }\n\n      event.preventDefault();\n      advanceCelebration();\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [advanceCelebration, celebration, isAchievementCelebration]);\n\n  useEffect(() => {\n    if (!celebration || celebration.kind !== 'achievement') {\n      return;\n    }\n\n    const timer = window.setTimeout(() => {\n      advanceCelebration();\n    }, 4200);\n\n    return () => {\n      window.clearTimeout(timer);\n    };\n  }, [advanceCelebration, celebration]);\n\n  useEffect(() => {\n    if (!celebration || celebration.kind === 'achievement') {\n      return;\n    }\n\n    const previousOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    return () => {\n      document.body.style.overflow = previousOverflow;\n    };\n  }, [celebration]);\n\n  useEffect(() => {\n    let isMounted = true;\n\n    loadAppContent()\n      .then((nextContent) => {\n        if (!isMounted) {\n          return;\n        }\n\n        setContentState({\n          status: 'ready',\n          content: nextContent,\n        });\n      })\n      .catch(() => {\n        if (!isMounted) {\n          return;\n        }\n\n        setContentState({\n          status: 'error',\n          content: null,\n        });\n      });\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!content || selectedLessonSlug) {\n      return;\n    }\n\n    const firstLessonSlug = content.lessons[0]?.slug ?? '';\n    const fromParam = content.lessons.some((lesson) => lesson.slug === lessonParam) ? lessonParam : '';\n    setSelectedLessonSlug(fromParam || firstLessonSlug);\n  }, [content, lessonParam, selectedLessonSlug]);\n\n  useEffect(() => {\n    if (!content || filteredLessonRows.length === 0) {\n      return;\n    }\n\n    if (filteredLessonRows.some((row) => row.lesson.slug === selectedLessonSlug)) {\n      return;\n    }\n\n    const nextLessonSlug = filteredLessonRows[0].lesson.slug;\n    const nextLessonMissions = content.missions.filter((mission) => mission.lessonSlug === nextLessonSlug);\n    setSelectedLessonSlug(nextLessonSlug);\n    setSelectedMissionSlug(resolveDefaultMissionSlugForLesson(nextLessonMissions, completedMissionSlugs));\n  }, [completedMissionSlugs, content, filteredLessonRows, selectedLessonSlug]);\n\n  useEffect(() => {\n    if (!content || !selectedLessonSlug) {\n      return;\n    }\n\n    const missions = content.missions.filter((mission) => mission.lessonSlug === selectedLessonSlug);\n\n    if (missions.length === 0) {\n      if (selectedMissionSlug) {\n        setSelectedMissionSlug('');\n      }\n      return;\n    }\n\n    if (missions.some((mission) => mission.slug === selectedMissionSlug)) {\n      return;\n    }\n\n    const fromParam = missions.some((mission) => mission.slug === missionParam) ? missionParam : '';\n    setSelectedMissionSlug(fromParam || resolveDefaultMissionSlugForLesson(missions, completedMissionSlugs));\n  }, [completedMissionSlugs, content, missionParam, selectedLessonSlug, selectedMissionSlug]);\n\n  useEffect(() => {\n    if (!selectedLessonSlug || !selectedMissionSlug) {\n      return;\n    }\n\n    if (completedMissionSlugs.includes(selectedMissionSlug)) {\n      return;\n    }\n\n    startMissionSession({\n      missionSlug: selectedMissionSlug,\n      lessonSlug: selectedLessonSlug,\n    });\n  }, [completedMissionSlugs, selectedLessonSlug, selectedMissionSlug, startMissionSession]);\n\n  useEffect(() => {\n    if (!selectedLessonSlug) {\n      return;\n    }\n\n    const nextParams = new URLSearchParams(searchParams);\n    let changed = false;\n\n    if (nextParams.get('lesson') !== selectedLessonSlug) {\n      nextParams.set('lesson', selectedLessonSlug);\n      changed = true;\n    }\n\n    if (selectedMissionSlug) {\n      if (nextParams.get('mission') !== selectedMissionSlug) {\n        nextParams.set('mission', selectedMissionSlug);\n        changed = true;\n      }\n    } else if (nextParams.has('mission')) {\n      nextParams.delete('mission');\n      changed = true;\n    }\n\n    if (changed) {\n      setSearchParams(nextParams, { replace: true });\n    }\n  }, [searchParams, selectedLessonSlug, selectedMissionSlug, setSearchParams]);\n\n  const pushDebugLine = useCallback((line: string) => {\n    const normalized = line.trimEnd();\n    if (!normalized) {\n      return;\n    }\n\n    setDebugLines((previous) => trimHistory([...previous, normalized], MAX_DEBUG_LINES));\n  }, []);\n\n  const updateMetricByProbe = useCallback(\n    (metric: VmProbeMetric) => {\n      setVmStatus('running');\n      setVmStatusText('부팅 완료, 명령 입력 가능');\n\n      setMetrics((previous) => {\n        switch (metric.key) {\n          case 'session':\n            return {\n              ...previous,\n              sessionCount: metric.value >= 0 ? metric.value : null,\n            };\n          case 'window':\n            return {\n              ...previous,\n              windowCount: metric.value >= 0 ? metric.value : null,\n            };\n          case 'pane':\n            return {\n              ...previous,\n              paneCount: metric.value >= 0 ? metric.value : null,\n            };\n          case 'mode':\n            return {\n              ...previous,\n              modeIs: metric.value === 1 ? 'COPY_MODE' : null,\n            };\n          case 'sessionName':\n            return {\n              ...previous,\n              sessionName: metric.value.trim() || null,\n            };\n          case 'activeWindow':\n            return {\n              ...previous,\n              activeWindowIndex: metric.value >= 0 ? metric.value : null,\n            };\n          case 'layout':\n            return {\n              ...previous,\n              windowLayout: metric.value.trim() || null,\n            };\n          case 'zoomed':\n            return {\n              ...previous,\n              windowZoomed: metric.value === 1,\n            };\n          case 'sync':\n            return {\n              ...previous,\n              paneSynchronized: metric.value === 1,\n            };\n          case 'search':\n            return {\n              ...previous,\n              searchExecuted: metric.value === 1,\n            };\n          case 'searchMatched':\n            return {\n              ...previous,\n              searchMatchFound: metric.value === 1,\n            };\n          default:\n            return previous;\n        }\n      });\n\n      if (metric.key === 'pane' || metric.key === 'layout' || metric.key === 'zoomed' || metric.key === 'sync') {\n        const nextPaneCount = metric.key === 'pane' ? (metric.value >= 0 ? metric.value : null) : undefined;\n        const nextLayout = metric.key === 'layout' ? metric.value.trim() || null : undefined;\n        const nextZoomed = metric.key === 'zoomed' ? metric.value === 1 : undefined;\n        const nextSynchronized = metric.key === 'sync' ? metric.value === 1 : undefined;\n        const unlocked = recordTmuxActivityRef.current({\n          actions: [],\n          paneCount: nextPaneCount,\n          windowLayout: nextLayout,\n          windowZoomed: nextZoomed,\n          paneSynchronized: nextSynchronized,\n          lessonSlug: selectedLessonSlugRef.current,\n        });\n        if (unlocked.length > 0) {\n          announceAchievements(unlocked);\n        }\n      }\n    },\n    [announceAchievements],\n  );\n\n  const sendInternalCommand = useCallback((command: string) => {\n    const normalized = command.trim();\n    if (!normalized || !emulatorRef.current) {\n      return;\n    }\n\n    emulatorRef.current.serial0_send(`${normalized}\\n`);\n  }, []);\n\n  const requestSearchProbe = useCallback(() => {\n    if (!emulatorRef.current || !vmInternalBridgeReadyRef.current) {\n      return;\n    }\n\n    if (searchProbeTimerRef.current !== null) {\n      window.clearTimeout(searchProbeTimerRef.current);\n    }\n\n    searchProbeTimerRef.current = window.setTimeout(() => {\n      searchProbeTimerRef.current = null;\n      sendInternalCommand(SEARCH_PROBE_TRIGGER_COMMAND);\n    }, 140);\n  }, [sendInternalCommand]);\n\n  const registerCommand = useCallback(\n    (\n      command: string,\n      options?: {\n        source?: 'shell' | 'shortcut';\n        extraActions?: string[];\n      },\n    ) => {\n      const normalizedCommand = command.trim();\n      if (!normalizedCommand) {\n        return;\n      }\n\n      const source = options?.source ?? 'shell';\n      setCommandHistory((previous) => appendHistory(previous, normalizedCommand, MAX_HISTORY));\n\n      const actions = parseTmuxActionsFromCommand(normalizedCommand);\n      if (options?.extraActions && options.extraActions.length > 0) {\n        actions.push(...options.extraActions);\n      }\n      if (source === 'shortcut') {\n        actions.push('sim.shortcut.execute');\n      }\n\n      if (actions.length > 0) {\n        const uniqueActions = Array.from(new Set(actions));\n        setActionHistory((previous) => appendActions(previous, uniqueActions, MAX_HISTORY));\n\n        const unlocked = recordTmuxActivityRef.current({\n          actions: uniqueActions,\n          lessonSlug: selectedLessonSlugRef.current,\n        });\n        if (unlocked.length > 0) {\n          announceAchievements(unlocked);\n        }\n      }\n\n      const lower = normalizedCommand.toLowerCase();\n\n      if (/\\btmux\\s+copy-mode\\b/.test(lower)) {\n        setMetrics((previous) => ({\n          ...previous,\n          modeIs: 'COPY_MODE',\n        }));\n      }\n\n      if (/(search-forward|search-backward|search -)/.test(lower) || /send-keys\\s+.*-x\\s+search/.test(lower)) {\n        setMetrics((previous) => ({\n          ...previous,\n          searchExecuted: true,\n        }));\n        requestSearchProbe();\n      }\n    },\n    [announceAchievements, requestSearchProbe],\n  );\n\n  const completeSelectedMission = useCallback(\n    (mode: 'auto' | 'manual') => {\n      if (!content || !selectedMission || !selectedLesson) {\n        return;\n      }\n\n      const missionSlug = selectedMission.slug;\n      if (completedMissionSlugs.includes(missionSlug)) {\n        return;\n      }\n\n      const previousUnlockedSet = new Set(unlockedAchievements);\n      const nextCompletedMissionSlugs = [...completedMissionSlugs, missionSlug];\n      const completedTrackSlugs = computeCompletedTrackSlugs(content, nextCompletedMissionSlugs);\n\n      const gainedXp = recordMissionPass({\n        missionSlug,\n        difficulty: selectedMission.difficulty,\n        hintLevel: mode === 'manual' ? 1 : 0,\n        attemptNumber: 1,\n        completedTrackSlugs,\n      });\n\n      const completedSetBefore = new Set(completedMissionSlugs);\n      const completedSetAfter = new Set(nextCompletedMissionSlugs);\n      const lessonWasCompleted =\n        lessonMissions.length > 0 && lessonMissions.every((mission) => completedSetBefore.has(mission.slug));\n      const lessonNowCompleted =\n        lessonMissions.length > 0 && lessonMissions.every((mission) => completedSetAfter.has(mission.slug));\n      const lessonJustCompleted = !lessonWasCompleted && lessonNowCompleted;\n\n      if (lessonJustCompleted) {\n        enqueueCelebration({\n          key: `lesson:${selectedLesson.slug}`,\n          kind: 'lesson',\n          message: `레슨 완료: ${selectedLesson.title}`,\n          detail: `${lessonMissions.length}개 미션을 모두 완료했습니다. XP +${gainedXp}`,\n        });\n      } else {\n        enqueueCelebration({\n          key: `mission:${missionSlug}`,\n          kind: 'mission',\n          message: mode === 'manual' ? `수동 완료 처리: ${selectedMission.title}` : `미션 완료: ${selectedMission.title}`,\n          detail: mode === 'manual' ? `수동 브리지 기록 완료, XP +${gainedXp}` : `자동 판정 통과, XP +${gainedXp}`,\n        });\n      }\n\n      const newlyUnlocked = useProgressStore\n        .getState()\n        .unlockedAchievements.filter((achievementId) => !previousUnlockedSet.has(achievementId));\n\n      if (newlyUnlocked.length > 0) {\n        announceAchievements(newlyUnlocked);\n      }\n    },\n    [\n      announceAchievements,\n      completedMissionSlugs,\n      content,\n      enqueueCelebration,\n      lessonMissions,\n      recordMissionPass,\n      selectedLesson,\n      selectedMission,\n      unlockedAchievements,\n    ],\n  );\n\n  const captureInteractiveCommandInput = useCallback(\n    (data: string) => {\n      for (const char of data) {\n        if (inputEscapeSequenceRef.current) {\n          if (char >= '@' && char <= '~') {\n            inputEscapeSequenceRef.current = false;\n          }\n          continue;\n        }\n\n        if (char === '\\u001b') {\n          inputEscapeSequenceRef.current = true;\n          continue;\n        }\n\n        if (char === '\\r' || char === '\\n') {\n          const command = inputLineBufferRef.current.trim();\n          inputLineBufferRef.current = '';\n          if (command) {\n            registerCommand(command, { source: 'shell' });\n          }\n          continue;\n        }\n\n        if (char === '\\u0003' || char === '\\u0004' || char === '\\u0015') {\n          inputLineBufferRef.current = '';\n          continue;\n        }\n\n        if (char === '\\b' || char === String.fromCharCode(127)) {\n          inputLineBufferRef.current = inputLineBufferRef.current.slice(0, -1);\n          continue;\n        }\n\n        if (char >= ' ') {\n          inputLineBufferRef.current += char;\n        }\n      }\n    },\n    [registerCommand],\n  );\n\n  const sendCommand = useCallback(\n    (command: string, options?: { trackCommand?: boolean }) => {\n      const normalized = command.trim();\n      if (!normalized || !emulatorRef.current) {\n        return;\n      }\n\n      emulatorRef.current.serial0_send(`${normalized}\\n`);\n\n      const trackCommand = options?.trackCommand ?? true;\n\n      if (trackCommand) {\n        registerCommand(normalized, { source: 'shell' });\n      }\n    },\n    [registerCommand],\n  );\n\n  useEffect(() => {\n    if (!import.meta.env.DEV) {\n      return undefined;\n    }\n\n    window.__tmuxwebVmBridge = {\n      isReady: () => Boolean(emulatorRef.current),\n      getStatus: () => ({\n        status: vmStatus,\n        text: vmStatusText,\n        metrics,\n        actionHistory,\n        commandHistory,\n        debugLineCount: debugLines.length,\n        lastDebugLine: debugLines.length > 0 ? debugLines[debugLines.length - 1] : null,\n      }),\n      saveState: async () => {\n        const emulator = emulatorRef.current as (V86 & { save_state?: () => Promise<ArrayBuffer> | ArrayBuffer }) | null;\n        if (!emulator || typeof emulator.save_state !== 'function') {\n          return null;\n        }\n\n        const state = await emulator.save_state();\n        return state instanceof ArrayBuffer ? state : null;\n      },\n      sendProbe: () => {\n        sendInternalCommand(PROBE_TRIGGER_COMMAND);\n      },\n      sendCommand: (command: string) => {\n        sendCommand(command);\n      },\n      getBootConfig: () => VM_BOOT_CONFIG,\n      getLastEmulatorOptions: () => lastEmulatorOptionsRef.current,\n    };\n\n    return () => {\n      delete window.__tmuxwebVmBridge;\n    };\n  }, [actionHistory, commandHistory, debugLines, metrics, sendCommand, sendInternalCommand, vmStatus, vmStatusText]);\n\n  useEffect(() => {\n    if (!vmInternalBridgeReadyRef.current || !emulatorRef.current) {\n      return;\n    }\n\n    if (autoProbe) {\n      sendInternalCommand(PROBE_LOOP_START_COMMAND);\n      sendInternalCommand(PROBE_TRIGGER_COMMAND);\n      return;\n    }\n\n    sendInternalCommand(PROBE_LOOP_STOP_COMMAND);\n  }, [autoProbe, sendInternalCommand]);\n\n  useEffect(() => {\n    if (contentState.status !== 'ready') {\n      return undefined;\n    }\n\n    let isMounted = true;\n    let serialListener: ((value?: unknown) => void) | null = null;\n    let serialProbeListener: ((value?: unknown) => void) | null = null;\n    let loadedListener: ((value?: unknown) => void) | null = null;\n    let stopListener: ((value?: unknown) => void) | null = null;\n\n    setVmStatus('booting');\n    setVmStatusText('v86 초기화 중');\n\n    const host = terminalHostRef.current;\n    if (!host) {\n      setVmStatus('error');\n      setVmStatusText('터미널 DOM 초기화 실패');\n      return undefined;\n    }\n\n    const initialMetrics = createInitialMetrics();\n    setMetrics(initialMetrics);\n    metricsRef.current = initialMetrics;\n    setActionHistory([]);\n    setCommandHistory([]);\n    setDebugLines([]);\n    setCelebrationState({ active: null, queue: [] });\n    seenCelebrationKeysRef.current.clear();\n    inputLineBufferRef.current = '';\n    inputEscapeSequenceRef.current = false;\n    outputEscapeSequenceRef.current = false;\n    lineBufferRef.current = '';\n    probeLineBufferRef.current = '';\n    vmInternalBridgeReadyRef.current = false;\n    vmWarmBannerPendingRef.current = false;\n    shortcutTelemetryStateRef.current = createTmuxShortcutTelemetryState();\n    if (searchProbeTimerRef.current !== null) {\n      window.clearTimeout(searchProbeTimerRef.current);\n      searchProbeTimerRef.current = null;\n    }\n\n    const terminal = new Terminal({\n      cursorBlink: true,\n      cols: DEFAULT_TERMINAL_COLS,\n      rows: DEFAULT_TERMINAL_ROWS,\n      fontFamily: 'IBM Plex Mono, ui-monospace, SFMono-Regular, Menlo, Consolas, monospace',\n      fontSize: 14,\n      theme: {\n        background: '#020617',\n        foreground: '#dbeafe',\n        cursor: '#f8fafc',\n      },\n    });\n\n    terminal.open(host);\n    terminal.focus();\n\n    terminalRef.current = terminal;\n\n    const dataDisposable = terminal.onData((data) => {\n      if (!emulatorRef.current) {\n        return;\n      }\n\n      const shortcutTelemetry = parseTmuxShortcutTelemetry(data, shortcutTelemetryStateRef.current, {\n        inCopyMode: metricsRef.current.modeIs === 'COPY_MODE',\n      });\n      shortcutTelemetry.syntheticCommands.forEach((shortcutEvent) => {\n        registerCommand(shortcutEvent.command, {\n          source: 'shortcut',\n          extraActions: [shortcutEvent.shortcutAction],\n        });\n      });\n      if (shortcutTelemetry.shouldProbeSearch) {\n        setMetrics((previous) => ({\n          ...previous,\n          searchExecuted: true,\n        }));\n        requestSearchProbe();\n      }\n\n      captureInteractiveCommandInput(data);\n      emulatorRef.current.serial0_send(data);\n    });\n\n    const writeByte = (value: number) => {\n      terminal.write(Uint8Array.of(value & 0xff));\n\n      const char = String.fromCharCode(value & 0xff);\n\n      if (outputEscapeSequenceRef.current) {\n        if (char >= '@' && char <= '~') {\n          outputEscapeSequenceRef.current = false;\n        }\n        return;\n      }\n\n      if (char === '\\u001b') {\n        outputEscapeSequenceRef.current = true;\n        return;\n      }\n\n      if (char === '\\r') {\n        return;\n      }\n\n      if (char === '\\n') {\n        const completedLine = lineBufferRef.current;\n        lineBufferRef.current = '';\n\n        const probeMetric = parseProbeMetricFromLine(completedLine);\n        if (probeMetric) {\n          updateMetricByProbe(probeMetric);\n          return;\n        }\n\n        pushDebugLine(completedLine);\n\n        const plainLine = stripAnsi(completedLine).replace(/\\r/g, '');\n        const normalizedLine = plainLine.toLowerCase();\n        const hasShellPrompt = /[#$]\\s*$/.test(plainLine.trimEnd());\n        if (normalizedLine.includes('login:') || hasShellPrompt) {\n          setVmStatusText('부팅 완료, 명령 입력 가능');\n          setVmStatus('running');\n        }\n\n        if (hasShellPrompt && !vmInternalBridgeReadyRef.current && emulatorRef.current) {\n          vmInternalBridgeReadyRef.current = true;\n          if (vmWarmBannerPendingRef.current) {\n            sendInternalCommand(BANNER_TRIGGER_COMMAND);\n            vmWarmBannerPendingRef.current = false;\n          }\n          sendInternalCommand(TERMINAL_GEOMETRY_SYNC_COMMAND);\n          if (autoProbeRef.current) {\n            sendInternalCommand(PROBE_LOOP_START_COMMAND);\n          }\n          sendInternalCommand(PROBE_TRIGGER_COMMAND);\n        }\n        return;\n      }\n\n      if (char === '\\b' || char === String.fromCharCode(127)) {\n        lineBufferRef.current = lineBufferRef.current.slice(0, -1);\n        return;\n      }\n\n      if (char >= ' ') {\n        lineBufferRef.current += char;\n      }\n    };\n\n    const writeProbeByte = (value: number) => {\n      const char = String.fromCharCode(value & 0xff);\n      if (char === '\\r') {\n        return;\n      }\n\n      if (char === '\\n') {\n        const completedLine = probeLineBufferRef.current;\n        probeLineBufferRef.current = '';\n        const probeMetric = parseProbeMetricFromLine(completedLine);\n        if (probeMetric) {\n          updateMetricByProbe(probeMetric);\n        }\n        return;\n      }\n\n      if (char >= ' ') {\n        probeLineBufferRef.current += char;\n      }\n    };\n\n    (async () => {\n      try {\n        const module = await import('v86');\n        if (!isMounted) {\n          return;\n        }\n\n        const V86Ctor = module.default;\n        setVmStatusText('VM 시작 이미지 확인 중...');\n\n        const initialState = disableWarmStart ? null : await loadVmInitialState(VM_BOOT_CONFIG.initialStatePath);\n        if (!isMounted) {\n          return;\n        }\n\n        let useWarmStart = Boolean(initialState);\n        if (useWarmStart) {\n          setVmStatusText('빠른 시작 스냅샷 로딩 중...');\n        }\n\n        const baseOptions: V86Options = {\n          wasm_path: VM_BOOT_CONFIG.wasmPath,\n          wasm_fallback_path: VM_BOOT_CONFIG.wasmFallbackPath,\n          memory_size: 256 * 1024 * 1024,\n          vga_memory_size: 8 * 1024 * 1024,\n          bios: { url: VM_BOOT_CONFIG.biosPath },\n          vga_bios: { url: VM_BOOT_CONFIG.vgaBiosPath },\n          filesystem: {\n            basefs: {\n              url: VM_BOOT_CONFIG.fsJsonPath,\n            },\n            baseurl: VM_BOOT_CONFIG.fsBasePath,\n          },\n          bzimage_initrd_from_filesystem: true,\n          cmdline:\n            'rw root=host9p rootfstype=9p rootflags=trans=virtio,cache=loose console=ttyS0 init=/sbin/init quiet loglevel=3',\n          uart1: true,\n          disable_keyboard: true,\n          disable_mouse: true,\n          autostart: true,\n        };\n\n        let emulator: V86;\n        if (useWarmStart) {\n          try {\n            emulator = new V86Ctor({\n              ...baseOptions,\n              initial_state: initialState ?? undefined,\n            });\n          } catch {\n            useWarmStart = false;\n            setVmStatusText('빠른 시작 스냅샷 복원 실패, 일반 부팅으로 전환');\n            emulator = new V86Ctor(baseOptions);\n          }\n        } else {\n          emulator = new V86Ctor(baseOptions);\n        }\n\n        lastEmulatorOptionsRef.current = {\n          ...baseOptions,\n          ...(useWarmStart ? { initial_state: initialState ?? undefined } : {}),\n        };\n        vmWarmBannerPendingRef.current = useWarmStart;\n\n        emulatorRef.current = emulator;\n\n        loadedListener = () => {\n          setVmStatusText(useWarmStart ? '빠른 시작 스냅샷 복원 완료' : '커널 및 루트FS 로딩 완료');\n        };\n\n        stopListener = () => {\n          setVmStatus('stopped');\n          setVmStatusText('VM이 중지되었습니다');\n        };\n\n        serialListener = (value) => {\n          if (typeof value !== 'number') {\n            return;\n          }\n          writeByte(value);\n        };\n\n        serialProbeListener = (value) => {\n          if (typeof value !== 'number') {\n            return;\n          }\n          writeProbeByte(value);\n        };\n\n        emulator.add_listener('emulator-loaded', loadedListener);\n        emulator.add_listener('emulator-stopped', stopListener);\n        emulator.add_listener('serial0-output-byte', serialListener);\n        emulator.add_listener('serial1-output-byte', serialProbeListener);\n\n        setVmStatus('booting');\n        setVmStatusText('VM 부팅 중...');\n\n        const probeBootstrapDelayMs = useWarmStart ? 700 : 2600;\n        window.setTimeout(() => {\n          if (!emulatorRef.current) {\n            return;\n          }\n          emulatorRef.current.serial0_send('\\n');\n          if (useWarmStart) {\n            window.setTimeout(() => {\n              if (!emulatorRef.current) {\n                return;\n              }\n              sendInternalCommand(BANNER_TRIGGER_COMMAND);\n              sendInternalCommand(TERMINAL_GEOMETRY_SYNC_COMMAND);\n              if (autoProbeRef.current) {\n                sendInternalCommand(PROBE_LOOP_START_COMMAND);\n              }\n              sendInternalCommand(PROBE_TRIGGER_COMMAND);\n              vmInternalBridgeReadyRef.current = true;\n              vmWarmBannerPendingRef.current = false;\n            }, 180);\n          }\n        }, probeBootstrapDelayMs);\n      } catch {\n        setVmStatus('error');\n        setVmStatusText('v86 초기화 실패 (bios/wasm 경로 확인 필요)');\n      }\n    })();\n\n    return () => {\n      isMounted = false;\n\n      inputLineBufferRef.current = '';\n      inputEscapeSequenceRef.current = false;\n      outputEscapeSequenceRef.current = false;\n      probeLineBufferRef.current = '';\n      shortcutTelemetryStateRef.current = createTmuxShortcutTelemetryState();\n      if (searchProbeTimerRef.current !== null) {\n        window.clearTimeout(searchProbeTimerRef.current);\n        searchProbeTimerRef.current = null;\n      }\n\n      dataDisposable.dispose();\n\n      if (terminalRef.current) {\n        terminalRef.current.dispose();\n        terminalRef.current = null;\n      }\n\n      const emulator = emulatorRef.current;\n      emulatorRef.current = null;\n\n      if (emulator) {\n        if (loadedListener) {\n          emulator.remove_listener('emulator-loaded', loadedListener);\n        }\n        if (stopListener) {\n          emulator.remove_listener('emulator-stopped', stopListener);\n        }\n        if (serialListener) {\n          emulator.remove_listener('serial0-output-byte', serialListener);\n        }\n        if (serialProbeListener) {\n          emulator.remove_listener('serial1-output-byte', serialProbeListener);\n        }\n\n        void Promise.resolve(emulator.stop()).catch(() => undefined);\n        void Promise.resolve(emulator.destroy()).catch(() => undefined);\n      }\n    };\n  }, [\n    captureInteractiveCommandInput,\n    contentState.status,\n    disableWarmStart,\n    pushDebugLine,\n    registerCommand,\n    requestSearchProbe,\n    sendInternalCommand,\n    updateMetricByProbe,\n    vmEpoch,\n  ]);\n\n  useEffect(() => {\n    if (!content || !selectedMission || !selectedMissionStatus) {\n      return;\n    }\n\n    const missionSlug = selectedMission.slug;\n\n    if (selectedMissionStatus.status !== 'complete') {\n      return;\n    }\n\n    if (celebratedMissionSetRef.current.has(missionSlug)) {\n      return;\n    }\n\n    if (completedMissionSlugs.includes(missionSlug)) {\n      celebratedMissionSetRef.current.add(missionSlug);\n      return;\n    }\n\n    celebratedMissionSetRef.current.add(missionSlug);\n\n    completeSelectedMission('auto');\n  }, [\n    completeSelectedMission,\n    completedMissionSlugs,\n    content,\n    selectedMission,\n    selectedMissionStatus,\n  ]);\n\n  const handleManualMissionComplete = useCallback(() => {\n    if (!selectedMission) {\n      return;\n    }\n\n    const missionSlug = selectedMission.slug;\n    if (completedMissionSlugs.includes(missionSlug)) {\n      return;\n    }\n\n    celebratedMissionSetRef.current.add(missionSlug);\n    completeSelectedMission('manual');\n  }, [completeSelectedMission, completedMissionSlugs, selectedMission]);\n\n  const lessonObjectivePreview = selectedLesson?.objectives.slice(0, 3) ?? [];\n  const hiddenObjectiveCount = selectedLesson\n    ? Math.max(selectedLesson.objectives.length - lessonObjectivePreview.length, 0)\n    : 0;\n  const lessonSuccessCriteriaPreview = selectedLesson?.successCriteria?.slice(0, 1) ?? [];\n  const hiddenSuccessCriteriaCount = selectedLesson\n    ? Math.max((selectedLesson.successCriteria?.length ?? 0) - lessonSuccessCriteriaPreview.length, 0)\n    : 0;\n  const lessonFailureStatePreview = selectedLesson?.failureStates?.slice(0, 1) ?? [];\n  const hiddenFailureStateCount = selectedLesson\n    ? Math.max((selectedLesson.failureStates?.length ?? 0) - lessonFailureStatePreview.length, 0)\n    : 0;\n  const missionHintPreview = selectedMission?.hints.slice(0, 2) ?? [];\n  const hiddenMissionHintCount = selectedMission\n    ? Math.max(selectedMission.hints.length - missionHintPreview.length, 0)\n    : 0;\n  const selectedMissionCommands = useMemo(() => buildMissionCommandSuggestions(selectedMission), [selectedMission]);\n  const selectedMissionPreconditions = useMemo(\n    () => buildMissionPreconditionItems(selectedMission, vmSnapshot),\n    [selectedMission, vmSnapshot],\n  );\n\n  if (contentState.status === 'loading') {\n    return (\n      <PagePlaceholder\n        eyebrow=",
  "바로 실습 시작": "바로 실습 시작",
  "보조 메뉴입니다. 필요할 때만 XP/트랙 진행률/업적을 확인합니다.": "보조 메뉴입니다. 필요할 때만 XP/트랙 진행률/업적을 확인합니다.",
  "복잡한 선택보다 짧은 실행 루프를 반복": "복잡한 선택보다 짧은 실행 루프를 반복",
  "복잡한 이론보다 반복 가능한 행동 루틴": "복잡한 이론보다 반복 가능한 행동 루틴",
  "복합 시나리오와 command-mode 루틴까지 확장합니다.": "복합 시나리오와 command-mode 루틴까지 확장합니다.",
  "본문으로 건너뛰기": "본문으로 건너뛰기",
  "분석 끄기": "분석 끄기",
  "분석 켜기": "분석 켜기",
  "분할과 리사이즈": "분할과 리사이즈",
  "사용성 개선을 위해 Cloudflare Web Analytics를 사용합니다. 동의하면 라우트 기반 이용량이 수집됩니다.": "사용성 개선을 위해 Cloudflare Web Analytics를 사용합니다. 동의하면 라우트 기반 이용량이 수집됩니다.",
  "새 세션 생성": "새 세션 생성",
  "새 윈도우 생성": "새 윈도우 생성",
  "서로 다른 레슨 3개 이상에서 실습했습니다.": "서로 다른 레슨 3개 이상에서 실습했습니다.",
  "설명보다 실행을 앞세우고, 첫 레슨부터 운영 루틴까지 하나의 흐름으로 이어지는 실습 중심 구조로 설계했습니다.": "설명보다 실행을 앞세우고, 첫 레슨부터 운영 루틴까지 하나의 흐름으로 이어지는 실습 중심 구조로 설계했습니다.",
  "세션 유지 루틴": "세션 유지 루틴",
  "세션 유지 습관을 붙이면 복습 루틴이 끊기지 않습니다.": "세션 유지 습관을 붙이면 복습 루틴이 끊기지 않습니다.",
  "세션/윈도우/분할 기본 루틴을 완성했어요.": "세션/윈도우/분할 기본 루틴을 완성했어요.",
  "세션/윈도우/분할 기본기를 한 번에 완성했습니다.": "세션/윈도우/분할 기본기를 한 번에 완성했습니다.",
  "세션/윈도우/패인 기본 조작을 가장 빠르게 익힙니다.": "세션/윈도우/패인 기본 조작을 가장 빠르게 익힙니다.",
  "세션/윈도우/패인 필수 조작을 짧은 미션으로 먼저 익힙니다.": "세션/윈도우/패인 필수 조작을 짧은 미션으로 먼저 익힙니다.",
  "소스코드:": "소스코드:",
  "숨은 트릭 챌린지": "숨은 트릭 챌린지",
  "숨은 트릭스터": "숨은 트릭스터",
  "숨은 트릭스터 업적을 달성했어요.": "숨은 트릭스터 업적을 달성했어요.",
  "시뮬레이터를 먼저 만나고, 필요한 설명은 바로 옆에서 확인": "시뮬레이터를 먼저 만나고, 필요한 설명은 바로 옆에서 확인",
  "실무 전환": "실무 전환",
  "실무에서 자주 부딪히는 상황 중심으로 반복 훈련합니다.": "실무에서 자주 부딪히는 상황 중심으로 반복 훈련합니다.",
  "실습": "실습",
  "실습 시작": "실습 시작",
  "실습 열기": "실습 열기",
  "실습 우선": "실습 우선",
  "실습 워크벤치": "실습 워크벤치",
  "실패 룰 없음": "실패 룰 없음",
  "실패 조건: ${formatFailedRules(result)}": "실패 조건: ${formatFailedRules(result)}",
  "업무용 기초 빨리 익히기": "업무용 기초 빨리 익히기",
  "없음": "없음",
  "예상치 못한 오류가 발생했습니다.": "예상치 못한 오류가 발생했습니다.",
  "완료됨": "완료됨",
  "완주자 챌린지: choose-tree 탐색": "완주자 챌린지: choose-tree 탐색",
  "운영 루프 시작": "운영 루프 시작",
  "운영 확장 루프": "운영 확장 루프",
  "워크스페이스 부트스트랩": "워크스페이스 부트스트랩",
  "워크플로우 트랙 실습을 완료했습니다.": "워크플로우 트랙 실습을 완료했습니다.",
  "원격 환경에서 장시간 tmux 세션 운영 흐름을 바로 적용합니다.": "원격 환경에서 장시간 tmux 세션 운영 흐름을 바로 적용합니다.",
  "자주 까먹는 이동/전환 단축키를 빠르게 재학습합니다.": "자주 까먹는 이동/전환 단축키를 빠르게 재학습합니다.",
  "자주 쓰는 이동/전환 루틴을 복습 중심으로 익힙니다.": "자주 쓰는 이동/전환 루틴을 복습 중심으로 익힙니다.",
  "잘못된 경로이거나 로드 중입니다.": "잘못된 경로이거나 로드 중입니다.",
  "전체 커리큘럼을 완주했어요.": "전체 커리큘럼을 완주했어요.",
  "정답 경로 요약: 먼저 목표 상태를 만들고, 마지막으로 제출하세요. 실패 조건: ${formatFailedRules(\n      result,\n    )}. 우선순위: ${actionHint}": "정답 경로 요약: 먼저 목표 상태를 만들고, 마지막으로 제출하세요. 실패 조건: ${formatFailedRules(\n      result,\n    )}. 우선순위: ${actionHint}",
  "조건을 충족하지 못했습니다.": "조건을 충족하지 못했습니다.",
  "진행 중": "진행 중",
  "진행도": "진행도",
  "진행도(선택) 보기": "진행도(선택) 보기",
  "짧은 루프": "짧은 루프",
  "첫 3분: tmux 맛보기": "첫 3분: tmux 맛보기",
  "첫 미션 완료": "첫 미션 완료",
  "첫 미션 통과가 기록되었습니다. 추천 트랙으로 바로 이어서 학습하세요.": "첫 미션 통과가 기록되었습니다. 추천 트랙으로 바로 이어서 학습하세요.",
  "첫 미션을 통과했어요.": "첫 미션을 통과했어요.",
  "첫 실습 미션을 통과했습니다.": "첫 실습 미션을 통과했습니다.",
  "첫 실습: 패인 2개 만들기": "첫 실습: 패인 2개 만들기",
  "초급 코어 루틴을 먼저 완성하고, 이후 심화로 확장": "초급 코어 루틴을 먼저 완성하고, 이후 심화로 확장",
  "초급/심화를 나누지 않고, 하나의 통합 실습 경로로 처음부터 운영 루틴까지 이어집니다.": "초급/심화를 나누지 않고, 하나의 통합 실습 경로로 처음부터 운영 루틴까지 이어집니다.",
  "초급부터 심화까지, tmux를 단순하고 실전적으로 익힙니다.": "초급부터 심화까지, tmux를 단순하고 실전적으로 익힙니다.",
  "초기 미션 데이터를 찾지 못했습니다. 홈으로 이동 후 다시 시도해 주세요.": "초기 미션 데이터를 찾지 못했습니다. 홈으로 이동 후 다시 시도해 주세요.",
  "초기 tmux.conf를 먼저 맞추면 이후 실습이 안정적입니다.": "초기 tmux.conf를 먼저 맞추면 이후 실습이 안정적입니다.",
  "커리큘럼 완주": "커리큘럼 완주",
  "커리큘럼과 VM 리소스를 로딩하고 있습니다.": "커리큘럼과 VM 리소스를 로딩하고 있습니다.",
  "콘텐츠 파일을 확인해 주세요.": "콘텐츠 파일을 확인해 주세요.",
  "클립보드 복사에 실패했습니다.": "클립보드 복사에 실패했습니다.",
  "패인 가로 분할": "패인 가로 분할",
  "패인 세로 분할": "패인 세로 분할",
  "패인 이동 루틴": "패인 이동 루틴",
  "페이지를 렌더링할 수 없습니다": "페이지를 렌더링할 수 없습니다",
  "페이지를 불러오는 중입니다...": "페이지를 불러오는 중입니다...",
  "페이지를 찾을 수 없습니다": "페이지를 찾을 수 없습니다",
  "포커스 네비게이터": "포커스 네비게이터",
  "포커스 네비게이터 업적을 달성했어요.": "포커스 네비게이터 업적을 달성했어요.",
  "포커스 이동 루틴": "포커스 이동 루틴",
  "프로젝트 링크": "프로젝트 링크",
  "플레이북 상세 단계, 명령 복사, 검증 체크리스트를 표시합니다.": "플레이북 상세 단계, 명령 복사, 검증 체크리스트를 표시합니다.",
  "플레이북을 찾을 수 없습니다": "플레이북을 찾을 수 없습니다",
  "하나의 통합 레슨 경로에서 현재 위치를 확인하고 다음 실습을 이어갑니다.": "하나의 통합 레슨 경로에서 현재 위치를 확인하고 다음 실습을 이어갑니다.",
  "학습 경로": "학습 경로",
  "학습 경로 보기": "학습 경로 보기",
  "학습 단계": "학습 단계",
  "학습 핵심 포인트": "학습 핵심 포인트",
  "학습이 끝나면 로컬과 원격 터미널에서 tmux를 자연스럽게 운영하는 개발자가 됩니다.": "학습이 끝나면 로컬과 원격 터미널에서 tmux를 자연스럽게 운영하는 개발자가 됩니다.",
  "핵심 레슨을 짧게 끝내고 바로 실습으로 연결합니다.": "핵심 레슨을 짧게 끝내고 바로 실습으로 연결합니다.",
  "핵심 목표를 다시 확인해 보세요.": "핵심 목표를 다시 확인해 보세요.",
  "핵심 운영 원칙": "핵심 운영 원칙",
  "현재 패인을 좌우로 분할합니다.": "현재 패인을 좌우로 분할합니다.",
  "홈으로 이동": "홈으로 이동",
  "확인됨` : `최근 명령에서": "확인됨` : `최근 명령에서",
  "확인됨` : `최근 액션에서": "확인됨` : `최근 액션에서",
  "확장 트랙 실습을 완료했습니다.": "확장 트랙 실습을 완료했습니다.",
  "확장: Command Mode 운영": "확장: Command Mode 운영",
  "Browser VM 초기화 중": "Browser VM 초기화 중",
  "Command Mode 운영": "Command Mode 운영",
  "command-mode와 장시간 작업 루틴까지 확장합니다.": "command-mode와 장시간 작업 루틴까지 확장합니다.",
  "command-prompt 또는 choose-tree를 실행했습니다.": "command-prompt 또는 choose-tree를 실행했습니다.",
  "command-prompt와 choose-tree를 모두 사용했습니다.": "command-prompt와 choose-tree를 모두 사용했습니다.",
  "Copy 모드 입문": "Copy 모드 입문",
  "Copy 모드 입문 업적을 달성했어요.": "Copy 모드 입문 업적을 달성했어요.",
  "Copy Mode 검색": "Copy Mode 검색",
  "copy-mode, command-mode, tmux 설정 적용과 원격 운영 루틴으로 확장합니다.": "copy-mode, command-mode, tmux 설정 적용과 원격 운영 루틴으로 확장합니다.",
  "copy-mode를 실행해 로그 탐색 루틴에 진입했습니다.": "copy-mode를 실행해 로그 탐색 루틴에 진입했습니다.",
  "Ctrl+b 다음 : : command prompt를 엽니다.": "Ctrl+b 다음 : : command prompt를 엽니다.",
  "Ctrl+b 다음 c: 새 window를 만듭니다.": "Ctrl+b 다음 c: 새 window를 만듭니다.",
  "Ctrl+b 다음 d: 현재 세션에서 분리(detach)합니다.": "Ctrl+b 다음 d: 현재 세션에서 분리(detach)합니다.",
  "Ctrl를 누른 상태에서 b를 누른 뒤 손을 떼고 다음 키를 입력하세요.": "Ctrl를 누른 상태에서 b를 누른 뒤 손을 떼고 다음 키를 입력하세요.",
  "macOS/Homebrew 설치 페이지": "macOS/Homebrew 설치 페이지",
  "onClick={() => {\n              copyTextToClipboard(shareUrl)\n                .then(() => setCopyStatus('공유 링크를 복사했습니다.'))\n                .catch(() => setCopyStatus('클립보드 복사에 실패했습니다.'));\n            }}\n          >\n            링크 복사\n          </button>\n          <a className=": "onClick={() => {\n              copyTextToClipboard(shareUrl)\n                .then(() => setCopyStatus('공유 링크를 복사했습니다.'))\n                .catch(() => setCopyStatus('클립보드 복사에 실패했습니다.'));\n            }}\n          >\n            링크 복사\n          </button>\n          <a className=",
  "onClick={() => {\n            if (!goal) {\n              return;\n            }\n            navigate('/onboarding/preferences');\n          }}\n          disabled={!goal}\n        >\n          입력 선호 설정으로 이동\n        </button>\n        <button type=": "onClick={() => {\n            if (!goal) {\n              return;\n            }\n            navigate('/onboarding/preferences');\n          }}\n          disabled={!goal}\n        >\n          입력 선호 설정으로 이동\n        </button>\n        <button type=",
  "onClick={() => sendPrefixKey('%')}>\n              Prefix + % (세로 분할)\n            </button>\n            <button type=": "onClick={() => sendPrefixKey('%')}>\n              Prefix + % (세로 분할)\n            </button>\n            <button type=",
  "onClick={() => simulateMissionPass(mission)}\n                      >\n                        샘플 통과 처리\n                      </button>\n                    </div>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </section>\n\n          <section className=": "onClick={() => simulateMissionPass(mission)}\n                      >\n                        샘플 통과 처리\n                      </button>\n                    </div>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </section>\n\n          <section className=",
  "onClick={handleCheck}>\n              제출하고 채점하기\n            </button>\n            <Link to=": "onClick={handleCheck}>\n              제출하고 채점하기\n            </button>\n            <Link to=",
  "Pane 러너": "Pane 러너",
  "Pane 러너 업적을 달성했어요.": "Pane 러너 업적을 달성했어요.",
  "Pane 백장": "Pane 백장",
  "Pane 백장 업적을 달성했어요.": "Pane 백장 업적을 달성했어요.",
  "Pane 분할": "Pane 분할",
  "pane 분할 누적 100회를 달성했습니다.": "pane 분할 누적 100회를 달성했습니다.",
  "pane 분할 누적 30회를 달성했습니다.": "pane 분할 누적 30회를 달성했습니다.",
  "pane 이동/리사이즈를 충분히 반복해 포커스 제어 루틴을 만들었습니다.": "pane 이동/리사이즈를 충분히 반복해 포커스 제어 루틴을 만들었습니다.",
  "session/window/pane 조작, detach/attach, pane 이동까지 빠르게 체득합니다.": "session/window/pane 조작, detach/attach, pane 이동까지 빠르게 체득합니다.",
  "title={SHORTCUT_TOOLTIP_TEXT}\n          aria-label={`단축키 안내: ${SHORTCUT_TOOLTIP_TEXT}`}\n        >\n          <code>Ctrl+b</code>\n        </span>\n      );\n    }\n\n    return <span key={`${keyPrefix}-text-${index}`}>{segment}</span>;\n  });\n}\n\nfunction renderHintTextWithTooltips(hint: string, keyPrefix: string) {\n  return hint.split(/(`[^`]+`)/g).flatMap((segment, index) => {\n    const codeMatch = segment.match(/^`([^`]+)`$/);\n    if (!codeMatch) {\n      return renderPlainHintSegmentWithTooltip(segment, `${keyPrefix}-plain-${index}`);\n    }\n\n    const token = codeMatch[1];\n    const shortcutTooltip = getShortcutTooltipForToken(token);\n    if (shortcutTooltip) {\n      return (\n        <span\n          key={`${keyPrefix}-code-${index}`}\n          className=": "title={SHORTCUT_TOOLTIP_TEXT}\n          aria-label={`단축키 안내: ${SHORTCUT_TOOLTIP_TEXT}`}\n        >\n          <code>Ctrl+b</code>\n        </span>\n      );\n    }\n\n    return <span key={`${keyPrefix}-text-${index}`}>{segment}</span>;\n  });\n}\n\nfunction renderHintTextWithTooltips(hint: string, keyPrefix: string) {\n  return hint.split(/(`[^`]+`)/g).flatMap((segment, index) => {\n    const codeMatch = segment.match(/^`([^`]+)`$/);\n    if (!codeMatch) {\n      return renderPlainHintSegmentWithTooltip(segment, `${keyPrefix}-plain-${index}`);\n    }\n\n    const token = codeMatch[1];\n    const shortcutTooltip = getShortcutTooltipForToken(token);\n    if (shortcutTooltip) {\n      return (\n        <span\n          key={`${keyPrefix}-code-${index}`}\n          className=",
  "title={shortcutTooltip}\n          aria-label={`단축키 안내: ${shortcutTooltip}`}\n        >\n          <code>{token}</code>\n        </span>\n      );\n    }\n\n    return <code key={`${keyPrefix}-code-${index}`}>{token}</code>;\n  });\n}\n\nfunction isLikelyCommandText(value: string) {\n  const normalized = value.trim().toLowerCase();\n  if (!normalized) {\n    return false;\n  }\n\n  if (normalized.startsWith('tmux')) {\n    return true;\n  }\n\n  return /(new-window|split-window|resize-pane|choose-tree|command-prompt|next-window|previous-window|attach)/.test(\n    normalized,\n  );\n}\n\nfunction getRuleCommandSuggestions(rule: AppMission['passRules'][number]) {\n  switch (rule.kind) {\n    case 'shellHistoryText':\n      return typeof rule.value === 'string' ? [rule.value] : [];\n    case 'actionHistoryText':\n      if (typeof rule.value !== 'string') {\n        return [];\n      }\n      return ACTION_HISTORY_COMMAND_SUGGESTIONS[rule.value] ? [ACTION_HISTORY_COMMAND_SUGGESTIONS[rule.value]] : [];\n    case 'sessionCount':\n      return ['tmux new -As main'];\n    case 'windowCount':\n      return ['tmux new-window -n work'];\n    case 'paneCount':\n      return ['tmux split-window'];\n    case 'activeWindowIndex':\n      return ['tmux next-window'];\n    case 'modeIs':\n      return rule.value === 'COPY_MODE' ? ['tmux copy-mode'] : [];\n    case 'searchExecuted':\n    case 'searchMatchFound':\n      return ['tmux copy-mode', 'tmux send-keys -X search-backward": "title={shortcutTooltip}\n          aria-label={`단축키 안내: ${shortcutTooltip}`}\n        >\n          <code>{token}</code>\n        </span>\n      );\n    }\n\n    return <code key={`${keyPrefix}-code-${index}`}>{token}</code>;\n  });\n}\n\nfunction isLikelyCommandText(value: string) {\n  const normalized = value.trim().toLowerCase();\n  if (!normalized) {\n    return false;\n  }\n\n  if (normalized.startsWith('tmux')) {\n    return true;\n  }\n\n  return /(new-window|split-window|resize-pane|choose-tree|command-prompt|next-window|previous-window|attach)/.test(\n    normalized,\n  );\n}\n\nfunction getRuleCommandSuggestions(rule: AppMission['passRules'][number]) {\n  switch (rule.kind) {\n    case 'shellHistoryText':\n      return typeof rule.value === 'string' ? [rule.value] : [];\n    case 'actionHistoryText':\n      if (typeof rule.value !== 'string') {\n        return [];\n      }\n      return ACTION_HISTORY_COMMAND_SUGGESTIONS[rule.value] ? [ACTION_HISTORY_COMMAND_SUGGESTIONS[rule.value]] : [];\n    case 'sessionCount':\n      return ['tmux new -As main'];\n    case 'windowCount':\n      return ['tmux new-window -n work'];\n    case 'paneCount':\n      return ['tmux split-window'];\n    case 'activeWindowIndex':\n      return ['tmux next-window'];\n    case 'modeIs':\n      return rule.value === 'COPY_MODE' ? ['tmux copy-mode'] : [];\n    case 'searchExecuted':\n    case 'searchMatchFound':\n      return ['tmux copy-mode', 'tmux send-keys -X search-backward",
  "tmux 공식 저장소 (개요/README)": "tmux 공식 저장소 (개요/README)",
  "tmux 설치 가이드 (공식 위키)": "tmux 설치 가이드 (공식 위키)",
  "tmux 시작 링크": "tmux 시작 링크",
  "tmux 실습 학습": "tmux 실습 학습",
  "tmux 학습 마일스톤을 공유합니다.": "tmux 학습 마일스톤을 공유합니다.",
  "tmux Getting Started (공식 위키)": "tmux Getting Started (공식 위키)",
  "tmux-tuto 업적 달성: ${shareText} 지금 ${target.challengeLabel} 챌린지에 도전해보세요.": "tmux-tuto 업적 달성: ${shareText} 지금 ${target.challengeLabel} 챌린지에 도전해보세요.",
  "tmux-tuto 업적 챌린지를 공유합니다.": "tmux-tuto 업적 챌린지를 공유합니다.",
  "tmux는 하나의 터미널에서 여러 작업을 유지/전환하고, 연결이 끊겨도 세션을 복구할 수 있게 해주는 terminal multiplexer입니다. 먼저 공식 개론을 읽고, 본인 OS에 맞는 설치 가이드를 확인한 뒤 실습을 시작하세요.": "tmux는 하나의 터미널에서 여러 작업을 유지/전환하고, 연결이 끊겨도 세션을 복구할 수 있게 해주는 terminal multiplexer입니다. 먼저 공식 개론을 읽고, 본인 OS에 맞는 설치 가이드를 확인한 뒤 실습을 시작하세요.",
  "tmux를 실전 운영 루틴으로 익히는 가장 빠른 학습 플로우": "tmux를 실전 운영 루틴으로 익히는 가장 빠른 학습 플로우",
  "to={challengeTarget?.path ?? '/practice?lesson=hello-tmux&mission=hello-tmux-version-check'}>\n            챌린지 시작\n          </Link>\n        </div>\n      </div>\n\n      <section className=": "to={challengeTarget?.path ?? '/practice?lesson=hello-tmux&mission=hello-tmux-version-check'}>\n            챌린지 시작\n          </Link>\n        </div>\n      </div>\n\n      <section className=",
  "Track A 완료": "Track A 완료",
  "Track A~C 전체를 완료했습니다.": "Track A~C 전체를 완료했습니다.",
  "Track A를 완료했어요.": "Track A를 완료했어요.",
  "Track B 완료": "Track B 완료",
  "Track B를 완료했어요.": "Track B를 완료했어요.",
  "Track C 완료": "Track C 완료",
  "Track C를 완료했어요.": "Track C를 완료했어요."
}